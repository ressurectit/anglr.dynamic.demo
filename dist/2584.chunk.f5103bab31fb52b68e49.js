"use strict";(self.webpackChunkng_universal_demo=self.webpackChunkng_universal_demo||[]).push([[2584],{72584:(t,e,n)=>{n.r(e),n.d(e,{DefaultModule:()=>Ae});var o=n(14392),a=n(35375),i=n(89001),s=n(27052),r=n(63789),l=n(989),c=n(38223),p=n(63152),d=n(84773),u=n(80827),m=n(72891),g=n(43870),h=n(6845),_=n(86357),f=n(66794),v=n(73301),y=n(94727),b=n(15686),x=n(85320),C=n(79440),M=n(68961),D=n(13691),w=n(55436),k=n(82568),T=n(41853),N=n(6427),O=n(83434),I=n(43649),P=n(12311),R=n(21651),L=n(41623),S=n(99055),F=n(23208);function Y(t,e){if(1&t){const t=d.E();u.Tg(0,"button",4),m.N("click",(function(){g.CH(t);const e=h.o();return g.Kt(e.toggle())})),u._U(1,"span",5),u.qZ()}if(2&t){const t=h.o();_.u("aria-label","Toggle"),f.x(1),v.Q("ngClass",t.open?"fa-chevron-down":"fa-chevron-right")}}const z=function(t,e){return{metadata:t,parentId:e}};function Q(t,e){if(1&t&&(u.Tg(0,"div",8),u._U(1,"components-tree-item",9),u.qZ()),2&t){const t=e.$implicit;v.Q("cdkDragData",y.WL(3,z,null==t.component.options?null:t.component.options.typeMetadata,null==t.parent||null==t.parent.component?null:t.parent.component.id))("cdkDragDisabled",t.component.dragDisabled),f.x(1),v.Q("data",t)}}function q(t,e){if(1&t){const t=d.E();u.Tg(0,"div",6),m.N("cdkDropListDropped",(function(e){g.CH(t);const n=h.o();return g.Kt(null==n.data||null==n.data.component?null:n.data.component.addDescendant(e))})),b.Y(1,Q,2,6,"div",7),u.qZ()}if(2&t){const t=h.o();x.ek("hidden",!t.open),v.Q("cdkDropListEnterPredicate",t._canDrop)("id","component-tree-"+(null==t.data||null==t.data.component||null==t.data.component.options||null==t.data.component.options.typeMetadata?null:t.data.component.options.typeMetadata.id)),f.x(1),v.Q("ngForOf",null==t.data?null:t.data.children)}}class Z{constructor(t,e){this._manager=t,this._changeDetector=e,this._initSubscriptions=new c.w,this.open=!0,this._canDrop=()=>this.data?.component?.canDrop()??!1}get hasChildren(){return!!this.data?.children&&this.data?.children.length>0}ngOnInit(){this._initSubscriptions.add(this._manager.layoutChange.subscribe((()=>{this._changeDetector.detectChanges()}))),this._initSubscriptions.add(this._manager.selectedChange.subscribe((()=>{this._changeDetector.detectChanges()}))),this._initSubscriptions.add(this._manager.highlightedChange.subscribe((()=>this._changeDetector.detectChanges()))),this._initSubscriptions.add(this._manager.displayNameChange.subscribe((()=>this._changeDetector.detectChanges())))}ngOnDestroy(){this._initSubscriptions.unsubscribe()}toggle(){this.open=!this.open}expand(t){if(!t)return this.open=!0,!0;if(this.data?.component?.options?.typeMetadata?.id===t)return!0;if(this.hasChildren)for(const e of this._childrenNodes?.toArray())if(e.expand(t))return this.expand(),!0;return!1}expandAll(){this._childrenNodes?.forEach((t=>t.expandAll())),this.expand(),this._changeDetector.detectChanges()}collapse(){this.open=!1}collapseAll(){this._childrenNodes?.forEach((t=>t.collapseAll())),this.collapse(),this._changeDetector.detectChanges()}highlight(t,e){t.preventDefault(),t.stopPropagation(),this._manager.highlightComponent(e)}_cancelHighlight(t){t.preventDefault(),t.stopPropagation(),this._manager.cancelHighlightedComponent()}}function A(t,e){if(1&t){const t=d.E();u.Tg(0,"div",1)(1,"button",2),m.N("click",(function(){g.CH(t);const e=h.o();return g.Kt(null==e.rootTreeItem?null:e.rootTreeItem.collapseAll())})),u._U(2,"span",3),u.qZ(),u.Tg(3,"button",4),m.N("click",(function(){g.CH(t);const e=h.o();return g.Kt(null==e.rootTreeItem?null:e.rootTreeItem.expandAll())})),u._U(4,"span",5),u.qZ(),u._U(5,"components-tree-item",6),u.qZ()}if(2&t){const t=h.o();f.x(5),v.Q("data",t.root)}}Z.ɵfac=function(t){return new(t||Z)(C.Y(O.t),C.Y(M.s))},Z.ɵcmp=D.Xp({type:Z,selectors:[["components-tree-item"]],viewQuery:function(t,e){if(1&t&&w.Gf(Z,5),2&t){let t;w.iG(t=w.CR())&&(e._childrenNodes=t)}},hostBindings:function(t,e){1&t&&m.N("mouseleave",(function(t){return e._cancelHighlight(t)}))},inputs:{data:"data",open:"open"},exportAs:["componentsTreeItem"],standalone:!0,features:[k.j],decls:5,vars:8,consts:[[1,"flex","align-items-center",3,"ngClass"],["mat-icon-button","",3,"click",4,"ngIf"],[3,"mouseover","click"],["class","node-children","cdkDropList","","connectDropLists","","connectDropListsPrefix","component-tree-",3,"cdkDropListEnterPredicate","id","hidden","cdkDropListDropped",4,"ngIf"],["mat-icon-button","",3,"click"],[1,"fa",3,"ngClass"],["cdkDropList","","connectDropLists","","connectDropListsPrefix","component-tree-",1,"node-children",3,"cdkDropListEnterPredicate","id","cdkDropListDropped"],["cdkDrag","","class","node-child",3,"cdkDragData","cdkDragDisabled",4,"ngFor","ngForOf"],["cdkDrag","",1,"node-child",3,"cdkDragData","cdkDragDisabled"],[3,"data"]],template:function(t,e){1&t&&(u.Tg(0,"div",0),b.Y(1,Y,2,2,"button",1),u.Tg(2,"div",2),m.N("mouseover",(function(t){return e.highlight(t,null==e.data||null==e.data.component||null==e.data.component.options||null==e.data.component.options.typeMetadata?null:e.data.component.options.typeMetadata.id)}))("click",(function(){return e._manager.selectComponent(null==e.data||null==e.data.component||null==e.data.component.options||null==e.data.component.options.typeMetadata?null:e.data.component.options.typeMetadata.id)})),T._(3),u.qZ()(),b.Y(4,q,2,5,"div",3)),2&t&&(v.Q("ngClass",e.hasChildren?"nested-node-tree":"node-tree"),f.x(1),v.Q("ngIf",e.hasChildren),f.x(1),x.ek("selected",(null==e.data||null==e.data.component||null==e.data.component.options||null==e.data.component.options.typeMetadata?null:e.data.component.options.typeMetadata.id)===e._manager.selectedComponent)("highlighted",(null==e.data||null==e.data.component||null==e.data.component.options||null==e.data.component.options.typeMetadata?null:e.data.component.options.typeMetadata.id)===e._manager.highlightedComponent),f.x(1),N.Oq((null==e.data||null==e.data.component||null==e.data.component.options||null==e.data.component.options.typeMetadata?null:e.data.component.options.typeMetadata.displayName)||(null==e.data||null==e.data.component||null==e.data.component.options||null==e.data.component.options.typeMetadata?null:e.data.component.options.typeMetadata.id)),f.x(1),v.Q("ngIf",e.hasChildren||e._canDrop()))},dependencies:[Z,s.e,I.m,P.s,R.O,r.o,L.l,l._,S.W,F.Z,p.z],styles:["[_nghost-%COMP%]\n{\n    display: block;\n}\n\n.highlighted[_ngcontent-%COMP%]\n{\n    text-shadow: 0 0 2px #666;\n}\n\n.selected[_ngcontent-%COMP%]\n{\n    text-shadow: 0 0 2px #009cd7;\n}\n\n.node-tree[_ngcontent-%COMP%], .nested-node-tree[_ngcontent-%COMP%]\n{\n    min-height: 48px;\n}\n\n.node-children[_ngcontent-%COMP%] \n{\n  padding-left: 20px;\n  min-height: 10px;\n}\n\n.node-child[_ngcontent-%COMP%]\n{\n    padding-left: 20px;\n}"],changeDetection:0});class E{constructor(t,e){this._manager=t,this._changeDetector=e,this._initSubscriptions=new c.w}ngOnInit(){this._initSubscriptions.add(this._manager.layoutChange.subscribe((()=>{this.root=this._manager.root,this._changeDetector.detectChanges()}))),this._initSubscriptions.add(this._manager.selectedChange.subscribe((()=>{this.rootTreeItem?.expand(this._manager.selectedComponent),this._changeDetector.detectChanges()}))),this._initSubscriptions.add(this._manager.highlightedChange.subscribe((()=>this._changeDetector.detectChanges()))),this._initSubscriptions.add(this._manager.displayNameChange.subscribe((()=>this._changeDetector.detectChanges()))),this.root=this._manager.root}ngOnDestroy(){this._initSubscriptions.unsubscribe()}hasChild(t){return!!t.children&&t.children.length>0}}E.ɵfac=function(t){return new(t||E)(C.Y(O.t),C.Y(M.s))},E.ɵcmp=D.Xp({type:E,selectors:[["components-tree"]],viewQuery:function(t,e){if(1&t&&w.Gf(Z,5),2&t){let t;w.iG(t=w.CR())&&(e.rootTreeItem=t.first)}},standalone:!0,features:[k.j],decls:1,vars:1,consts:[["class","component-tree",4,"ngIf"],[1,"component-tree"],["mat-icon-button","","aria-label","Collapse all",3,"click"],[1,"fa","fa-minus-square"],["mat-icon-button","","aria-label","Expand all",3,"click"],[1,"fa","fa-plus-square"],[3,"data"]],template:function(t,e){1&t&&b.Y(0,A,6,1,"div",0),2&t&&v.Q("ngIf",e.root)},dependencies:[s.e,R.O,r.o,L.l,l._,Z],styles:["[_nghost-%COMP%]\n{\n    display: block;\n    background-color: #fafafa;\n    border-right: 1px solid #ccc;\n}"],changeDetection:0});var U=n(46480),j=n(57466),$=n(43939);class G{transform(t,e){const n=`${t.itemSource.name}-${e}`;return{metadata:{id:n,displayName:n,package:t.itemSource.package,name:t.itemSource.name,options:(0,j.l7)(!0,{},t.metadata.metaInfo?.defaultOptions)},parentId:null}}}G.ɵfac=function(t){return new(t||G)},G.ɵpipe=D.Yj({name:"toLayoutDragData",type:G,pure:!0,standalone:!0});var V=n(69307),B=n(53015),X=n(4820),H=n(65589),J=n(4477),K=n(85902),W=n(32434),tt=n(10866),et=n(22549);function nt(t,e,n,o,a,i,s){try{var r=t[i](s),l=r.value}catch(t){return void n(t)}r.done?e(l):Promise.resolve(l).then(o,a)}function ot(t,e){1&t&&u._U(0,"layout-editor-drag-placeholder",10)}function at(t,e){if(1&t&&(u._U(0,"layout-editor-drag-preview",11),H.AL(1,"toLayoutDragData")),2&t){const t=h.o().$implicit,e=h.o(2);v.Q("editorMetadata",t.metadata)("layoutMetadata",H.xi(1,2,t,e._newCompnentId).metadata)}}function it(t,e){if(1&t&&(u.Tg(0,"div",12),T._(1),u.qZ()),2&t){const t=h.o().$implicit;f.x(1),N.Oq(null==t.metadata.metaInfo?null:t.metadata.metaInfo.description)}}function st(t,e){if(1&t){const t=d.E();u.Tg(0,"div",4)(1,"div",5),m.N("cdkDragDropped",(function(){g.CH(t);const e=h.o(2);return g.Kt(e._generateNewId())}))("cdkDragEnded",(function(){g.CH(t);const e=h.o().$implicit,n=h.o();return g.Kt(n._onDragEnded(e.key))}))("cdkDragStarted",(function(e){const n=g.CH(t).$implicit,o=h.o().$implicit,a=h.o();return g.Kt(a._onDragStarted(e,o.key,n))})),H.AL(2,"toLayoutDragData"),b.Y(3,ot,1,0,"layout-editor-drag-placeholder",6),b.Y(4,at,2,5,"layout-editor-drag-preview",7),u.Tg(5,"div",8),T._(6),u.qZ(),b.Y(7,it,2,1,"div",9),u.qZ()()}if(2&t){const t=e.$implicit,n=h.o(2);let o;v.Q("cdkDropListConnectedTo",n._designerDropLists),f.x(1),v.Q("cdkDragData",H.xi(2,4,t,n._newCompnentId)),f.x(5),N.Oq(null!==(o=null==t.metadata.metaInfo?null:t.metadata.metaInfo.name)&&void 0!==o?o:t.itemSource.name),f.x(1),v.Q("ngIf",null==t.metadata.metaInfo?null:t.metadata.metaInfo.description)}}function rt(t,e){if(1&t&&(J.yn(0),u.Tg(1,"div",2),T._(2),u.qZ(),b.Y(3,st,8,7,"div",3),J.BQ()),2&t){const t=e.$implicit;f.x(2),N.hi("",t.key," "),f.x(1),v.Q("ngForOf",t.value)}}class lt{constructor(t,e,n,o,a){this._moduleTypesLoader=t,this._changeDetector=e,this._metadataExtractor=n,this._metadataManager=o,this._logger=a,this._initSubscriptions=new c.w,this._allItems=[],this._groupedItems={},this._designerDropLists=[],this._newCompnentId=(0,j.Ox)(16),this._isDragOverPalette=!1}ngOnInit(){var t,e=this;return(t=function*(){var t;e._initSubscriptions.add(e._metadataManager.layoutChange.subscribe((()=>e._getDesignerDropLists()))),e._getDesignerDropLists();for(const t of["basic-components","material-components"]){const n=(yield e._moduleTypesLoader.loadItem({package:t,name:"types"}))?.data??[];for(const o of n){const n={package:t,name:o},a=yield e._metadataExtractor.extractMetadata(n);a?e._allItems.push({itemSource:n,metadata:a}):e._logger?.warn("ComponentsPaletteSAComponent: Failed to obtain layout editor metadata {@source}",n)}}e._groupedItems[""]=[];for(const n of e._allItems){const o=n.metadata.metaInfo?.group??"";(t=e._groupedItems)[o]??(t[o]=[]),e._groupedItems[o].push(n)}e._changeDetector.detectChanges()},function(){var e=this,n=arguments;return new Promise((function(o,a){var i=t.apply(e,n);function s(t){nt(i,o,a,s,r,"next",t)}function r(t){nt(i,o,a,s,r,"throw",t)}s(void 0)}))})()}ngOnDestroy(){this._initSubscriptions.unsubscribe()}_generateNewId(){this._newCompnentId=(0,j.Ox)(16)}_onDragEnded(t){(0,$.EN)(t)&&(this._groupedItems[t]=[...this._groupedItems[t].filter((t=>!t.temp))])}_onDragStarted(t,e,n){const o=t.source.dropContainer.getSortedItems().findIndex((e=>e.data?.metadata?.id===t.source.data?.metadata?.id));(0,$.EN)(o)&&this._groupedItems[e]?.splice(o+1,0,{...n,temp:!0})}_getDesignerDropLists(){this._designerDropLists=this._metadataManager.flatTree.map((t=>t.component.id)).reverse()}}lt.ɵfac=function(t){return new(t||lt)(C.Y(X.QT),C.Y(M.s),C.Y(K.T),C.Y(O.t),C.Y(U.bZ,8))},lt.ɵcmp=D.Xp({type:lt,selectors:[["components-palette"]],standalone:!0,features:[k.j],decls:3,vars:3,consts:[[1,"flex-column"],[4,"ngFor","ngForOf"],[1,"text-spread","text-small-caps","margin-left-extra-small","margin-horizontal-small","bold"],["cdkDropList","","cdkDropListSortingDisabled","","class","palette-droplist",3,"cdkDropListConnectedTo",4,"ngFor","ngForOf"],["cdkDropList","","cdkDropListSortingDisabled","",1,"palette-droplist",3,"cdkDropListConnectedTo"],["cdkDrag","",1,"editor-component","mat-elevation-z2",3,"cdkDragData","cdkDragDropped","cdkDragEnded","cdkDragStarted"],["class","mat-elevation-z6",4,"cdkDragPlaceholder"],["class","mat-elevation-z4",3,"editorMetadata","layoutMetadata",4,"cdkDragPreview"],[1,"editor-component-name"],["class","editor-component-description",4,"ngIf"],[1,"mat-elevation-z6"],[1,"mat-elevation-z4",3,"editorMetadata","layoutMetadata"],[1,"editor-component-description"]],template:function(t,e){1&t&&(u.Tg(0,"div",0),b.Y(1,rt,4,2,"ng-container",1),H.AL(2,"keyvalue"),u.qZ()),2&t&&(f.x(1),v.Q("ngForOf",H.lc(2,1,e._groupedItems)))},dependencies:[s.e,P.s,R.O,W.N,l._,S.W,F.Z,tt.p,et.H,B.s,V.a,G],styles:[".editor-component[_ngcontent-%COMP%]\n{\n    margin: 2px 10px;\n    padding: 4px 8px;\n\n    border-radius: 6px;\n    border: 1px solid #F0F0F0;\n    background-color: #FAFAFA;\n}\n\n.editor-component-name[_ngcontent-%COMP%]\n{\n    font-weight: 500;\n}\n\n.editor-component-description[_ngcontent-%COMP%]\n{\n    margin-left: 4px;\n    margin-top: 2px;\n    font-size: .8em;\n}\n\n.palette-droplist[_ngcontent-%COMP%]   layout-editor-drag-placeholder[_ngcontent-%COMP%]\n{\n    display: none;\n}"],changeDetection:0});var ct=n(70625),pt=n(68624),dt=n(71791),ut=n(39163),mt=n(77880),gt=n(75846),ht=n(87316),_t=n(43801),ft=n(47098),vt=n(39273),yt=n(49280),bt=n(77470),xt=n(27635),Ct=n(15750),Mt=n(67406),Dt=n(61939);class wt extends vt.L{}wt.ɵfac=function(){let t;return function(e){return(t||(t=_t.n5(wt)))(e||wt)}}(),wt.ɵcmp=D.Xp({type:wt,selectors:[["input-number"]],features:[ft.q],decls:2,vars:3,consts:[["type","text","number","",1,"form-control",3,"formControl"]],template:function(t,e){1&t&&(u._U(0,"input",0),H.AL(1,"asRequired")),2&t&&v.Q("formControl",H.lc(1,1,e._control))},dependencies:[yt.Fj,bt.JJ,xt.oH,Ct.N,Mt.L,Dt.i],styles:["[_nghost-%COMP%]{display: block;}"],changeDetection:0});var kt=n(21147);const Tt=function(){return["px","pt","em","%"]};class Nt extends vt.L{constructor(){super(...arguments),this._value=new ct.NI(null),this._unit=new ct.NI("px",{nonNullable:!0})}_controlSet(){const t=this._control?.value;if(t){const e=/^(\d*\.?\d+)\s*([^0-9.]+$)/.exec(t);if(e)return this._value.setValue(+e[1]),void this._unit.setValue(e[2])}this._unit.setValue("px"),this._value.setValue(null)}_initialize(){this._value.valueChanges.subscribe((t=>{const e=this._unit.value;t&&e?this.control?.setValue(`${t}${e}`):this._control?.setValue(null)})),this._unit.valueChanges.subscribe((t=>{const e=this._value.value;e&&t?this.control?.setValue(`${e}${t}`):this._control?.setValue(null)}))}}Nt.ɵfac=function(){let t;return function(e){return(t||(t=_t.n5(Nt)))(e||Nt)}}(),Nt.ɵcmp=D.Xp({type:Nt,selectors:[["input-size"]],features:[ft.q],decls:2,vars:4,consts:[[3,"control"],[3,"control","values"]],template:function(t,e){1&t&&u._U(0,"input-number",0)(1,"select-value",1),2&t&&(v.Q("control",e._value),f.x(1),v.Q("control",e._unit)("values",y.Dd(3,Tt)))},dependencies:[wt,kt.f],styles:["[_nghost-%COMP%]{display: flex;}"],changeDetection:0});var Ot=n(9204);class It extends ht.k{get _margin(){return this.form?.controls.margin}}It.ɵfac=function(){let t;return function(e){return(t||(t=_t.n5(It)))(e||It)}}(),It.ɵcmp=D.Xp({type:It,selectors:[["margin-control"]],features:[ft.q],decls:15,vars:12,consts:[[1,"flex-column"],[1,"align-self-center",3,"control"],[1,"flex-row"],[1,"flex-1"],[3,"control"],[2,"width","20px","height","20px","border","1px solid #aaa"]],template:function(t,e){1&t&&(u.Tg(0,"div"),T._(1,"Margin"),u.qZ(),u.Tg(2,"div",0),u._U(3,"input-size",1),H.AL(4,"asFormControl"),u.Tg(5,"div",2)(6,"div",3),u._U(7,"input-size",4),H.AL(8,"asFormControl"),u.qZ(),u._U(9,"div",5),u.Tg(10,"div",3),u._U(11,"input-size",4),H.AL(12,"asFormControl"),u.qZ()(),u._U(13,"input-size",1),H.AL(14,"asFormControl"),u.qZ()),2&t&&(f.x(3),v.Q("control",H.lc(4,4,null==e._margin||null==e._margin.controls?null:e._margin.controls.top)),f.x(4),v.Q("control",H.lc(8,6,null==e._margin||null==e._margin.controls?null:e._margin.controls.left)),f.x(4),v.Q("control",H.lc(12,8,null==e._margin||null==e._margin.controls?null:e._margin.controls.right)),f.x(2),v.Q("control",H.lc(14,10,null==e._margin||null==e._margin.controls?null:e._margin.controls.bottom)))},dependencies:[Nt,Ot.j],encapsulation:2,changeDetection:0});class Pt extends ht.k{get _padding(){return this.form?.controls.padding}}Pt.ɵfac=function(){let t;return function(e){return(t||(t=_t.n5(Pt)))(e||Pt)}}(),Pt.ɵcmp=D.Xp({type:Pt,selectors:[["padding-control"]],features:[ft.q],decls:15,vars:12,consts:[[1,"flex-column"],[1,"align-self-center",3,"control"],[1,"flex-row"],[1,"flex-1"],[3,"control"],[2,"width","20px","height","20px","border","1px solid #aaa"]],template:function(t,e){1&t&&(u.Tg(0,"div"),T._(1,"Padding"),u.qZ(),u.Tg(2,"div",0),u._U(3,"input-size",1),H.AL(4,"asFormControl"),u.Tg(5,"div",2)(6,"div",3),u._U(7,"input-size",4),H.AL(8,"asFormControl"),u.qZ(),u._U(9,"div",5),u.Tg(10,"div",3),u._U(11,"input-size",4),H.AL(12,"asFormControl"),u.qZ()(),u._U(13,"input-size",1),H.AL(14,"asFormControl"),u.qZ()),2&t&&(f.x(3),v.Q("control",H.lc(4,4,null==e._padding||null==e._padding.controls?null:e._padding.controls.top)),f.x(4),v.Q("control",H.lc(8,6,null==e._padding||null==e._padding.controls?null:e._padding.controls.left)),f.x(4),v.Q("control",H.lc(12,8,null==e._padding||null==e._padding.controls?null:e._padding.controls.right)),f.x(2),v.Q("control",H.lc(14,10,null==e._padding||null==e._padding.controls?null:e._padding.controls.bottom)))},dependencies:[Nt,Ot.j],encapsulation:2,changeDetection:0});var Rt=n(80198),Lt=n(59951),St=n(38327),Ft=n(19989),Yt=n(46361);class zt{}zt.ɵfac=function(t){return new(t||zt)},zt.ɵmod=D.oA({type:zt}),zt.ɵinj=St.cJ({imports:[s.e,ut.z,Lt.i,mt.j]}),D.B6(gt.e,[It,Pt],[]),D.B6(Rt.H,[P.s,R.O,Ft.i,Yt.H],[Ot.j]);var Qt=n(73379),qt=n(11776);class Zt{constructor(t,e){this._layoutPropertiesSymbols=t,this._logger=e}extract(t){if(!t)return null;this._logger?.debug(`LayoutEditorPropertyMetadataExtractor: Trying to extract properties metadata '${t.name}'`);const e={};for(const n of this._layoutPropertiesSymbols){const o=Reflect.get(t.prototype,n);(0,j.l7)(!0,e,o)}return e}}Zt.ɵfac=function(t){return new(t||Zt)(qt.LF(X.RI),qt.LF(U.bZ,8))},Zt.ɵprov=St.Yz({token:Zt,factory:Zt.ɵfac,providedIn:"root"});var At=n(87606),Et=n(15783),Ut=n(36973);function jt(t,e,n,o,a,i,s){try{var r=t[i](s),l=r.value}catch(t){return void n(t)}r.done?e(l):Promise.resolve(l).then(o,a)}class $t{constructor(t,e){this._viewContainerRef=t,this._logger=e,this._componentRef=null,this.propertiesMetadata=null}ngOnChanges(){var t,e=this;return(t=function*(){if(e._logger?.debug("PropertiesControlRendererDirective: rendering properties control {@type}",{type:e.type?.name}),e.ngOnDestroy(),e._viewContainerRef.clear(),e.type){const t=e._viewContainerRef.injector;if(e._componentRef=e._viewContainerRef.createComponent(e.type,{injector:t}),e._componentRef){const t=e._componentRef.instance;t.propertiesMetadata=e.propertiesMetadata,t.form=e.form,yield(0,At.K)(t.initialize()),t.invalidateVisuals()}}},function(){var e=this,n=arguments;return new Promise((function(o,a){var i=t.apply(e,n);function s(t){jt(i,o,a,s,r,"next",t)}function r(t){jt(i,o,a,s,r,"throw",t)}s(void 0)}))})()}ngOnDestroy(){this._componentRef&&(this._logger?.debug("PropertiesControlRendererDirective: destroying properties control {@type}",{type:this.type?.name}),this._componentRef?.destroy(),this._componentRef=null)}}function Gt(t,e,n,o,a,i,s){try{var r=t[i](s),l=r.value}catch(t){return void n(t)}r.done?e(l):Promise.resolve(l).then(o,a)}function Vt(t){return function(){var e=this,n=arguments;return new Promise((function(o,a){var i=t.apply(e,n);function s(t){Gt(i,o,a,s,r,"next",t)}function r(t){Gt(i,o,a,s,r,"throw",t)}s(void 0)}))}}function Bt(t,e){if(1&t&&(J.yn(0),J.Gk(1,8),J.BQ()),2&t){const t=e.$implicit,n=h.o().$implicit;f.x(1),v.Q("propertiesControl",t)("form",n.form)("propertiesMetadata",n.metadata)}}function Xt(t,e){if(1&t&&(J.yn(0),b.Y(1,Bt,2,3,"ng-container",7),J.BQ()),2&t){const t=e.$implicit;f.x(1),v.Q("ngForOf",t.controls)}}function Ht(t,e){if(1&t&&(u.Tg(0,"div",1)(1,"div",2),T._(2,"Properties "),u.Tg(3,"span",3),T._(4),u.qZ()(),u.Tg(5,"div",4)(6,"label",5),T._(7,"Display name"),u.qZ(),u._U(8,"input",6),u.qZ(),b.Y(9,Xt,2,1,"ng-container",7),u.qZ()),2&t){const t=h.o();let e;f.x(4),N.As("",null!==(e=null==t._metadata||null==t._metadata.metaInfo?null:t._metadata.metaInfo.name)&&void 0!==e?e:null==t._component||null==t._component.options||null==t._component.options.typeMetadata?null:t._component.options.typeMetadata.name," - ",null==t._component||null==t._component.options||null==t._component.options.typeMetadata?null:t._component.options.typeMetadata.id,""),f.x(4),v.Q("formControl",t._displayName),f.x(1),v.Q("ngForOf",t._propertiesData)}}$t.ɵfac=function(t){return new(t||$t)(C.Y(Et.s_),C.Y(U.bZ,8))},$t.ɵdir=D.lG({type:$t,selectors:[["","propertiesControl",""]],inputs:{form:"form",propertiesMetadata:"propertiesMetadata",type:["propertiesControl","type"]},features:[Ut.T]});class Jt{constructor(t,e,n,o,a,i){this._manager=t,this._metadataExtractor=e,this._propertyExtractor=n,this._formModelBuilder=o,this._changeDetector=a,this._logger=i,this._initSubscriptions=new c.w,this._optionsFormSubscription=null,this._visible=!1,this._component=null,this._metadata=null,this._displayName=new ct.NI(null),this._propertiesData=[]}ngOnInit(){this._initSubscriptions.add(this._manager.layoutChange.subscribe((()=>this._initProperties()))),this._initSubscriptions.add(this._manager.selectedChange.subscribe((()=>this._initProperties()))),this._displayName.valueChanges.subscribe((t=>{this._component?.options?.typeMetadata&&(0,$.EN)(t)&&(this._component.options.typeMetadata.displayName=t,this._component.options=this._component.options,this._manager.displayNameUpdated())})),this._initProperties()}ngOnDestroy(){this._initSubscriptions.unsubscribe(),this._optionsFormSubscription?.unsubscribe(),this._optionsFormSubscription=null}_initProperties(){var t=this;return Vt((function*(){if((0,$.EN)(t._manager.selectedComponent)){t._visible=!0;const e=t._manager.getComponent(t._manager.selectedComponent);e?(t._visible=!0,t._component=e,yield t._getMetadata()):t._hide()}else t._hide()}))()}_getMetadata(){var t=this;return Vt((function*(){if(t._component?.options?.typeMetadata){if(t._displayName.setValue(t._component.options.typeMetadata.displayName||t._component.options.typeMetadata.id,{emitEvent:!1}),t._metadata=yield t._metadataExtractor.extractMetadata(t._component.options?.typeMetadata),t._metadata||(t._logger?.error("PropertiesEditorSAComponent: unable to get metadata {@source}",{package:t._component.options?.typeMetadata.package,name:t._component.options?.typeMetadata.name}),t._hide()),t._optionsFormSubscription?.unsubscribe(),t._optionsFormSubscription=new c.w,t._propertiesData=[],t._metadata?.metaInfo?.optionsMetadata?.propertiesMetadata?.length)for(const e of t._metadata?.metaInfo?.optionsMetadata?.propertiesMetadata){const n=t._formModelBuilder.build(new e.modelType(t._component?.options?.typeMetadata.options)),o=t._propertyExtractor.extract(e.modelType);t._optionsFormSubscription.add(n.valueChanges.subscribe((e=>{t._component?.options?.typeMetadata&&((0,j.l7)(!0,t._component.options.typeMetadata.options,e),t._component.options=t._component.options,t._component.invalidateVisuals())}))),t._propertiesData.push({form:n,metadata:o,controls:e.propertiesControls})}if(t._component){const e=t._manager.getParent(t._component.id);if(e?.options?.typeMetadata){const n=yield t._metadataExtractor.extractMetadata(e.options?.typeMetadata);if(n?.metaInfo?.optionsMetadata?.childPropertiesMetadata?.length)for(const e of n?.metaInfo?.optionsMetadata?.childPropertiesMetadata){const n=t._formModelBuilder.build(new e.modelType(t._component?.options?.typeMetadata.options)),o=t._propertyExtractor.extract(e.modelType);t._optionsFormSubscription.add(n.valueChanges.subscribe((e=>{t._component?.options?.typeMetadata&&((0,j.l7)(!0,t._component.options.typeMetadata.options,e),t._component.options=t._component.options,t._component.invalidateVisuals())}))),t._propertiesData.push({form:n,metadata:o,controls:e.propertiesControls})}}}}else t._hide();t._changeDetector.detectChanges()}))()}_hide(){this._visible=!1,this._component=null,this._metadata=null,this._propertiesData=[],this._optionsFormSubscription?.unsubscribe(),this._optionsFormSubscription=null,this._changeDetector.detectChanges()}}Jt.ɵfac=function(t){return new(t||Jt)(C.Y(O.t),C.Y(K.T),C.Y(Zt),C.Y(dt.p),C.Y(M.s),C.Y(U.bZ,8))},Jt.ɵcmp=D.Xp({type:Jt,selectors:[["properties-editor"]],standalone:!0,features:[Qt._([dt.p]),k.j],decls:1,vars:1,consts:[["class","properties-main",4,"ngIf"],[1,"properties-main"],[1,"header"],[1,"bold"],[1,"form-group"],[1,"control-label"],["type","text",1,"form-control",3,"formControl"],[4,"ngFor","ngForOf"],[3,"propertiesControl","form","propertiesMetadata"]],template:function(t,e){1&t&&b.Y(0,Ht,10,4,"div",0),2&t&&v.Q("ngIf",e._visible)},dependencies:[s.e,P.s,R.O,pt.U,yt.Fj,bt.JJ,xt.oH,zt,$t],styles:["[_nghost-%COMP%]\n{\n    display: flex;\n    flex-direction: column;\n}\n\n.properties-main[_ngcontent-%COMP%]\n{\n    display: flex;\n    flex-direction: column;\n    flex: 1;\n    min-height: 0;\n    border: 1px solid #bbb;\n    background-color: #F5F5F5;\n}\n\n.header[_ngcontent-%COMP%]\n{\n    padding: 2px 8px;\n    background-color: #bbb;\n}\n\n.form-group[_ngcontent-%COMP%]\n{\n    margin: 4px 6px 0;\n}"],changeDetection:0});var Kt=n(75957),Wt=n(94761),te=n(93259),ee=n(27049);const ne="LAYOUT_DATA";class oe{constructor(t){this._storage=t}setData(t,e){const n=this._storage.get(ne)??{};n[t]=e,this._storage.set(ne,n)}getData(t){return this._storage.get(ne)?.[t]??null}removeData(t){const e=this._storage.get(ne)??{};delete e[t],this._storage.set(ne,e)}getStored(){const t=this._storage.get(ne)??{};return Object.keys(t)}}var ae,ie;oe.ɵfac=function(t){return new(t||oe)(qt.LF(U.T0))},oe.ɵprov=St.Yz({token:oe,factory:oe.ɵfac,providedIn:"root"}),function(t){t[t.Light=200]="Light",t[t.Normal=400]="Normal",t[t.SemiBold=600]="SemiBold",t[t.Bold=700]="Bold"}(ae||(ae={})),function(t){t[t.px=0]="px",t[t.pt=1]="pt",t[t.em=2]="em"}(ie||(ie={}));class se{}se.demoLayout={id:"gridPanelTest",package:"basic-components",name:"gridPanel",options:{columns:[{width:"1fr"},{width:"2fr"},{width:"1fr"},{width:"100px"}],rows:[{height:"300px"}],cells:[{id:"celltest",package:"basic-components",name:"gridPanelCell",options:{gridColumnStart:2,gridColumnEnd:3,gridRowStart:1,gridRowEnd:2,component:{id:"stackPanelTest",package:"basic-components",name:"stackPanel",options:{padding:{top:"20px"},children:[{id:"textTest",package:"basic-components",name:"textBlock",options:{text:"toto je text",margin:{top:"10px",bottom:"6px",left:"12px",right:"14pt"},padding:{top:"8px",bottom:"8px",left:"12px",right:"12px"},textStyling:{fontSize:"20px"},flex:"1"}},{id:"text2Test",package:"basic-components",name:"textBlock",options:{text:"druhý riadok je toto",textStyling:{fontWeight:ae.Bold}}},{id:"button-test",package:"basic-components",name:"button",options:{text:"test btn"}}]}}}},{id:"anotherCell",package:"basic-components",name:"gridPanelCell",options:{gridColumnStart:3,gridColumnEnd:4,gridRowStart:1,gridRowEnd:2,component:{package:"basic-components",id:"textJeTo",name:"textBlock",options:{text:"nový text"}}}},{id:"gridCellxxx",package:"basic-components",name:"gridPanelCell",options:{gridColumnStart:4,gridColumnEnd:5,gridRowStart:1,gridRowEnd:2,component:{id:"stackPanelxxx",package:"basic-components",name:"stackPanel",options:{horizontal:!0,children:[]}}}}]}},se.relationsDemo=[{id:"sample-source",package:"basic-components",name:"sampleSource",relationsOptions:null,outputs:[{outputName:"vystup",inputs:[{id:"relations-sample-click",inputName:"vstup"}]}],nodeMetadata:{coordinates:{x:30,y:60},options:null}},{id:"relations-sample-click",package:"static-components",name:"relations-sample-click",relationsOptions:null,outputs:[{outputName:"vystup",inputs:[{id:"sample-changes",inputName:"vstup"}]}],nodeMetadata:{coordinates:{x:230,y:80},options:null}},{id:"sample-changes",package:"basic-components",name:"sampleChange",relationsOptions:null,outputs:[{outputName:"vystup",inputs:[{id:"relations-result",inputName:"vstup"}]}],nodeMetadata:{coordinates:{x:430,y:100},options:null}},{id:"relations-result",package:"static-components",name:"relations-result",relationsOptions:null,outputs:[],nodeMetadata:{coordinates:{x:630,y:60},options:null}}];var re=n(60405),le=n(2538),ce=n(75464),pe=n(31676);let de=class{constructor(t,e){this._manager=t,this._store=e,this._metadata=null}get emptyMetadata(){return{id:`stackPanel-${(0,j.Ox)(10)}`,displayName:"root",package:"basic-components",name:"stackPanel",options:{children:[]}}}_getMetadata(){return this._manager.getMetadata()}_loadDemo(){this._metadata=se.demoLayout}};de.ɵfac=function(t){return new(t||de)(C.Y(O.t),C.Y(oe))},de.ɵcmp=D.Xp({type:de,selectors:[["layout-editor-view"]],features:[Qt._([te.NX,O.t])],decls:14,vars:3,consts:[[1,"flex-row"],["routePath","/editor",3,"store","getMetadataCallback","metadataChange"],["type","button",1,"btn","btn-primary",3,"click"],[1,"flex-row","margin-top-big","flex-1"],["label","Hierarchy"],["label","Palette"],[1,"flex-1"],[3,"layoutComponentRenderer"]],template:function(t,e){1&t&&(u.Tg(0,"div",0)(1,"load-save-new",1),m.N("metadataChange",(function(t){let n;return e._metadata=null!==(n=t)&&void 0!==n?n:e.emptyMetadata})),u.qZ(),u.Tg(2,"button",2),m.N("click",(function(){return e._loadDemo()})),u.Tg(3,"span"),T._(4,"demo"),u.qZ()()(),u.Tg(5,"div",3)(6,"mat-tab-group")(7,"mat-tab",4),u._U(8,"components-tree"),u.qZ(),u.Tg(9,"mat-tab",5),u._U(10,"components-palette"),u.qZ()(),u.Tg(11,"div",6),J.Gk(12,7),u.qZ(),u._U(13,"properties-editor"),u.qZ()),2&t&&(f.x(1),v.Q("store",e._store)("getMetadataCallback",e._getMetadata),f.x(11),v.Q("layoutComponentRenderer",e._metadata))},dependencies:[re.i,E,lt,Jt,le.SP,ce.u,pe.Q],encapsulation:2,changeDetection:0}),(0,o.gn)([ee.r,(0,o.w6)("design:type",Function),(0,o.w6)("design:paramtypes",[]),(0,o.w6)("design:returntype",Object)],de.prototype,"_getMetadata",null),de=(0,o.gn)([(0,Wt.N)({path:"editor"}),(0,Wt.N)({path:"editor/:id"}),(0,o.w6)("design:paramtypes",[O.t,oe])],de);var ue=n(95176),me=n(25487),ge=n(15467),he=n(73612),_e=n(80149),fe=n(79898),ve=n(58323),ye=n(86170),be=n(4489),xe=n(68965),Ce=n(31686);function Me(t,e){if(1&t&&u._U(0,"ng-option",3),2&t){const t=e.$implicit;v.Q("value",t)("text",t)}}function De(t,e){if(1&t){const t=d.E();u.Tg(0,"form",4),m.N("ngSubmit",(function(){g.CH(t);const e=h.o();return g.Kt(e._submit())})),u.Tg(1,"div",5)(2,"div",6),J.Gk(3,7),u.qZ()(),u.Tg(4,"button",8),T._(5,"Submit"),u.qZ()()}if(2&t){const t=h.o();v.Q("formGroup",t._formGroup),f.x(3),v.Q("layoutComponentRenderer",t._metadata)("layoutComponentRendererInjector",t._formInjector)}}let we=class{constructor(t,e,n,o,a){this._store=t,this._router=e,this._route=n,this._fb=o,this._injector=a,this._available=new ct.NI(""),this._metadata=null,this._availableNames=[]}ngOnInit(){this._availableNames=this._store.getStored(),this._route.params.subscribe((({id:t})=>{t&&(this._available.setValue(t),this._metadata=this._store.getData(t),this._formGroup=this._fb.group({checkbox:!0,datepicker:new Date,number:10,period:"202201",radio:null,select:"foo",textarea:"Text in textarea",text:"classic input field"}),this._formInjector=ue.z.create({parent:this._injector,providers:[{provide:fe.O,useValue:this._formGroup}]})),this._available.valueChanges.subscribe((t=>{this._router.navigate(["/form-preview",t],{skipLocationChange:!1,replaceUrl:!0})}))}))}ngOnDestroy(){}_submit(){console.log(this._formGroup.value)}};function ke(t,e){if(1&t&&u._U(0,"ng-option",5),2&t){const t=e.$implicit;v.Q("value",t)("text",t)}}we.ɵfac=function(t){return new(t||we)(C.Y(oe),C.Y(me.F0),C.Y(ge.gz),C.Y(he.qu),C.Y(ue.z))},we.ɵcmp=D.Xp({type:we,selectors:[["form-preview-view"]],features:[Qt._([O.t])],decls:4,vars:3,consts:[[3,"formControl"],[3,"value","text",4,"ngFor","ngForOf"],[3,"formGroup","ngSubmit",4,"ngIf"],[3,"value","text"],[3,"formGroup","ngSubmit"],[1,"flex-row","margin-top-big","flex-1"],[1,"flex-1","overflow-vertical-scroll"],[3,"layoutComponentRenderer","layoutComponentRendererInjector"],[1,"button"]],template:function(t,e){1&t&&(u.Tg(0,"div")(1,"ng-select",0),b.Y(2,Me,1,2,"ng-option",1),u.qZ()(),b.Y(3,De,6,3,"form",2)),2&t&&(f.x(1),v.Q("formControl",e._available),f.x(1),v.Q("ngForOf",e._availableNames),f.x(1),v.Q("ngIf",e._metadata))},dependencies:[P.s,R.O,ve._,bt.JJ,bt.JL,xt.oH,ye.s,be.x,xe.w,Ce.v,re.i],encapsulation:2,changeDetection:0}),we=(0,o.gn)([(0,_e.R)("","form-preview"),(0,Wt.N)({path:"form-preview"}),(0,Wt.N)({path:"form-preview/:id"}),(0,o.w6)("design:paramtypes",[oe,me.F0,ge.gz,he.qu,ue.z])],we);let Te=class{constructor(t,e,n){this._store=t,this._router=e,this._route=n,this._available=new ct.NI(""),this._metadata=null,this._availableNames=[]}ngOnInit(){this._availableNames=this._store.getStored(),this._route.params.subscribe((({id:t})=>{t&&(this._available.setValue(t),this._metadata=this._store.getData(t)),this._available.valueChanges.subscribe((t=>{this._router.navigate(["/preview",t],{skipLocationChange:!1,replaceUrl:!0})}))}))}ngOnDestroy(){}};Te.ɵfac=function(t){return new(t||Te)(C.Y(oe),C.Y(me.F0),C.Y(ge.gz))},Te.ɵcmp=D.Xp({type:Te,selectors:[["layout-preview-view"]],features:[Qt._([O.t])],decls:6,vars:3,consts:[[3,"formControl"],[3,"value","text",4,"ngFor","ngForOf"],[1,"flex-row","margin-top-big","flex-1"],[1,"flex-1","overflow-vertical-scroll"],[3,"layoutComponentRenderer"],[3,"value","text"]],template:function(t,e){1&t&&(u.Tg(0,"div")(1,"ng-select",0),b.Y(2,ke,1,2,"ng-option",1),u.qZ()(),u.Tg(3,"div",2)(4,"div",3),J.Gk(5,4),u.qZ()()),2&t&&(f.x(1),v.Q("formControl",e._available),f.x(1),v.Q("ngForOf",e._availableNames),f.x(3),v.Q("layoutComponentRenderer",e._metadata))},dependencies:[P.s,bt.JJ,xt.oH,be.x,xe.w,Ce.v,re.i],encapsulation:2,changeDetection:0}),Te=(0,o.gn)([(0,_e.R)("","preview"),(0,Wt.N)({path:"preview"}),(0,Wt.N)({path:"preview/:id"}),(0,o.w6)("design:paramtypes",[oe,me.F0,ge.gz])],Te);var Ne=n(75990),Oe=n(96130),Ie=n(42473),Pe=n(46345);function Re(t,e){1&t&&(u.Tg(0,"div")(1,"div",2),T._(2,"relations sample click"),u.qZ(),u._U(3,"relations-sample-click"),u.qZ())}let Le=class{constructor(t){this._relationsManager=t,this.visible=!0}ngOnInit(){setTimeout((()=>{this._relationsManager.setRelations([{id:"sample-source",package:"basic-components",name:"sampleSource",relationsOptions:null,outputs:[{outputName:"vystup",inputs:[{id:"relations-sample-click",inputName:"vstup"}]}]},{id:"relations-sample-click",package:"static-components",name:"relations-sample-click",relationsOptions:null,outputs:[{outputName:"vystup",inputs:[{id:"sample-changes",inputName:"vstup"}]}]},{id:"sample-changes",package:"basic-components",name:"sampleChange",relationsOptions:null,outputs:[{outputName:"vystup",inputs:[{id:"relations-result",inputName:"vstup"}]}]},{id:"relations-result",package:"static-components",name:"relations-result",relationsOptions:null,outputs:[]}])}),5e3)}};Le.ɵfac=function(t){return new(t||Le)(C.Y(Ne.N))},Le.ɵcmp=D.Xp({type:Le,selectors:[["relations-view"]],features:[Qt._([Ne.N,Oe.v])],decls:9,vars:1,consts:[["type","button",1,"btn","btn-primary",3,"click"],[4,"ngIf"],[1,"bold"]],template:function(t,e){1&t&&(u.Tg(0,"div")(1,"button",0),m.N("click",(function(){return e.visible=!e.visible})),u.Tg(2,"span"),T._(3,"click"),u.qZ()()(),b.Y(4,Re,4,0,"div",1),u.Tg(5,"div")(6,"div",2),T._(7,"relations result"),u.qZ(),u._U(8,"relations-result"),u.qZ()),2&t&&(f.x(4),v.Q("ngIf",e.visible))},dependencies:[R.O,Ie.I,Pe.b],encapsulation:2,changeDetection:0}),Le=(0,o.gn)([(0,Wt.N)({path:"relations"}),(0,o.w6)("design:paramtypes",[Ne.N])],Le);var Se=n(48397);const Fe="RELATIONS_DATA";class Ye{constructor(t){this._storage=t}setData(t,e){const n=this._storage.get(Fe)??{};n[t]=e,this._storage.set(Fe,n)}getData(t){return this._storage.get(Fe)?.[t]??null}removeData(t){const e=this._storage.get(Fe)??{};delete e[t],this._storage.set(Fe,e)}getStored(){const t=this._storage.get(Fe)??{};return Object.keys(t)}}Ye.ɵfac=function(t){return new(t||Ye)(qt.LF(U.T0))},Ye.ɵprov=St.Yz({token:Ye,factory:Ye.ɵfac,providedIn:"root"});let ze=class{constructor(t,e){this._manager=t,this._store=e,this._metadata=[]}get emptyMetadata(){return[]}_getMetadata(){return this._manager.getMetadata()}_loadDemo(){this._metadata=se.relationsDemo}};ze.ɵfac=function(t){return new(t||ze)(C.Y(Se.J),C.Y(Ye))},ze.ɵcmp=D.Xp({type:ze,selectors:[["relations-editor-view"]],features:[Qt._([Se.J])],decls:7,vars:3,consts:[[1,"flex-row"],["routePath","/relations-editor",3,"store","getMetadataCallback","metadataChange"],["type","button",1,"btn","btn-primary",3,"click"],[1,"flex-row","flex-1"],[1,"flex-1",3,"nodeDefinitions"]],template:function(t,e){1&t&&(u.Tg(0,"div",0)(1,"load-save-new",1),m.N("metadataChange",(function(t){let n;return e._metadata=null!==(n=t)&&void 0!==n?n:e.emptyMetadata})),u.qZ(),u.Tg(2,"button",2),m.N("click",(function(){return e._loadDemo()})),u.Tg(3,"span"),T._(4,"demo"),u.qZ()()(),u.Tg(5,"div",3),u._U(6,"relations-canvas",4),u.qZ()),2&t&&(f.x(1),v.Q("store",e._store)("getMetadataCallback",e._getMetadata),f.x(5),v.Q("nodeDefinitions",e._metadata))},dependencies:[Kt.F,pe.Q],encapsulation:2,changeDetection:0}),(0,o.gn)([ee.r,(0,o.w6)("design:type",Function),(0,o.w6)("design:paramtypes",[]),(0,o.w6)("design:returntype",Array)],ze.prototype,"_getMetadata",null),ze=(0,o.gn)([(0,Wt.N)({path:"relations-editor"}),(0,Wt.N)({path:"relations-editor/:id"}),(0,o.w6)("design:paramtypes",[Se.J,Ye])],ze);const Qe=[de,Te,ze,Le,we];var qe=n(42983),Ze=n(60680);let Ae=class{};Ae.ɵfac=function(t){return new(t||Ae)},Ae.ɵmod=D.oA({type:Ae}),Ae.ɵinj=St.cJ({imports:[qe._J,qe.No,qe.nP,E,lt,Jt,Kt.F,a.N,Ze.Qw]}),Ae=(0,o.gn)([(0,i.P)(Qe)],Ae)},79898:(t,e,n)=>{n.d(e,{O:()=>o});const o=new(n(40296).O)("FORM_COMPONENT_CONTROL")},69307:(t,e,n)=>{n.d(e,{a:()=>i});var o=n(13691),a=n(82568);class i{}i.ɵfac=function(t){return new(t||i)},i.ɵcmp=o.Xp({type:i,selectors:[["layout-editor-drag-placeholder"]],standalone:!0,features:[a.j],decls:0,vars:0,template:function(t,e){},styles:["[_nghost-%COMP%]\n{\n    display: block;\n    background: #0096cca2;\n    min-height: 10px;\n    width: 85%;\n    margin-left: auto;\n    margin-right: auto;\n    border-radius: 4px;\n    transition: transform 250ms cubic-bezier(0, 0, 0.2, 1);\n}"],changeDetection:0})},53015:(t,e,n)=>{n.d(e,{s:()=>c});var o=n(13691),a=n(82568),i=n(80827),s=n(41853),r=n(66794),l=n(6427);class c{}c.ɵfac=function(t){return new(t||c)},c.ɵcmp=o.Xp({type:c,selectors:[["layout-editor-drag-preview"]],inputs:{editorMetadata:"editorMetadata",layoutMetadata:"layoutMetadata"},standalone:!0,features:[a.j],decls:4,vars:2,consts:[[1,"semi-bold"],[1,"margin-left-extra-small","small-text"]],template:function(t,e){if(1&t&&(i.Tg(0,"span",0),s._(1),i.qZ(),i.Tg(2,"span",1),s._(3),i.qZ()),2&t){let t;r.x(1),l.Oq(null!==(t=null==e.editorMetadata||null==e.editorMetadata.metaInfo?null:e.editorMetadata.metaInfo.name)&&void 0!==t?t:null==e.layoutMetadata?null:e.layoutMetadata.name),r.x(2),l.hi("#",(null==e.layoutMetadata?null:e.layoutMetadata.displayName)||(null==e.layoutMetadata?null:e.layoutMetadata.id),"")}},styles:["[_nghost-%COMP%]\n{\n    display: block;\n    background-color: #eee;\n    border-radius: 6px;\n    padding: 3px 8px;\n}"],changeDetection:0})},63152:(t,e,n)=>{n.d(e,{z:()=>c});var o=n(38223),a=n(22294),i=n(79440),s=n(13691),r=n(99055),l=n(83434);class c{constructor(t,e){this._cdkDropList=t,this._manager=e,this._initSubscriptions=new o.w,this._connectDropListsPrefix=""}set connectDropListsPrefix(t){this._connectDropListsPrefix=t,this._setConnectedTo()}get connectDropListsPrefix(){return this._connectDropListsPrefix??""}ngOnInit(){this._initSubscriptions.add(this._manager.layoutChange.pipe((0,a.b)(12)).subscribe((()=>this._setConnectedTo()))),this._setConnectedTo()}ngOnDestroy(){this._initSubscriptions.unsubscribe()}_setConnectedTo(){const t=this._manager.flatTree.filter((t=>t.component.canDrop())).map((t=>this.connectDropListsPrefix+t.component.id)).reverse().filter((t=>t!=this._cdkDropList.id));this._cdkDropList.connectedTo=t}}c.ɵfac=function(t){return new(t||c)(i.Y(r.W),i.Y(l.t))},c.ɵdir=s.lG({type:c,selectors:[["","cdkDropList","","connectDropLists",""]],inputs:{connectDropListsPrefix:"connectDropListsPrefix"},exportAs:["connectDropLists"],standalone:!0})},75846:(t,e,n)=>{n.d(e,{e:()=>p});var o=n(87316),a=n(43801),i=n(13691),s=n(47098),r=n(80827),l=n(73301),c=n(66794);class p extends o.k{}p.ɵfac=function(){let t;return function(e){return(t||(t=a.n5(p)))(e||p)}}(),p.ɵcmp=i.Xp({type:p,selectors:[["component-styling"]],features:[s.q],decls:2,vars:4,consts:[[3,"form","propertiesMetadata"]],template:function(t,e){1&t&&r._U(0,"margin-control",0)(1,"padding-control",0),2&t&&(l.Q("form",e.form)("propertiesMetadata",e.propertiesMetadata),c.x(1),l.Q("form",e.form)("propertiesMetadata",e.propertiesMetadata))},encapsulation:2,changeDetection:0})},80198:(t,e,n)=>{n.d(e,{H:()=>R,q:()=>L});var o=n(27052),a=n(39163),i=n(77880),s=n(87316),r=n(59951),l=n(80827),c=n(6845),p=n(73301),d=n(4477),u=n(41853),m=n(15686),g=n(65589),h=n(66794),_=n(6427),f=n(94727),v=n(43801),y=n(13691),b=n(47098),x=n(82568),C=n(12311),M=n(21651),D=n(19989),w=n(46361),k=n(9204);function T(t,e){if(1&t&&l._U(0,"span",5),2&t){const t=c.o().$implicit,e=c.o();p.Q("tooltip",null==e.propertiesMetadata||null==e.propertiesMetadata[t]?null:e.propertiesMetadata[t].description)}}const N=function(){return[]};function O(t,e){if(1&t&&(d.yn(0),l.Tg(1,"div",1)(2,"label",2),u._(3),m.Y(4,T,1,1,"span",3),l.qZ(),d.Gk(5,4),g.AL(6,"asFormControl"),l.qZ(),d.BQ()),2&t){const t=e.$implicit,n=c.o();let o,a;h.x(3),_.hi("",null!==(o=null==n.propertiesMetadata||null==n.propertiesMetadata[t]?null:n.propertiesMetadata[t].name)&&void 0!==o?o:t," "),h.x(1),p.Q("ngIf",null==n.propertiesMetadata||null==n.propertiesMetadata[t]?null:n.propertiesMetadata[t].description),h.x(1),p.Q("propertyTypeControl",null==n.propertiesMetadata||null==n.propertiesMetadata[t]?null:n.propertiesMetadata[t].type)("control",g.lc(6,5,null==n.form?null:n.form.get(t)))("values",null!==(a=null==n.propertiesMetadata||null==n.propertiesMetadata[t]?null:n.propertiesMetadata[t].values)&&void 0!==a?a:f.Dd(7,N))}}function I(t,e){if(1&t&&l._U(0,"span",5),2&t){const t=c.o().$implicit,e=c.o();p.Q("tooltip",null==e.propertiesMetadata||null==e.propertiesMetadata[t]?null:e.propertiesMetadata[t].description)}}function P(t,e){if(1&t&&(d.yn(0),l.Tg(1,"div",1)(2,"label",2),u._(3),m.Y(4,I,1,1,"span",3),l.qZ(),d.Gk(5,4),g.AL(6,"asFormControl"),l.qZ(),d.BQ()),2&t){const t=e.$implicit,n=c.o();let o,a;h.x(3),_.hi("",null!==(o=null==n.propertiesMetadata||null==n.propertiesMetadata[t]?null:n.propertiesMetadata[t].name)&&void 0!==o?o:t," "),h.x(1),p.Q("ngIf",null==n.propertiesMetadata||null==n.propertiesMetadata[t]?null:n.propertiesMetadata[t].description),h.x(1),p.Q("propertyTypeControl",null==n.propertiesMetadata||null==n.propertiesMetadata[t]?null:n.propertiesMetadata[t].type)("control",g.lc(6,5,null==n.form?null:n.form.get(t)))("values",null!==(a=null==n.propertiesMetadata||null==n.propertiesMetadata[t]?null:n.propertiesMetadata[t].values)&&void 0!==a?a:f.Dd(7,N))}}class R extends s.k{constructor(){super(...arguments),this.properties=[]}}function L(t){class e extends R{constructor(){super(...arguments),this.properties=t}}return e.ɵfac=function(){let t;return function(n){return(t||(t=v.n5(e)))(n||e)}}(),e.ɵcmp=y.Xp({type:e,selectors:[["generic-properties-control"]],inputs:{properties:"properties"},standalone:!0,features:[b.q,x.j],decls:1,vars:1,consts:[[4,"ngFor","ngForOf"],[1,"form-group"],[1,"control-label"],["class","fas fa-info-circle",3,"tooltip",4,"ngIf"],[3,"propertyTypeControl","control","values"],[1,"fas","fa-info-circle",3,"tooltip"]],template:function(t,e){1&t&&m.Y(0,P,7,8,"ng-container",0),2&t&&p.Q("ngForOf",e.properties)},dependencies:[o.e,C.s,M.O,a.z,D.i,r.i,w.H,i.j,k.j],encapsulation:2,changeDetection:0}),e}R.ɵfac=function(){let t;return function(e){return(t||(t=v.n5(R)))(e||R)}}(),R.ɵcmp=y.Xp({type:R,selectors:[["default-generic-properties-control"]],inputs:{properties:"properties"},features:[b.q],decls:1,vars:1,consts:[[4,"ngFor","ngForOf"],[1,"form-group"],[1,"control-label"],["class","fas fa-info-circle",3,"tooltip",4,"ngIf"],[3,"propertyTypeControl","control","values"],[1,"fas","fa-info-circle",3,"tooltip"]],template:function(t,e){1&t&&m.Y(0,O,7,8,"ng-container",0),2&t&&p.Q("ngForOf",e.properties)},encapsulation:2,changeDetection:0})},87316:(t,e,n)=>{n.d(e,{k:()=>p});var o=n(87606),a=n(79440),i=n(68961),s=n(13691),r=n(85902);function l(t,e,n,o,a,i,s){try{var r=t[i](s),l=r.value}catch(t){return void n(t)}r.done?e(l):Promise.resolve(l).then(o,a)}function c(t){return function(){var e=this,n=arguments;return new Promise((function(o,a){var i=t.apply(e,n);function s(t){l(i,o,a,s,r,"next",t)}function r(t){l(i,o,a,s,r,"throw",t)}s(void 0)}))}}class p{constructor(t,e){this._changeDetector=t,this._extractor=e,this._initialized=!1,this.propertiesMetadata=null}ngOnInit(){var t=this;return c((function*(){t._initialized||(t._initialized=!0,yield(0,o.K)(t._initialize()))}))()}initialize(){var t=this;return c((function*(){yield(0,o.K)(t.ngOnInit())}))()}invalidateVisuals(){this._changeDetector.detectChanges()}_initialize(){}}p.ɵfac=function(t){return new(t||p)(a.Y(i.s),a.Y(r.T))},p.ɵdir=s.lG({type:p,inputs:{form:"form",propertiesMetadata:"propertiesMetadata"}})},46361:(t,e,n)=>{n.d(e,{H:()=>d});var o=n(46480),a=n(87606),i=n(4820),s=n(79440),r=n(15783),l=n(13691),c=n(36973);function p(t,e,n,o,a,i,s){try{var r=t[i](s),l=r.value}catch(t){return void n(t)}r.done?e(l):Promise.resolve(l).then(o,a)}class d{constructor(t,e,n){this._viewContainerRef=t,this._typeControls=e,this._logger=n,this._componentRef=null,this.values=[]}ngOnChanges(){var t,e=this;return(t=function*(){const t=e.typeName??"inputString";if(e._logger?.debug("PropertyTypeControlRendererDirective: rendering property type control {@type}",{type:t}),e.ngOnDestroy(),e._viewContainerRef.clear(),e.typeName){const n=e._viewContainerRef.injector,o=e._typeControls[t];if(!o)throw e._logger?.error("PropertyTypeControlRendererDirective: unable to find property type control {@type}",{type:t}),new Error(`unable to find property type control ${t}`);if(e._componentRef=e._viewContainerRef.createComponent(o,{injector:n}),e._componentRef){const t=e._componentRef.instance;t.control=e.control,t.values=e.values,yield(0,a.K)(t.initialize()),t.invalidateVisuals()}}},function(){var e=this,n=arguments;return new Promise((function(o,a){var i=t.apply(e,n);function s(t){p(i,o,a,s,r,"next",t)}function r(t){p(i,o,a,s,r,"throw",t)}s(void 0)}))})()}ngOnDestroy(){this._componentRef&&(this._logger?.debug("PropertyTypeControlRendererDirective: destroying property type control {@type}",{type:this.typeName??"inputString"}),this._componentRef?.destroy(),this._componentRef=null)}}d.ɵfac=function(t){return new(t||d)(s.Y(r.s_),s.Y(i.Yh),s.Y(o.bZ,8))},d.ɵdir=l.lG({type:d,selectors:[["","propertyTypeControl",""]],inputs:{control:"control",typeName:["propertyTypeControl","typeName"],values:"values"},features:[c.T]})},59951:(t,e,n)=>{n.d(e,{i:()=>c});var o=n(27052),a=n(68624),i=n(5348),s=n(25626),r=n(13691),l=n(38327);class c{}c.ɵfac=function(t){return new(t||c)},c.ɵmod=r.oA({type:c}),c.ɵinj=l.cJ({imports:[o.e,a.U,i.A,s.F]})},83434:(t,e,n)=>{n.d(e,{t:()=>l});var o=n(46480),a=n(43939),i=n(53682),s=n(11776),r=n(38327);class l{constructor(t){this._logger=t,this._components={},this._rootComponentId=null,this._selectedComponent=null,this._highlightedComponent=null,this._layoutChange=new i.xQ,this._selectedChange=new i.xQ,this._highlightedChange=new i.xQ,this._displayNameChanges=new i.xQ,this._flatTree=null}get selectedComponent(){return this._selectedComponent}get highlightedComponent(){return this._highlightedComponent}get root(){return(0,a.fp)(this._rootComponentId)?null:this._components[this._rootComponentId]}get layoutChange(){return this._layoutChange.asObservable()}get selectedChange(){return this._selectedChange.asObservable()}get highlightedChange(){return this._highlightedChange.asObservable()}get displayNameChange(){return this._displayNameChanges.asObservable()}get flatTree(){return this._flatTree??(this._flatTree=this._buildFlatTree())}selectComponent(t){this._selectedComponent=t??null,this._selectedChange.next()}unselectComponent(){this._selectedComponent=null,this._selectedChange.next()}highlightComponent(t){this._highlightedComponent=t??null,this._highlightedChange.next()}cancelHighlightedComponent(){this._highlightedComponent=null,this._highlightedChange.next()}registerLayoutDesignerComponent(t,e,n){if((0,a.fp)(n)&&(this._rootComponentId=e),this._components[e])return this._logger?.error(`LayoutEditorMetadataManager: Component with id ${e} is already registered!`),!1;const o=n?this._components[n]:null,i={component:t,parent:o,children:[]};return this._components[e]=i,o&&o.children.splice(o.children.length,0,i),this._flatTree=null,this._layoutChange.next(),this._logger?.debug("LayoutEditorMetadataManager: Registering component {@id}",e),!0}getComponent(t){return this._components[t]?.component??null}getParent(t){return this._components[t]?.parent?.component??null}unregisterLayoutDesignerComponent(t){const e=this._components[t];if(delete this._components[t],e?.parent){const t=e.parent.children.indexOf(e);e.parent.children.splice(t,1)}t===this._rootComponentId&&(this._rootComponentId=null),this._flatTree=null,this._layoutChange.next(),this._logger?.debug("LayoutEditorMetadataManager: Unregistering component {@id}",t)}displayNameUpdated(){this._displayNameChanges.next()}getMetadata(){return(0,a.fp)(this._rootComponentId)||!this._components[this._rootComponentId]?null:this._components[this._rootComponentId].component.options?.typeMetadata??null}_buildFlatTree(){if((0,a.fp)(this._rootComponentId))return[];const t=this._components[this._rootComponentId];return t?this._buildFlatTreeForComponent(t):[]}_buildFlatTreeForComponent(t){let e=[t];for(const n of t.children)e=e.concat(this._buildFlatTreeForComponent(n));return e}}l.ɵfac=function(t){return new(t||l)(s.LF(o.bZ,8))},l.ɵprov=r.Yz({token:l,factory:l.ɵfac})},60405:(t,e,n)=>{n.d(e,{i:()=>C});var o,a=n(74445),i=n(95176),s=n(46480),r=n(49891),l=n(87606),c=n(43939);!function(t){t[t.ShowNotFound=0]="ShowNotFound",t[t.Ignore=1]="Ignore",t[t.ThrowError=2]="ThrowError"}(o||(o={}));class p{constructor(t){this.missingTypeBehavior=o.ShowNotFound,(0,c.EN)(t)&&(this.missingTypeBehavior=t)}}var d=n(13691),u=n(82568),m=n(80827),g=n(41853);class h{}h.ɵfac=function(t){return new(t||h)},h.ɵcmp=d.Xp({type:h,selectors:[["not-found-layout-type"]],standalone:!0,features:[u.j],decls:5,vars:0,consts:[[1,"fas","fa-minus-circle"]],template:function(t,e){1&t&&(m.Tg(0,"div"),m._U(1,"span",0),m.Tg(2,"span"),g._(3,"NOT FOUND"),m.qZ(),m._U(4,"span",0),m.qZ())},styles:["[_nghost-%COMP%]{display: block;}"],changeDetection:0});var _=n(8477),f=n(79440),v=n(15783),y=n(73379),b=n(36973);function x(t,e,n,o,a,i,s){try{var r=t[i](s),l=r.value}catch(t){return void n(t)}r.done?e(l):Promise.resolve(l).then(o,a)}class C{constructor(t,e,n,o,i,s){this._viewContainerRef=t,this._loader=e,this._childExtensions=n,this._options=o,this._metadataTransformer=i,this._logger=s,this._componentRef=null,this.componentMetadata=null,this.disableTransformer=!1,this.componentChange=new a.v,this._options&&this._options instanceof p||(this._options=new p)}get component(){return this._componentRef?this._componentRef.instance:null}get componentRef(){return this._componentRef}ngOnChanges(t){var e,n=this;return(e=function*(){if(n._logger?.debug("LayoutComponentRendererSADirective: rendering component {@id}",{id:n.componentMetadata?.id}),n.ngOnDestroy(),n._viewContainerRef.clear(),(0,r.$)("componentMetadata")in t&&n.componentMetadata){const t=n.customInjector||n._viewContainerRef.injector;let e=n.componentMetadata;n._metadataTransformer&&!n.disableTransformer&&(e=n._metadataTransformer(n.componentMetadata,t));const a=yield n._loader.loadItem(e);if(!a){switch(n._logger?.warn("LayoutComponentRendererSADirective: Unable to find layout component type {@type}",{name:e.name,package:e.package}),n._options?.missingTypeBehavior){default:n._viewContainerRef.createComponent(h);break;case o.Ignore:break;case o.ThrowError:throw new Error(`LayoutComponentRendererSADirective: Unable to find layout component type Name: ${e.name} Package: ${e.package}`)}return}const s=i.z.create({parent:t,providers:[{provide:_.X5,useValue:a.childExtensions}]});n._componentRef=n._viewContainerRef.createComponent(a.data,{injector:s}),n._logger?.debug("LayoutComponentRendererSADirective: component rendered {@id}",{id:e?.id}),n.componentChange.next(n._componentRef),n.component&&(n.component.registerExtensions([...n._childExtensions?.map((t=>new t))??[],...a?.extensions?.map((t=>new t))??[]]),n._logger?.debug("LayoutComponentRendererSADirective: initializing component with options {@id}",{id:e?.id}),yield(0,l.K)(n.component.initialize?.(e.options)),n._logger?.debug("LayoutComponentRendererSADirective: invalidating component visuals {@id}",{id:e?.id}),n.component?.invalidateVisuals())}},function(){var t=this,n=arguments;return new Promise((function(o,a){var i=e.apply(t,n);function s(t){x(i,o,a,s,r,"next",t)}function r(t){x(i,o,a,s,r,"throw",t)}s(void 0)}))})()}ngOnDestroy(){this._componentRef&&(this._logger?.debug("LayoutComponentRendererSADirective: destroying component {@id}",{id:this.componentMetadata?.id,designer:this.disableTransformer}),this._componentRef?.destroy(),this._componentRef=null,this.componentChange.next(null))}}C.ɵfac=function(t){return new(t||C)(f.Y(v.s_),f.Y(_.Vl),f.Y(_.X5,12),f.Y(p,8),f.Y(_.xM,8),f.Y(s.bZ,8))},C.ɵdir=d.lG({type:C,selectors:[["","layoutComponentRenderer",""]],inputs:{componentMetadata:["layoutComponentRenderer","componentMetadata"],customInjector:["layoutComponentRendererInjector","customInjector"],disableTransformer:["layoutComponentRendererDisableTransformer","disableTransformer"]},outputs:{componentChange:"layoutComponentRendererComponentChange"},exportAs:["layoutComponentRenderer"],standalone:!0,features:[y._([{provide:_.X5,useValue:null}]),b.T]})},75957:(t,e,n)=>{n.d(e,{F:()=>Q});var o=n(4905),a=n(27052),i=n(9360),s=n(53682),r=n(40362);class l{constructor(t,e,n,o){this._parentGroup=t,this._relationManager=e,this.start=n,this.end=o,this._destroyingSubject=new s.xQ,this.output=null,this.input=null,this._path=this._parentGroup.append("path").attr("fill","transparent").attr("stroke","#48B8B8").attr("stroke-width","3px"),this._lineGenerator=(0,i.jvg)().curve(i.tFB.beta(.75))}get destroying(){return this._destroyingSubject.asObservable()}destroy(){this._path?.remove(),this._destroyingSubject.next()}invalidateVisuals(t){if(t==r.r){const t=this._relationManager.getActiveInput();this._relationManager.setActiveInput(null),t&&t.addRelation(this)?(this.end=t.getCoordinates(),this.input=t):(this.destroy(),this.start=null,this.end=null,this.input=null,this.output=null)}if(!this.start||!this.end)return;let e;if(this.end.x<=this.start.x){let t=this.start.x-this.end.x;const n=(this.end.y-this.start.y)/2;t<12&&(t=12),t*=1.3,e=[[this.start.x,this.start.y],[this.start.x+t,this.start.y+n],[this.end.x-t,this.start.y+n],[this.end.x,this.end.y]]}else{const t=(this.end.x-this.start.x)/3;e=[[this.start.x,this.start.y],[this.start.x+t,this.start.y],[this.end.x-t,this.end.y],[this.end.x,this.end.y]]}this._path.attr("d",this._lineGenerator(e))}}var c=n(26220),p=n(41338),d=n(74445),u=n(46480),m=n(49891),g=n(43939),h=n(5402),_=n(79440),f=n(15783),v=n(13691),y=n(36973),b=n(48397);function x(t,e,n,o,a,i,s){try{var r=t[i](s),l=r.value}catch(t){return void n(t)}r.done?e(l):Promise.resolve(l).then(o,a)}class C{constructor(t,e,n,o){this._viewContainerRef=t,this._relationsNodeManager=e,this._loader=n,this._logger=o,this._componentRef=null,this.componentMetadata=null,this.zoomLevel=1,this.create=new d.v,this.destroy=new d.v}get component(){return this._componentRef?this._componentRef.instance:null}ngOnChanges(t){var e,n=this;return(e=function*(){if((0,m.$)("zoomLevel")in t&&(0,g.EN)(n.zoomLevel)&&!((0,m.$)("componentMetadata")in t)){const e=n.component;if(e){const o=t[(0,m.$)("zoomLevel")];e.zoomLevel=n.zoomLevel;const a={currentValue:o.currentValue,firstChange:!1,previousValue:o.previousValue,isFirstChange:()=>!1},i={};i[(0,m.$)("zoomLevel")]=a,e.ngOnChanges(i),e.invalidateVisuals()}}else if(n._logger?.debug("RelationsNodeRendererSADirective: rendering node {@id}",{id:n.componentMetadata?.id}),n.ngOnDestroy(),n._viewContainerRef.clear(),(0,m.$)("componentMetadata")in t&&n.componentMetadata){const t=yield n._loader.loadItem(n.componentMetadata);if(!t)return void n._logger?.warn("RelationsNodeRendererSADirective: Unable to find relations node type {@type}",{name:n.componentMetadata.name,package:n.componentMetadata.package});if(n._componentRef=n._viewContainerRef.createComponent(t.data,{injector:n._viewContainerRef.injector}),n._logger?.debug("RelationsNodeRendererSADirective: node rendered {@id}",{id:n.componentMetadata?.id}),n.component){const t=n.component;n._logger?.debug("RelationsNodeRendererSADirective: initializing node with metadata {@id}",{id:n.componentMetadata?.id}),t.metadata=n.componentMetadata,t.zoomLevel=n.zoomLevel;const e={};e[(0,m.$)("metadata")]={currentValue:n.componentMetadata,previousValue:null,firstChange:!0,isFirstChange:()=>!0},e[(0,m.$)("zoomLevel")]={currentValue:n.zoomLevel,previousValue:null,firstChange:!0,isFirstChange:()=>!0},t.ngOnChanges(e),n._logger?.debug("RelationsNodeRendererSADirective: invalidating node visuals {@id}",{id:n.componentMetadata?.id}),t.invalidateVisuals(),n._relationsNodeManager.registerNode(n.component),n.create.next(t)}}},function(){var t=this,n=arguments;return new Promise((function(o,a){var i=e.apply(t,n);function s(t){x(i,o,a,s,r,"next",t)}function r(t){x(i,o,a,s,r,"throw",t)}s(void 0)}))})()}ngOnDestroy(){this._componentRef&&(this._logger?.debug("RelationsNodeRendererSADirective: destroying node {@id}",{id:this.componentMetadata?.id}),this.component&&(this.destroy.next(this.component),this._relationsNodeManager.unregisterNode(this.component)),this._componentRef?.destroy(),this._componentRef=null)}}C.ɵfac=function(t){return new(t||C)(_.Y(f.s_),_.Y(b.J),_.Y(h.fI),_.Y(u.bZ,8))},C.ɵdir=v.lG({type:C,selectors:[["","relationsNodeRenderer",""]],inputs:{componentMetadata:["relationsNodeRenderer","componentMetadata"],zoomLevel:"zoomLevel"},outputs:{create:"create",destroy:"destroy"},exportAs:["relationsNodeRenderer"],standalone:!0,features:[y.T]});var M=n(43870),D=n(4477),w=n(6845),k=n(66794),T=n(73301),N=n(55436),O=n(72891),I=n(47083),P=n(85320),R=n(82568),L=n(80827),S=n(15686),F=n(12311);const Y=["relationsGroup"];function z(t,e){if(1&t&&(M.O4(),M.kc(),D.yn(0),D.Gk(1,4),D.BQ()),2&t){const t=e.$implicit,n=w.o();k.x(1),T.Q("relationsNodeRenderer",t)("zoomLevel",n._zoomLevel)}}class Q{constructor(t){this._relationManager=t,this._backgroundSize=16,this._lastMouseDownPosition={x:0,y:0},this._lastMouseUpPosition={x:0,y:0},this._canvasPosition={x:0,y:0},this._zoomLevel=1,this._isDragging=!1,this.nodeDefinitions=[]}get _backgroundSizeStyle(){return`${this._backgroundSize}px ${this._backgroundSize}px`}get _backgroundPositionStyle(){return`${this._canvasPosition.x%this._backgroundSize}px ${this._canvasPosition.y%this._backgroundSize}px`}createRelation(){return new l((0,i.Ys)(this._relationsGroup?.nativeElement),this._relationManager,null,null)}_onMouseDown(t){t.buttons==c.t.LEFT&&(this._lastMouseDownPosition={x:t.clientX,y:t.clientY},this._isDragging=!0)}_onMouseMove(t){this._isDragging&&(this._canvasPosition={x:this._lastMouseUpPosition.x+t.clientX-this._lastMouseDownPosition.x,y:this._lastMouseUpPosition.y+t.clientY-this._lastMouseDownPosition.y})}_onMouseUp(t){this._isDragging&&(this._isDragging=!1,this._lastMouseUpPosition={x:this._lastMouseUpPosition.x+t.clientX-this._lastMouseDownPosition.x,y:this._lastMouseUpPosition.y+t.clientY-this._lastMouseDownPosition.y})}_onWheel(t){if(t.deltaY){const e=(0,p.uZ)(this._zoomLevel+.05*(t.deltaY>1?-1:1),.2,2);this._canvasPosition={x:this._canvasPosition.x/this._zoomLevel*e,y:this._canvasPosition.y/this._zoomLevel*e},this._zoomLevel=e,this._lastMouseUpPosition={x:this._canvasPosition.x,y:this._canvasPosition.y},this._backgroundSize=16*this._zoomLevel}t.preventDefault(),t.stopImmediatePropagation()}}Q.ɵfac=function(t){return new(t||Q)(_.Y(b.J))},Q.ɵcmp=v.Xp({type:Q,selectors:[["relations-canvas"]],viewQuery:function(t,e){if(1&t&&N.Gf(Y,5,o.SB),2&t){let t;N.iG(t=N.CR())&&(e._relationsGroup=t.first)}},hostVars:4,hostBindings:function(t,e){1&t&&O.N("mousedown",(function(t){return e._onMouseDown(t)}))("mousemove",(function(t){return e._onMouseMove(t)}))("mouseup",(function(t){return e._onMouseUp(t)}),!1,I.Jf)("wheel",(function(t){return e._onWheel(t)})),2&t&&P.Ud("background-size",e._backgroundSizeStyle)("background-position",e._backgroundPositionStyle)},inputs:{nodeDefinitions:"nodeDefinitions"},standalone:!0,features:[R.j],decls:5,vars:3,consts:[[1,"flow-area"],[1,"relations-wrapper"],["relationsGroup",""],[4,"ngFor","ngForOf"],[3,"relationsNodeRenderer","zoomLevel"]],template:function(t,e){1&t&&(L.Tg(0,"div",0),M.O4(),L.Tg(1,"svg",1),L._U(2,"g",null,2),L.qZ(),S.Y(4,z,2,2,"ng-container",3),L.qZ()),2&t&&(P.Ud("transform","translate("+e._canvasPosition.x+"px, "+e._canvasPosition.y+"px) scale("+e._zoomLevel+")"),k.x(4),T.Q("ngForOf",e.nodeDefinitions))},dependencies:[a.e,F.s,C],styles:["[_nghost-%COMP%]\n{\n    background-color: #e5e5f7;\n    opacity: 0.6;\n    background-image: radial-gradient(#444cf7 0.8px, #e5e5f7 0.8px);\n    overflow: hidden;\n}\n\n.relations-wrapper[_ngcontent-%COMP%]\n{\n    width: 100%;\n    height: 100%;\n    overflow: visible;\n}"],changeDetection:0})},40362:(t,e,n)=>{n.d(e,{r:()=>o});const o="drop"},26220:(t,e,n)=>{var o;n.d(e,{t:()=>o}),function(t){t[t.LEFT=1]="LEFT"}(o||(o={}))},48397:(t,e,n)=>{n.d(e,{J:()=>a});var o=n(38327);class a{constructor(){this._nodes={},this._waitingInputRelations={}}setActiveInput(t){this._activeInput=t}getActiveInput(){return this._activeInput}registerNode(t){var e,n;if(this._nodes[t.id]=t,t.metadata?.outputs&&Array.isArray(t.metadata?.outputs))for(const o of t.metadata?.outputs){if(!o.inputs||!Array.isArray(o.inputs))continue;const a=t.outputs[o.outputName];if(a)for(const t of o.inputs){const o=this._nodes[t.id],i=a.startRelation();if(!o){(e=this._waitingInputRelations)[n=t.id]??(e[n]=[]),this._waitingInputRelations[t.id].push({inputName:t.inputName,relation:i});continue}const s=o.inputs[t.inputName];s&&s.endRelation(i)}}if(this._waitingInputRelations[t.id]){const e=this._waitingInputRelations[t.id],n=this._nodes[t.id];if(!n)return;for(const t of e){const e=n.inputs[t.inputName];e&&e.endRelation(t.relation)}}}unregisterNode(t){delete this._nodes[t.id]}getMetadata(){const t=[],e=Object.keys(this._nodes);for(const n of e){const e=this._nodes[n];if(!e.metadata)continue;const o={id:n,name:e.metadata.name,package:e.metadata.package,displayName:e.metadata.displayName,relationsOptions:e.metadata.relationsOptions,nodeMetadata:e.metadata.nodeMetadata,outputs:[]};if(e.allOutputs){for(const t of e.allOutputs){if(!t.relations)continue;if(!t.name)continue;const e={outputName:t.name,inputs:[]};for(const n of t.relations)n.input?.name&&e.inputs.push({id:n.input.parentId,inputName:n.input.name});o.outputs?.push(e)}t.push(o)}}return t}}a.ɵfac=function(t){return new(t||a)},a.ɵprov=o.Yz({token:a,factory:a.ɵfac})}}]);
//# sourceMappingURL=2584.chunk.f5103bab31fb52b68e49.js.map
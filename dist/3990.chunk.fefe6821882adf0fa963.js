"use strict";(self.webpackChunkng_universal_demo=self.webpackChunkng_universal_demo||[]).push([[3990],{23990:(t,n,e)=>{e.r(n),e.d(n,{StateRelationsEditorMetadata:()=>z});var o=e(94060),a=e(71309),i=e(80890),s=e(93551),c=e(52580),r=e(60901),d=e(85478),l=e(72385),u=e(63375),p=e(7199),m=e(28903),f=e(58654),h=e(97710),g=e(94353),v=e(78581),y=e(45473),b=e(71325),C=e(84746),x=e(55640),w=e(31246),M=e(23527),F=e(15554),O=e(86870),E=e(8530),k=e(5549),L=e(91513),T=e(83052),S=e(21179),D=e(41820),j=e(34984),I=e(60054);function q(t,n,e,o,a,i,s){try{var c=t[i](s),r=c.value}catch(t){return void e(t)}c.done?n(r):Promise.resolve(r).then(o,a)}function _(t){return function(){var n=this,e=arguments;return new Promise((function(o,a){var i=t.apply(n,e);function s(t){q(i,o,a,s,c,"next",t)}function c(t){q(i,o,a,s,c,"throw",t)}s(void 0)}))}}function N(t,n){if(1&t){const t=h.E();g.Tg(0,"div",4),g._U(1,"relation-node-input",13),g.Tg(2,"div",7)(3,"div"),v._(4),g.qZ(),g.Tg(5,"button",14),y.N("click",(function(n){const e=b.CH(t).$implicit,o=C.o();return n.preventDefault(),n.stopPropagation(),b.Kt(o.rename(e))})),g._U(6,"span",15),g.qZ(),g.Tg(7,"button",14),y.N("click",(function(n){const e=b.CH(t).$implicit,o=C.o();return n.preventDefault(),n.stopPropagation(),b.Kt(o.showCodeEditor(e))})),g._U(8,"span",16),g.qZ(),g.Tg(9,"button",17),y.N("click",(function(n){const e=b.CH(t).$implicit,o=C.o();return n.preventDefault(),n.stopPropagation(),b.Kt(o.removeInputFunc(e))})),g._U(10,"span",18),g.qZ()()()}if(2&t){const t=n.$implicit,e=C.o();x.x(1),w.Q("parentCoordiantes",e.nodePosition)("zoomLevel",e.zoomLevel)("name",t)("parent",e),x.x(3),M.Oq(t)}}f.Mj.typescript.typescriptDefaults.addExtraLib("/**\n * Function that is used for handling input value\n * @param data - Data that are passed to this function for processing\n */\nexport type InputFunction<TData = unknown, TState = unknown> = (this: StatefullClass<TState>, data: TData) => void;\n\n/**\n * Definition of statefull class\n */\nexport interface StatefullClass<TState = unknown>\n{\n    /**\n     * Current state that is stored for this class\n     */\n    state: TState|undefined|null;\n}","file:///node_modules/@types/state/index.d.ts");class U extends s.M{get inputFunctions(){var t;return this.metadata?((t=this.metadata).relationsOptions??(t.relationsOptions={inputFunctions:{}}),Object.keys(this.metadata.relationsOptions.inputFunctions??{})):[]}constructor(t,n,e){super(t,n),this.dialog=e}addInputFunc(){var t=this;return _((function*(){var n,e;const o={id:(0,p.Ox)(12),code:null},a={name:`inputFunc${t.inputFunctions.length+1}`,defaultValue:null,noDefaultValue:!0,skipInit:!1};if(yield t.configureEndpoint(a)){if(!t.metadata?.relationsOptions||!t.metadata.nodeMetadata)return;(n=t.metadata.relationsOptions).inputFunctions??(n.inputFunctions={}),t.metadata.relationsOptions.inputFunctions[a.name]=o,(e=t.metadata.nodeMetadata).options??(e.options={contents:{}}),t.metadata.nodeMetadata.options.contents&&(t.metadata.nodeMetadata.options.contents[a.name]=""),t.history.getNewState()}}))()}removeInputFunc(t){this.metadata?.relationsOptions?.inputFunctions&&t in this.metadata.relationsOptions.inputFunctions&&(delete this.metadata.relationsOptions.inputFunctions[t],this.metadata.nodeMetadata?.options?.contents&&delete this.metadata.nodeMetadata.options.contents[t],this.history.getNewState())}rename(t){var n=this;return _((function*(){yield n.configureEndpoint({name:t,defaultValue:null,noDefaultValue:!0,skipInit:!1}),n.changeDetector.detectChanges()}))()}configureEndpoint(t){var n=this;return _((function*(){const e=JSON.parse(JSON.stringify(t)),o=yield(0,m.n)(n.dialog.open(l.b,{title:"configure input function",width:"60vw",data:e}).afterClosed());return o&&(n.metadata?.relationsOptions?.inputFunctions?.[t.name]&&(""===n.metadata.nodeMetadata?.options?.contents?.[t.name]||n.metadata.nodeMetadata?.options?.contents?.[t.name])?(n.metadata.relationsOptions.inputFunctions[e.name]=n.metadata.relationsOptions.inputFunctions[t.name],delete n.metadata.relationsOptions.inputFunctions[t.name],n.metadata.nodeMetadata.options.contents[e.name]=n.metadata.nodeMetadata.options.contents[t.name],delete n.metadata.nodeMetadata.options.contents[t.name],n.history.getNewState()):t.name=e.name),o??!1}))()}showCodeEditor(t){var n=this;return _((function*(){var e,o,s;const c=yield(0,m.n)(n.dialog.open(a.I,{title:"Code editor",width:"75vw",height:"75vh",data:{content:n.metadata?.nodeMetadata?.options?.contents?.[t]??"",languageModel:(0,i.A)("import {InputFunction} from 'state';\n\n/**\n * Input function that handles incoming data and can change state\n */\nconst inputFunc: InputFunction<any, any> = function(_data)\n{\n};\n\nexport default inputFunc;\n\n")}}).afterClosed());n.metadata?.relationsOptions&&c&&n.metadata.nodeMetadata&&((e=n.metadata.relationsOptions).inputFunctions??(e.inputFunctions={}),(o=n.metadata.nodeMetadata).options??(o.options={contents:{}}),(s=n.metadata.nodeMetadata.options).contents??(s.contents={}),n.metadata.relationsOptions.inputFunctions[t].code=c.code,n.metadata.nodeMetadata.options.contents[t]=c.content,n.history.getNewState())}))()}}U.ɵfac=function(t){return new(t||U)(F.Y(O.s),F.Y(E.SB),F.Y(j.J))},U.ɵcmp=k.Xp({type:U,selectors:[["state-node"]],standalone:!0,features:[L.q,T.j],decls:20,vars:18,consts:[[3,"parent","destroySubject","name"],[1,"node-content"],[1,"inputs-outputs"],[1,"inputs"],[1,"input"],["name","initState",3,"parentCoordiantes","zoomLevel","parent"],["class","input",4,"ngFor","ngForOf"],[1,"dynamic-flex-row"],["type","button",1,"dynamic-btn-icon","dynamic-margin-left-extra-small",3,"click"],[1,"fas","fa-plus"],[1,"outputs"],[1,"output"],["name","state",3,"parentCoordiantes","zoomLevel","parent"],[3,"parentCoordiantes","zoomLevel","name","parent"],["type","button",1,"dynamic-btn-icon","dynamic-margin-horizontal-extra-small",3,"click"],[1,"fas","fa-pen"],[1,"fas","fa-code"],["type","button",1,"dynamic-btn-icon",3,"click"],[1,"fas","fa-times"]],template:function(t,n){1&t&&(g._U(0,"relations-node-header",0),S.AL(1,"firstUppercaseLocalize"),g.Tg(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",4),g._U(6,"relation-node-input",5),g.Tg(7,"div"),v._(8),S.AL(9,"firstUppercaseLocalize"),g.qZ()(),D.Y(10,N,11,5,"div",6),g.Tg(11,"div",7)(12,"button",8),y.N("click",(function(t){return t.preventDefault(),t.stopPropagation(),n.addInputFunc()})),g._U(13,"span",9),g.qZ()()(),g.Tg(14,"div",10)(15,"div",11)(16,"div"),v._(17),S.AL(18,"firstUppercaseLocalize"),g.qZ(),g._U(19,"relation-node-output",12),g.qZ()()()()),2&t&&(w.Q("parent",n)("destroySubject",n.destroySubject)("name",S.lc(1,12,"state")),x.x(6),w.Q("parentCoordiantes",n.nodePosition)("zoomLevel",n.zoomLevel)("parent",n),x.x(2),M.Oq(S.lc(9,14,"init state")),x.x(2),w.Q("ngForOf",n.inputFunctions),x.x(7),M.Oq(S.lc(18,16,"state")),x.x(2),w.Q("parentCoordiantes",n.nodePosition)("zoomLevel",n.zoomLevel)("parent",n))},dependencies:[c.e,r.P,d.n,o.e,I.sg,u.R],encapsulation:2,changeDetection:0});class z{constructor(){this.metaInfo={name:"State",description:"Node that allows storing and manipulation with statefull object",group:"Data"},this.nodeDefinition=U,Object.freeze(this)}}},72385:(t,n,e)=>{e.d(n,{b:()=>A});var o=e(94060),a=e(47260),i=e(34558),s=e(63375),c=e(16311),r=e(8945),d=e(71309),l=e(50073),u=e(26038),p=e(7199),m=e(28903);class f{constructor(t){this.defaultValue=null,this.name="",this.skipInit=!1,p.Rl.bind(this)(t)}}var h=e(94353),g=e(78581),v=e(21179),y=e(55640),b=e(23527),C=e(97710),x=e(45473),w=e(71325),M=e(84746),F=e(15554),O=e(5549),E=e(61980),k=e(83052),L=e(41820),T=e(31246),S=e(34984),D=e(68742),j=e(89086),I=e(95381),q=e(15528),_=e(42938),N=e(58328),U=e(88195);function z(t,n,e,o,a,i,s){try{var c=t[i](s),r=c.value}catch(t){return void e(t)}c.done?n(r):Promise.resolve(r).then(o,a)}function P(t,n){1&t&&(h.Tg(0,"div",1)(1,"label",2),h._U(2,"input",9),g._(3),v.AL(4,"firstUppercaseLocalize"),h.qZ()()),2&t&&(y.x(3),b.hi(" ",v.lc(4,1,"skip init")," "))}function Z(t,n){if(1&t){const t=C.E();h.Tg(0,"div",10)(1,"button",11),x.N("click",(function(){w.CH(t);const n=M.o();return w.Kt(n.showCodeEditor())})),h.Tg(2,"span"),g._(3),v.AL(4,"firstUppercaseLocalize"),h.qZ()()()}2&t&&(y.x(3),b.Oq(v.lc(4,1,"default value")))}class A{constructor(t,n,e){this.data=t,this.dialog=n,this.form=e.build(new f(t)),this.form.valueChanges.subscribe((n=>(0,p.l7)(t,n)))}showCodeEditor(){var t,n=this;return(t=function*(){const t=(0,p.EN)(n.data.defaultValue)?JSON.stringify(n.data.defaultValue,null,4):"",e=yield(0,m.n)(n.dialog.open(d.I,{title:"Code editor",width:"75vw",height:"75vh",data:{content:t,languageModel:l.H}}).afterClosed());(0,p.EN)(e)&&(n.data.defaultValue=(0,u.LK)(e.content))},function(){var n=this,e=arguments;return new Promise((function(o,a){var i=t.apply(n,e);function s(t){z(i,o,a,s,c,"next",t)}function c(t){z(i,o,a,s,c,"throw",t)}s(void 0)}))})()}}A.ɵfac=function(t){return new(t||A)(F.Y(c.m),F.Y(S.J),F.Y(r.p))},A.ɵcmp=O.Xp({type:A,selectors:[["configure-node-endpoint"]],standalone:!0,features:[E._([r.p]),k.j],decls:17,vars:14,consts:[[3,"formGroup"],[1,"dynamic-form-group","dynamic-margin-bottom-extra-small"],[1,"dynamic-control-label","dynamic-text-uppercase"],["type","text","formControlName","name",1,"dynamic-form-control"],["class","dynamic-form-group dynamic-margin-bottom-extra-small",4,"ngIf"],["class","dynamic-flex-column dynamic-margin-bottom-extra-small",4,"ngIf"],[1,"dynamic-flex-row","dynamic-flex-end","dynamic-action-buttons"],["type","button",1,"dynamic-btn","dynamic-btn-info","dynamic-margin-right-extra-small",3,"mat-dialog-close"],["type","button",1,"dynamic-btn","dynamic-btn-primary",3,"mat-dialog-close"],["type","checkbox","formControlName","skipInit"],[1,"dynamic-flex-column","dynamic-margin-bottom-extra-small"],["type","button",1,"dynamic-btn","dynamic-btn-primary","dynamic-align-self-center",3,"click"]],template:function(t,n){1&t&&(h.Tg(0,"div",0)(1,"div",1)(2,"label",2),g._(3),v.AL(4,"firstUppercaseLocalize"),h.qZ(),h._U(5,"input",3),h.qZ(),L.Y(6,P,5,3,"div",4)(7,Z,5,3,"div",5),h.qZ(),h.Tg(8,"div",6)(9,"button",7)(10,"span"),g._(11),v.AL(12,"firstUppercaseLocalize"),h.qZ()(),h.Tg(13,"button",8)(14,"span"),g._(15),v.AL(16,"firstUppercaseLocalize"),h.qZ()()()),2&t&&(T.Q("formGroup",n.form),y.x(3),b.Oq(v.lc(4,8,"name")),y.x(3),T.Q("ngIf",n.data.allowSkipInit),y.x(1),T.Q("ngIf",!n.data.noDefaultValue),y.x(2),T.Q("mat-dialog-close",null),y.x(2),b.Oq(v.lc(12,10,"cancel")),y.x(2),T.Q("mat-dialog-close",!0),y.x(2),b.Oq(v.lc(16,12,"ok")))},dependencies:[a.U,D.Fj,j.W,I.JJ,I.JL,q.s,_.u,i.I,N.ZT,o.e,U.O,s.R],encapsulation:2,changeDetection:0})},71309:(t,n,e)=>{e.d(n,{I:()=>T});var o=e(16311),a=e(15554),i=e(5549),s=e(97710),c=e(94353),r=e(45473),d=e(78581),l=e(21179),u=e(71325),p=e(38459),m=e(31246),f=e(55640),h=e(23527),g=e(69553),v=e(58328),y=e(79077),b=e(7199),C=e(58654);(0,b.yJ)((t=>{(0,b.fp)(t.ngDynamicMonacoPath)&&(t.ngDynamicMonacoPath="dist")})),self.MonacoEnvironment={getWorkerUrl:function(t,n){return"json"===n?"dist/json.worker.js":"css"===n||"scss"===n||"less"===n?"dist/css.worker.js":"html"===n||"handlebars"==n?"dist/html.worker.js":"typescript"===n||"javascript"===n?"dist/ts.worker.js":"dist/editor.worker.js"}};const x={target:C.Mj.typescript.ScriptTarget.ES2020,module:C.Mj.typescript.ModuleKind.CommonJS,moduleResolution:C.Mj.typescript.ModuleResolutionKind.NodeJs,allowNonTsExtensions:!0,removeComments:!0,noEmitOnError:!0,noImplicitAny:!0,noImplicitReturns:!0,noImplicitOverride:!0,noImplicitThis:!0,noUnusedLocals:!0,noUnusedParameters:!0,strict:!0,strictNullChecks:!0,esModuleInterop:!0,newLine:C.Mj.typescript.NewLineKind.LineFeed,typeRoots:["node_modules/@types"]};C.Mj.typescript.typescriptDefaults.setDiagnosticsOptions({noSemanticValidation:!1,noSyntaxValidation:!1}),C.Mj.typescript.typescriptDefaults.setCompilerOptions(x);var w=e(8530),M=e(28539);function F(t,n,e,o,a,i,s){try{var c=t[i](s),r=c.value}catch(t){return void e(t)}c.done?n(r):Promise.resolve(r).then(o,a)}function O(t){return function(){var n=this,e=arguments;return new Promise((function(o,a){var i=t.apply(n,e);function s(t){F(i,o,a,s,c,"next",t)}function c(t){F(i,o,a,s,c,"throw",t)}s(void 0)}))}}class E{constructor(t){this.element=t,this.codeEditor=null,this.openedFile=null,this.changeEvent=null,this.save=new y.v,this.contentChange=new y.v}ngOnChanges(t){(0,b.$0)("languageModel")in t&&this.languageModel&&(0,b.$0)("content")in t&&(0,b.EN)(this.content)&&this.updateContent()}ngAfterViewInit(){this.createEditor()}saveContent(){var t=this;return O((function*(){t.openedFile&&t.codeEditor&&t.languageModel&&t.save.emit({content:t.openedFile.getValue(),code:yield t.languageModel.compiledCode(t.codeEditor)})}))()}ngOnDestroy(){this.changeEvent?.dispose(),this.changeEvent=null,this.openedFile?.dispose(),this.openedFile=null,this.codeEditor?.dispose(),this.codeEditor=null}createEditor(){var t=this;this.codeEditor=C.j6.create(this.element.nativeElement,{theme:"vs-dark",model:this.openedFile,lightbulb:{enabled:!0},bracketPairColorization:{enabled:!0},minimap:{enabled:!0}}),this.codeEditor.addCommand(C.DC.CtrlCmd|C.VD.KeyS,(()=>{this.saveContent()})),this.changeEvent=this.codeEditor.onDidChangeModelContent(O((function*(){t.openedFile&&t.languageModel&&t.codeEditor&&t.contentChange.emit({content:t.openedFile.getValue(),code:yield t.languageModel.compiledCode(t.codeEditor)})})))}updateContent(){this.openedFile?.dispose(),this.openedFile=null,this.languageModel&&!(0,b.fp)(this.content)&&(this.openedFile=C.j6.createModel((this.content||this.languageModel.initialData)??"",this.languageModel.language,C.Sf.file(`file:///index.${this.languageModel.extension}`)),this.codeEditor?.setModel(this.openedFile))}}E.monacoInit=!0,E.ɵfac=function(t){return new(t||E)(a.Y(w.SB))},E.ɵcmp=i.Xp({type:E,selectors:[["code-editor"]],inputs:{content:"content",languageModel:"languageModel"},outputs:{save:"save",contentChange:"contentChange"},features:[M.T],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0});var k=e(63375);function L(t,n,e,o,a,i,s){try{var c=t[i](s),r=c.value}catch(t){return void e(t)}c.done?n(r):Promise.resolve(r).then(o,a)}class T{constructor(t,n){this.data=t,this.dialog=n,this.editorContent=null}saveAndClose(t){var n,e=this;return(n=function*(){yield t.saveContent(),e.dialog.close(e.editorContent)},function(){var t=this,e=arguments;return new Promise((function(o,a){var i=n.apply(t,e);function s(t){L(i,o,a,s,c,"next",t)}function c(t){L(i,o,a,s,c,"throw",t)}s(void 0)}))})()}}T.ɵfac=function(t){return new(t||T)(a.Y(o.m),a.Y(g.s))},T.ɵcmp=i.Xp({type:T,selectors:[["code-editor-dialog"]],decls:11,vars:9,consts:[[2,"height","calc(70vh - 46px)","width","calc(75vw - 20px)",3,"content","languageModel","save"],["editor",""],[1,"dynamic-flex-row","dynamic-flex-end","dynamic-action-buttons"],["type","button","type","button",1,"dynamic-btn","dynamic-btn-info","dynamic-margin-right-extra-small",3,"mat-dialog-close"],["type","button","type","button",1,"dynamic-btn","dynamic-btn-primary",3,"click"]],template:function(t,n){if(1&t){const t=s.E();c.Tg(0,"code-editor",0,1),r.N("save",(function(t){return n.editorContent=t})),c.qZ(),c.Tg(2,"div",2)(3,"button",3)(4,"span"),d._(5),l.AL(6,"firstUppercaseLocalize"),c.qZ()(),c.Tg(7,"button",4),r.N("click",(function(){u.CH(t);const e=p.M(1);return u.Kt(n.saveAndClose(e))})),c.Tg(8,"span"),d._(9),l.AL(10,"firstUppercaseLocalize"),c.qZ()()()}2&t&&(m.Q("content",n.data.content)("languageModel",n.data.languageModel),f.x(3),m.Q("mat-dialog-close",null),f.x(2),h.Oq(l.lc(6,5,"cancel")),f.x(4),h.Oq(l.lc(10,7,"ok")))},dependencies:[v.ZT,E,k.R],encapsulation:2,changeDetection:0})},50073:(t,n,e)=>{e.d(n,{H:()=>o});const o=new(e(53136).y)("json","json",(t=>t.getModel()?.getValue()??""))},53136:(t,n,e)=>{e.d(n,{y:()=>o});class o{constructor(t,n,e,o){this.language=t,this.extension=n,this.compiledCode=e,this.initialData=o}}},80890:(t,n,e)=>{e.d(n,{A:()=>s});var o=e(58654),a=e(53136);function i(t,n,e,o,a,i,s){try{var c=t[i](s),r=c.value}catch(t){return void e(t)}c.done?n(r):Promise.resolve(r).then(o,a)}const s=t=>new a.y("typescript","ts",function(){var t,n=(t=function*(t){const n=t.getModel()?.uri;if(!n)return"";const e=yield o.Mj.typescript.getTypeScriptWorker(),a=yield e(n);return(yield a.getEmitOutput(n.toString())).outputFiles[0].text},function(){var n=this,e=arguments;return new Promise((function(o,a){var s=t.apply(n,e);function c(t){i(s,o,a,c,r,"next",t)}function r(t){i(s,o,a,c,r,"throw",t)}c(void 0)}))});return function(t){return n.apply(this,arguments)}}(),t)}}]);
//# sourceMappingURL=3990.chunk.fefe6821882adf0fa963.js.map
{"version":3,"file":"8745.chunk.e85343a4e7865e4b4544.js","mappings":"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","sources":["webpack://ng-universal-demo/../relations-editor/src/misc/nodeRelationPath.ts","webpack://ng-universal-demo/../relations-editor/src/directives/relationsNodeRenderer/relationsNodeRenderer.types.ts","webpack://ng-universal-demo/../relations-editor/src/directives/relationsNodeRenderer/relationsNodeRenderer.options.ts","webpack://ng-universal-demo/../relations-editor/src/directives/relationsNodeRenderer/relationsNodeRenderer.directive.ts","webpack://ng-universal-demo/../relations-editor/src/components/relationsCanvas/relationsCanvas.component.html","webpack://ng-universal-demo/../relations-editor/src/components/relationsCanvas/relationsCanvas.component.ts","webpack://ng-universal-demo/../relations-editor/src/misc/constants.ts","webpack://ng-universal-demo/../relations-editor/src/misc/enums.ts","webpack://ng-universal-demo/../relations-editor/src/misc/extractors/relationsNode.extractor.ts","webpack://ng-universal-demo/../relations-editor/src/misc/extractors/componentRelationsNode.extractor.ts","webpack://ng-universal-demo/../relations-editor/src/services/staticComponentsRelationsNodesProvider/staticComponentsRelationsNodesProvider.service.ts","webpack://ng-universal-demo/../relations-editor/src/services/defaultDynamicModuleRelationsProvider/defaultDynamicModuleRelationsProvider.service.ts","webpack://ng-universal-demo/../relations-editor/src/services/staticComponentsRelationsTypesProvider/staticComponentsRelationsTypesProvider.service.ts","webpack://ng-universal-demo/../relations-editor/src/misc/providers.ts","webpack://ng-universal-demo/../relations-editor/src/misc/utils.ts","webpack://ng-universal-demo/../relations-editor/src/services/relationsNodeManager/relationsNodeManager.service.ts","webpack://ng-universal-demo/../relations-editor/src/services/staticComponentsRegister/staticComponentsRegister.service.ts","webpack://ng-universal-demo/../relations/src/misc/extractors/relations.extractor.ts","webpack://ng-universal-demo/../src/services/metadataHistoryManager/metadataHistoryManager.service.ts"],"sourcesContent":["import {MetadataHistoryManager} from '@anglr/dynamic';\nimport {Selection, BaseType, Line, line, curveBundle} from 'd3';\nimport {Observable, Subject} from 'rxjs';\n\nimport {Coordinates, RelationsInput, RelationsNodeMetadata, RelationsOutput} from '../interfaces';\nimport {RelationsNodeManager} from '../services';\nimport {INVALIDATE_DROP} from './constants';\n\nconst STROKE_WIDTH = '3px';\nconst HIGHLIGHT_STROKE_WIDTH = '5px';\n\n/**\n * Class that represents node relation path\n */\nexport class NodeRelationPath\n{\n    //######################### protected fields #########################\n\n    /**\n     * Subject used for emitting destroying event\n     */\n    protected _destroyingSubject: Subject<void> = new Subject<void>();\n\n    /**\n     * Object that represents rendered path\n     */\n    protected _path: Selection<SVGPathElement, {}, null, undefined>;\n\n    /**\n     * Line generator for generating lines\n     */\n    protected _lineGenerator: Line<[number, number]>;\n\n    //######################### public properties #########################\n\n    /**\n     * Output from which relation start\n     */\n    public output: RelationsOutput|undefined|null = null;\n\n    /**\n     * Input where relation ends\n     */\n    public input: RelationsInput|undefined|null = null;\n\n    /**\n     * Occurs when this relation is being destroyed\n     */\n    public get destroying(): Observable<void>\n    {\n        return this._destroyingSubject.asObservable();\n    }\n\n    //######################### constructor #########################\n\n    constructor(protected _parentGroup: Selection<BaseType, {}, null, undefined>,\n                protected _relationManager: RelationsNodeManager,\n                protected history: MetadataHistoryManager<RelationsNodeMetadata[]>,\n                public start: Coordinates|null,\n                public end: Coordinates|null)\n    {\n        this._path = this._parentGroup.append('path')\n            .attr('fill', 'transparent')\n            .attr('stroke', '#48B8B8')\n            .attr('stroke-width', STROKE_WIDTH)\n            .on('mouseover', () =>\n            {\n                this.highlight();\n            })                  \n            .on('mouseout', () =>\n            {\n                this.cancelHighlight();\n            });\n\n        this._lineGenerator = line()\n            .curve(curveBundle.beta(0.75));\n    }\n\n    //######################### public methods #########################\n\n    /**\n     * Method used for destroying this relation node\n     */\n    public destroy(): void\n    {\n        this._path?.remove();\n        this._destroyingSubject.next();\n    }\n\n    /**\n     * Highlights relation path and its input/output\n     */\n    public highlight(): void\n    {\n        this._path.attr('stroke-width', HIGHLIGHT_STROKE_WIDTH);\n        this.input?.highlight();\n        this.output?.highlight();\n    }\n\n    /**\n     * Cancel hight for relation path\n     */\n    public cancelHighlight(): void\n    {\n        this._path.attr('stroke-width', STROKE_WIDTH);\n        this.input?.cancelHighlight();\n        this.output?.cancelHighlight();\n    }\n\n    /**\n     * Explicitly runs invalidation of content (change detection)\n     * @param propertyName - Name of property that has changed\n     */\n    public invalidateVisuals(propertyName?: string): void\n    {\n        if(propertyName == INVALIDATE_DROP)\n        {\n            const activeInput = this._relationManager.getActiveInput();\n            this._relationManager.setActiveInput(null);\n\n            //drop not on input\n            if(!activeInput)\n            {\n                this.destroy();\n                this.start = null;\n                this.end = null;\n                this.input = null;\n                this.output = null;\n            }\n            //drop on input peer\n            else\n            {\n                if (activeInput.addRelation(this))\n                {\n                    this.end = activeInput.getCoordinates();\n                    this.input = activeInput;\n                    this.history.getNewState();\n                }\n                else\n                {\n                    this.destroy();\n                    this.start = null;\n                    this.end = null;\n                    this.input = null;\n                    this.output = null;\n                    this.history.getNewState();\n                }\n            }\n        }\n\n        if(!this.start || !this.end)\n        {\n            return;\n        }\n\n        let points: [number,number][];\n\n        //path from right to left\n        if(this.end.x <= this.start.x)\n        {\n            let width = this.start.x - this.end.x;\n            const half = (this.end.y - this.start.y) / 2;\n            \n            if(width < 12)\n            {\n                width = 12;\n            }\n\n            width *= 1.3;\n\n            points = \n            [\n                [this.start.x, this.start.y],\n                [this.start.x + width, this.start.y + half],\n                [this.end.x - width, this.start.y + half],\n                [this.end.x, this.end.y]\n            ];\n        }\n        //path from left to right\n        else\n        {\n            const width = this.end.x - this.start.x;\n            const third = width / 3;\n\n            points = \n            [\n                [this.start.x, this.start.y],\n                [this.start.x + third, this.start.y],\n                [this.end.x - third, this.end.y],\n                [this.end.x, this.end.y]\n            ];\n        }\n\n        this._path.attr('d', this._lineGenerator(points));\n    }\n}","/**\n * Defines behavior what should happen if rendered node type was not found\n */\nexport enum MissingNodeBehavior\n{\n    /**\n     * Shows special not found node as *placeholder*\n     */\n    ShowNotFound,\n\n    /**\n     * Ignores missing node, silently continues\n     */\n    Ignore,\n\n    /**\n     * Throws javascript error with missing node error\n     */\n    ThrowError\n}","import {isPresent} from '@jscrpt/common';\n\nimport {MissingNodeBehavior} from './relationsNodeRenderer.types';\n\n/**\n * Options for RelationsNodeRendererDirective\n */\nexport class RelationsNodeRendererDirectiveOptions\n{\n    //######################### public properties #########################\n\n    /**\n     * Describes what should happen if relations node type described in metadata was not found\n     */\n    public missingNodeBehavior: MissingNodeBehavior = MissingNodeBehavior.ShowNotFound;\n\n    //######################### constructor #########################\n    constructor(missingNodeBehavior?: MissingNodeBehavior)\n    {\n        if(isPresent(missingNodeBehavior))\n        {\n            this.missingNodeBehavior = missingNodeBehavior;\n        } \n    }\n}","import {ComponentRef, Directive, EventEmitter, Inject, Input, OnChanges, OnDestroy, Optional, Output, SimpleChanges, ViewContainerRef} from '@angular/core';\nimport {Logger, LOGGER} from '@anglr/common';\nimport {addSimpleChange, DynamicItemLoader} from '@anglr/dynamic';\nimport {isPresent, nameof} from '@jscrpt/common';\nimport {Subscription} from 'rxjs';\n\nimport {RelationsNode, RelationsNodeMetadata} from '../../interfaces';\nimport {RELATIONS_NODES_LOADER} from '../../misc/tokens';\nimport {RelationsNodeDef} from '../../misc/types';\nimport {RelationsNodeManager} from '../../services';\nimport {RelationsNodeRendererDirectiveOptions} from './relationsNodeRenderer.options';\nimport {MissingNodeBehavior} from './relationsNodeRenderer.types';\n\n/**\n * Renderer for dynamic relations node\n */\n@Directive(\n{\n    selector: '[relationsNodeRenderer]',\n    standalone: true,\n    exportAs: 'relationsNodeRenderer'\n})\nexport class RelationsNodeRendererSADirective<TComponent extends RelationsNode = any, TOptions = any, TEditorOptions = any> implements OnChanges, OnDestroy\n{\n    //######################### protected properties #########################\n\n    /**\n     * Destroy subscription\n     */\n    protected destroySubscription: Subscription|null = null;\n\n    /**\n     * Created component reference\n     */\n    protected componentRef: ComponentRef<TComponent>|null = null;\n\n    //######################### public properties - inputs #########################\n\n    /**\n     * Type that should be dynamically created into current container\n     */\n    @Input('relationsNodeRenderer')\n    public componentMetadata: RelationsNodeMetadata<TOptions, TEditorOptions>|undefined|null = null;\n\n    /**\n     * Editor zoom level\n     */\n    @Input()\n    public zoomLevel: number = 1;\n\n    //######################### public properties - outputs #########################\n\n    /**\n     * Occurs when rendered node is created\n     */\n    @Output()\n    public create: EventEmitter<TComponent> = new EventEmitter<TComponent>();\n\n    /**\n     * Occurs when rendered node is destroyed\n     */\n    @Output()\n    public destroy: EventEmitter<RelationsNodeMetadata<TOptions, TEditorOptions>> = new EventEmitter<RelationsNodeMetadata<TOptions, TEditorOptions>>();\n\n    //######################### protected properties #########################\n\n    /**\n     * Instance of dynamically created component\n     */\n    protected get component(): TComponent|null\n    {\n        if(!this.componentRef)\n        {\n            return null;\n        }\n\n        return this.componentRef.instance;\n    }\n\n    //######################### constructor #########################\n    constructor(protected viewContainerRef: ViewContainerRef,\n                protected relationsNodeManager: RelationsNodeManager,\n                @Inject(RELATIONS_NODES_LOADER) protected loader: DynamicItemLoader<RelationsNodeDef>,\n                @Optional() protected options?: RelationsNodeRendererDirectiveOptions,\n                @Inject(LOGGER) @Optional() protected logger?: Logger,)\n    {\n        if(!this.options || !(this.options instanceof RelationsNodeRendererDirectiveOptions))\n        {\n            this.options = new RelationsNodeRendererDirectiveOptions();\n        }\n    }\n\n    //######################### public methods - implementation of OnChanges #########################\n\n    /**\n     * Called when input value changes\n     */\n    public async ngOnChanges(changes: SimpleChanges): Promise<void>\n    {\n        //only zoom level changed\n        if(nameof<RelationsNodeRendererSADirective<TComponent, TOptions, TEditorOptions>>('zoomLevel') in changes && isPresent(this.zoomLevel) &&\n           !(nameof<RelationsNodeRendererSADirective<TComponent, TOptions, TEditorOptions>>('componentMetadata') in changes))\n        {\n            const component = this.component;\n\n            //component is created\n            if(component)\n            {\n                const zoomChanges = changes[nameof<RelationsNodeRendererSADirective<TComponent, TOptions, TEditorOptions>>('zoomLevel')];\n                component.zoomLevel = this.zoomLevel;\n\n                const chngs: SimpleChanges = {};\n                addSimpleChange<RelationsNode>(chngs, 'zoomLevel', zoomChanges, zoomChanges.previousValue);\n\n                component.ngOnChanges(chngs);\n                component.invalidateVisuals();\n            }\n\n            return;\n        }\n\n        this.logger?.debug('RelationsNodeRendererSADirective: rendering node {@id}', {id: this.componentMetadata?.id});\n\n        this.ngOnDestroy();\n        this.viewContainerRef.clear();\n\n        // component metadata is present\n        if(nameof<RelationsNodeRendererSADirective<TComponent, TOptions, TEditorOptions>>('componentMetadata') in changes && this.componentMetadata)\n        {\n            let layoutComponentType = await this.loader.loadItem(this.componentMetadata);\n\n            if(!layoutComponentType)\n            {\n                this.logger?.warn('RelationsNodeRendererSADirective: Unable to find relations node type {@type}', {name: this.componentMetadata.name, package: this.componentMetadata.package});\n\n                switch(this.options?.missingNodeBehavior)\n                {\n                    default:\n                    //case MissingNodeBehavior.ShowNotFound:\n                    {\n                        layoutComponentType = await this.loader.loadItem(\n                        {\n                            package: 'basic-components',\n                            name: 'notFound',\n                        });\n\n                        if(!layoutComponentType)\n                        {\n                            this.logger?.error('RelationsNodeRendererSADirective: Unable to find not found node!');\n\n                            return;\n                        }\n\n                        break;\n                    }\n                    case MissingNodeBehavior.Ignore:\n                    {\n                        //do nothing\n                        return;\n                    }\n                    case MissingNodeBehavior.ThrowError:\n                    {\n                        throw new Error(`RelationsNodeRendererSADirective: Unable to find relations node type Name: ${this.componentMetadata.name} Package: ${this.componentMetadata.package}`);\n                    }\n                }\n            }\n\n            this.componentRef = this.viewContainerRef.createComponent(layoutComponentType.data,\n                                                                      {\n                                                                          injector: this.viewContainerRef.injector,\n                                                                      }) as ComponentRef<TComponent>;\n\n            this.logger?.debug('RelationsNodeRendererSADirective: node rendered {@id}', {id: this.componentMetadata?.id});\n\n            if(this.component)\n            {\n                const node = this.component;\n\n                this.destroySubscription = node.destroy.subscribe(() => this.ngOnDestroy());\n\n                this.logger?.debug('RelationsNodeRendererSADirective: initializing node with metadata {@id}', {id: this.componentMetadata?.id});\n                node.metadata = this.componentMetadata;\n                node.zoomLevel = this.zoomLevel;\n\n                const chngs: SimpleChanges = {};\n\n                addSimpleChange<RelationsNode>(chngs, 'metadata', this.componentMetadata, null, true);\n                addSimpleChange<RelationsNode>(chngs, 'zoomLevel', this.zoomLevel, null, true);\n                \n                node.ngOnChanges(chngs);\n                await node.initialize();\n\n                this.logger?.debug('RelationsNodeRendererSADirective: invalidating node visuals {@id}', {id: this.componentMetadata?.id});\n                node.invalidateVisuals();\n                this.componentRef.changeDetectorRef.markForCheck();\n\n                this.relationsNodeManager.registerNode(this.component);\n                this.create.next(node);\n            }\n        }\n    }\n\n    //######################### public methods - implementation of OnDestroy #########################\n\n    /**\n     * Called when component is destroyed\n     */\n    public ngOnDestroy(): void\n    {\n        this.destroySubscription?.unsubscribe();\n        this.destroySubscription = null;\n\n        if(this.componentRef)\n        {\n            this.logger?.debug('RelationsNodeRendererSADirective: destroying node {@id}', {id: this.componentMetadata?.id});\n    \n            if(this.component)\n            {\n                if(this.componentMetadata)\n                {\n                    this.destroy.next(this.componentMetadata);\n                }\n                \n                this.relationsNodeManager.unregisterNode(this.component);\n            }\n\n            this.componentRef?.destroy();\n            this.componentRef = null;\n        }\n    }\n}","<div class=\"flow-area\" [style.transform]=\"'translate(' + canvasPosition.x + 'px, ' + canvasPosition.y + 'px) scale(' + zoomLevel + ')'\">\n    <svg class=\"relations-wrapper\">\n        <g #relationsGroup></g>\n    </svg>\n    \n    <ng-container *ngFor=\"let nodeDefinition of nodeDefinitions\">\n        <ng-container [relationsNodeRenderer]=\"nodeDefinition\" [zoomLevel]=\"zoomLevel\" (destroy)=\"destroyNode($event)\"></ng-container>\n    </ng-container>\n</div>","import {Component, ChangeDetectionStrategy, HostBinding, HostListener, ViewChild, ElementRef, Input, Inject, OnInit, ChangeDetectorRef, OnDestroy} from '@angular/core';\nimport {CommonModule} from '@angular/common';\nimport {MetadataHistoryManager} from '@anglr/dynamic';\nimport {select} from 'd3';\nimport {Subscription} from 'rxjs';\n\nimport {Coordinates, RelationsNodeMetadata} from '../../interfaces';\nimport {RelationsNodeManager} from '../../services';\nimport {NodeRelationPath} from '../../misc/nodeRelationPath';\nimport {MouseButton} from '../../misc/enums';\nimport {clamp} from '../../misc/utils';\nimport {RelationsNodeRendererSADirective} from '../../directives';\nimport {RELATIONS_HISTORY_MANAGER} from '../../misc/tokens';\n\n/**\n * Default background size in pixels\n */\nconst DEFAULT_BACKGROUND_SIZE = 16;\n\n/**\n * Minimum scale factor\n */\nconst SCALE_FACTOR_MIN = 0.2;\n\n/**\n * Maximum sclae factor\n */\nconst SCALE_FACTOR_MAX = 2;\n\n/**\n * Component used as designer component wrapper for layout component\n */\n@Component(\n{\n    selector: 'relations-canvas',\n    templateUrl: 'relationsCanvas.component.html',\n    styleUrls: ['relationsCanvas.component.css'],\n    standalone: true,\n    imports:\n    [\n        CommonModule,\n        RelationsNodeRendererSADirective,\n    ],\n    changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class RelationsCanvasSAComponent implements OnInit, OnDestroy\n{\n    //######################### protected properties #########################\n\n    /**\n     * Subscriptions created during initialization\n     */\n    protected _initSubscriptions: Subscription = new Subscription();\n\n    /**\n     * Background pattern size\n     */\n    protected backgroundSize: number = DEFAULT_BACKGROUND_SIZE;\n\n    /**\n     * Drag start position coordinates\n     */\n    protected dragStartPosition: Coordinates =\n    {\n        x: 0,\n        y: 0,\n    };\n\n    //######################### protected properties - host bindings #########################\n\n    /**\n     * Background size css styles\n     */\n    @HostBinding('style.backgroundSize')\n    protected get backgroundSizeStyle(): string\n    {\n        return `${this.backgroundSize}px ${this.backgroundSize}px`;\n    }\n\n    /**\n     * Background position css styles\n     */\n    @HostBinding('style.backgroundPosition')\n    protected get _backgroundPositionStyle(): string\n    {\n        return `${this.canvasPosition.x % this.backgroundSize}px ${this.canvasPosition.y % this.backgroundSize}px`;\n    }\n\n    //######################### protected properties - template bindings #########################\n\n    /**\n     * Canvas position\n     */\n    protected canvasPosition: Coordinates = {x: 0, y: 0};\n\n    /**\n     * Zoom level\n     */\n    protected zoomLevel = 1;\n\n    /**\n     * Indication whether canvas is being dragged\n     */\n    protected isDragging: boolean = false;\n\n    \n    //######################### protected properties - getters and setters #########################\n\n    /**\n     * Canvas bounding box\n     */\n    protected get boundingBox(): DOMRect\n    {\n        return this.element.nativeElement.getBoundingClientRect();\n    }\n\n    //######################### protected properties - children #########################\n\n    /**\n     * Node relations svg group\n     */\n    @ViewChild('relationsGroup', {read: ElementRef})\n    protected relationsGroup: ElementRef|null|undefined;\n\n    //######################### public properties - inputs #########################\n\n    /**\n     * Sample data to render\n     */\n    @Input()\n    public nodeDefinitions: RelationsNodeMetadata[] = [];\n\n    //######################### constructor #########################\n    constructor(protected element: ElementRef,\n                protected relationManager: RelationsNodeManager,\n                private _changeDetector: ChangeDetectorRef,\n                @Inject(RELATIONS_HISTORY_MANAGER) protected history: MetadataHistoryManager<RelationsNodeMetadata[]>,)\n    {\n    }\n\n    //######################### public methods - implementation of OnInit #########################\n    \n    /**\n     * Initialize component\n     */\n    public ngOnInit(): void\n    {\n        this._initSubscriptions.add(this.relationManager.activeNodeChange.subscribe(() => this.focusNode(this.relationManager.activeNode)));\n    }\n\n    //######################### public methods - implementation of OnDestroy #########################\n    \n    /**\n     * Called when component is destroyed\n     */\n    public ngOnDestroy(): void\n    {\n        this._initSubscriptions.unsubscribe();\n    }\n\n    //######################### public methods #########################\n\n    /**\n     * Focuses canvas to selected node\n     * @param id Relations node identifier\n     * @returns \n     */\n    public focusNode(id?: string|null): void\n    {\n        if (!id)\n        {\n            return;\n        }\n\n        const node = this.nodeDefinitions?.find(node => node.id === id);\n\n        if (node?.nodeMetadata?.coordinates)\n        {\n            // this._setZoomLevel(1);\n            this.canvasPosition = {\n                x: (-node?.nodeMetadata?.coordinates.x) * this.zoomLevel  + this.boundingBox.width/2,\n                y: (-node?.nodeMetadata?.coordinates.y) * this.zoomLevel  + this.boundingBox.height/2,\n            };\n            this._changeDetector.detectChanges();\n        }\n    }\n\n    /**\n     * Creates node relation path\n     */\n    public createRelation(): NodeRelationPath\n    {\n        return new NodeRelationPath(select(this.relationsGroup?.nativeElement), this.relationManager, this.history, null, null);\n    }\n\n    public getPositionInCanvas(point: {x: number, y: number}): Coordinates\n    {\n        return {\n            x: (point.x - this.boundingBox.left - this.canvasPosition.x)/this.zoomLevel,\n            y: (point.y - this.boundingBox.top - this.canvasPosition.y)/this.zoomLevel\n        };\n    }\n\n    //######################### protected methods - host listeners #########################\n\n    /**\n     * Mouse down event, handles moving of canvas\n     * @param event - Mouse event that occured\n     */\n    @HostListener('mousedown', ['$event'])\n    protected onMouseDown(event: MouseEvent): void\n    {\n        if (event.buttons == MouseButton.LEFT)\n        {\n            this.dragStartPosition =\n            {\n                x: event.clientX - this.canvasPosition.x,\n                y: event.clientY - this.canvasPosition.y\n            };\n            \n            this.isDragging = true;\n        }\n    }\n\n    /**\n     * Mouse move event, handles moving of canvas\n     * @param event - Mouse event that occured\n     */\n    @HostListener('mousemove', ['$event'])\n    protected onMouseMove(event: MouseEvent): void\n    {\n        if (this.isDragging)\n        {\n            this.canvasPosition =\n            {\n                x: event.clientX - this.dragStartPosition.x,\n                y: event.clientY - this.dragStartPosition.y\n            };\n        }\n    }\n\n    /**\n     * Mouse up event, handles moving of canvas\n     * @param event - Mouse event that occured\n     */\n    @HostListener('window:mouseup', ['$event'])\n    protected onMouseUp(_: MouseEvent): void\n    {\n        if (this.isDragging)\n        {\n            this.isDragging = false;\n        }\n    }\n\n    /**\n     * Wheel event, used for zooming\n     * @param event - Wheel event that occured\n     */\n    @HostListener('wheel', ['$event'])\n    protected onWheel(event: WheelEvent): void\n    {\n        if (event.deltaY)\n        {\n            const newZoomLevel = clamp(this.zoomLevel + (event.deltaY > 1 ? -1 : 1) * 0.05, SCALE_FACTOR_MIN, SCALE_FACTOR_MAX);    \n            \n            const posX = (event.clientX - this.canvasPosition.x - this.boundingBox.left) / this.zoomLevel;\n            const posY = (event.clientY - this.canvasPosition.y - this.boundingBox.top) / this.zoomLevel;\n\n            this.canvasPosition.x = event.clientX - this.boundingBox.left - posX*newZoomLevel;\n            this.canvasPosition.y = event.clientY - this.boundingBox.top - posY*newZoomLevel;\n\n            this._setZoomLevel(newZoomLevel);\n        }\n        \n        event.preventDefault();\n        event.stopImmediatePropagation();\n    }\n\n    //######################### protected methods - template bindings #########################\n\n    /**\n     * Destroys node\n     * @param node - Definition of node to be destroyed\n     */\n    protected destroyNode(node: RelationsNodeMetadata): void\n    {\n        const index = this.nodeDefinitions.indexOf(node);\n\n        if(index < 0)\n        {\n            return;\n        }\n\n        this.nodeDefinitions.splice(index, 1);\n\n        this.history.getNewState();\n    }\n\n    //######################### private methods #########################\n\n    /**\n     * Sets zoom level\n     * @param newZoomLevel new zoom level\n     */\n    private _setZoomLevel(newZoomLevel: number): void\n    {\n        this.zoomLevel = newZoomLevel;\n        this.backgroundSize = DEFAULT_BACKGROUND_SIZE * this.zoomLevel;\n    }\n}","/**\n * Constant represents name of invalidation for svg drop relation\n */\nexport const INVALIDATE_DROP: string = 'drop';\n","/**\n * Available mouse buttons enum\n */\nexport enum MouseButton\n{\n    /**\n     * Left mouse button\n     */\n    LEFT = 1,\n}","import {DynamicModuleDataExtractorFn} from '@anglr/dynamic';\nimport {relationsExportExtractor} from '@anglr/dynamic/relations';\n\nimport {RelationsEditorMetadataType} from '../../decorators';\nimport {RelationsNodeDef} from '../types';\n\n/**\n * Extracts dynamic relations node from default locations\n */\nexport const relationsNodeExtractor: DynamicModuleDataExtractorFn<RelationsNodeDef> = async (module, logger) =>\n{\n    const relations = await relationsExportExtractor(module, logger);\n\n    logger?.debug('relationsNodeExtractor: trying to extract dynamic node');\n\n    if(!relations)\n    {\n        return null;\n    }\n\n    const nodeMeta = relations.data as RelationsEditorMetadataType;\n\n    if(!nodeMeta)\n    {\n        return null;\n    }\n\n    const metadata = await nodeMeta.relationsEditorMetadata;\n    \n    if(!metadata)\n    {\n        return null;\n    }\n\n    return {\n        data: metadata.nodeDefinition,\n        metaInfo: metadata.metaInfo,\n    };\n};","import {Type} from '@angular/core';\nimport {DynamicModule, DynamicModuleDataExtractorFn} from '@anglr/dynamic';\n\nimport {RelationsNodeDef} from '../types';\nimport {RelationsEditorMetadataType} from '../../decorators';\n\n/**\n * Module with default export\n */\ninterface ɵDynamicModuleWithDefault<TData = any> extends DynamicModule\n{\n    /**\n     * Default export value\n     */\n    default?: TData;\n\n    /**\n     * Display name of layout component\n     */\n    displayName?: string;\n\n    /**\n     * Current scope of node that is being used\n     */\n    scope?: string;\n}\n\n/**\n * Extracts dynamic relations node from component relations node\n */\nexport const componentRelationsNodeExtractor: DynamicModuleDataExtractorFn<RelationsNodeDef> = async (module, logger) =>\n{\n    const localModule = module as ɵDynamicModuleWithDefault<Type<any>>;\n    \n    logger?.debug('componentRelationsNodeExtractor: trying to extract dynamic node');\n\n    if(!localModule)\n    {\n        return null;\n    }\n\n    const nodeMeta = localModule.default as RelationsEditorMetadataType;\n\n    if(!nodeMeta)\n    {\n        return null;\n    }\n\n    const metadata = await nodeMeta.relationsEditorMetadata;\n    \n    if(!metadata)\n    {\n        return null;\n    }\n\n    return {\n        data: metadata.nodeDefinition,\n        metaInfo: metadata.metaInfo,\n        singleton: true,\n        displayName: localModule.displayName,\n        scope: localModule.scope,\n    };\n};","import {Inject, Injectable, Optional} from '@angular/core';\nimport {Logger, LOGGER} from '@anglr/common';\nimport {DynamicItemSource, DynamicModule, DynamicModuleProvider} from '@anglr/dynamic';\n\nimport {StaticComponentsRegister} from '../staticComponentsRegister/staticComponentsRegister.service';\n\n/**\n * Dynamic relations nodes provider for static components\n */\n@Injectable()\nexport class StaticComponentsRelationsNodesProvider implements DynamicModuleProvider\n{\n    //######################### constructor #########################\n    constructor(protected _componentsRegister: StaticComponentsRegister,\n                @Inject(LOGGER) @Optional() protected _logger?: Logger,)\n    {\n    }\n\n    //######################### public methods - implementation of DynamicItemLoaderProvider #########################\n\n    /**\n     * @inheritdoc\n     */\n    public tryToGet(source: DynamicItemSource): DynamicModule|null\n    {\n        //only works with static components\n        if(source.package != 'static-components')\n        {\n            return null;\n        }\n\n        this._logger?.debug('StaticComponentsRelationsNodesProvider: trying to get node {@item}', {name: source.name, package: source.package});\n\n        const type = this._componentsRegister.getType(source.name);\n\n        if(!type)\n        {\n            return null;\n        }\n\n        return {\n            default: type\n        };\n    }\n}","import {Inject, Injectable, Optional} from '@angular/core';\nimport {Logger, LOGGER} from '@anglr/common';\nimport {DynamicItemSource, DynamicModule, DynamicModuleProvider} from '@anglr/dynamic';\n\n/**\n * Default dynamic module relations types provider, for built-in types\n */\n@Injectable()\nexport class DefaultDynamicModuleRelationsProvider implements DynamicModuleProvider\n{\n    //######################### constructor #########################\n    constructor(@Inject(LOGGER) @Optional() protected _logger?: Logger,)\n    {\n    }\n\n    //######################### public methods - implementation of DynamicItemLoaderProvider #########################\n\n    /**\n     * @inheritdoc\n     */\n    public async tryToGet(source: DynamicItemSource): Promise<DynamicModule|null>\n    {\n        try\n        {\n            this._logger?.debug('DefaultDynamicModuleRelationsProvider: trying to get relations types for module {@module}', {moduleName: source.package});\n\n            switch(source.package)\n            {\n                case 'basic-components':\n                    return await import('@anglr/dynamic/basic-components/relations');\n                case 'material-components':\n                    return await import('@anglr/dynamic/material-components/relations');\n                default:\n                    return null;\n            }\n        }\n        catch(e)\n        {\n            this._logger?.debug('DefaultDynamicModuleRelationsProvider: module {@module} was not found, reason: ' + e, {moduleName: source.package});\n        }\n\n        return null;\n    }\n}","import {Inject, Injectable, Optional} from '@angular/core';\nimport {Logger, LOGGER} from '@anglr/common';\nimport {DynamicItemSource, DynamicModule, DynamicModuleProvider} from '@anglr/dynamic';\n\nimport {StaticComponentsRegister} from '../staticComponentsRegister/staticComponentsRegister.service';\n\n/**\n * Dynamic relations types provider for static components\n */\n@Injectable()\nexport class StaticComponentsRelationsTypesProvider implements DynamicModuleProvider\n{\n    //######################### constructor #########################\n    constructor(protected _componentsRegister: StaticComponentsRegister,\n                @Inject(LOGGER) @Optional() protected _logger?: Logger,)\n    {\n    }\n\n    //######################### public methods - implementation of DynamicItemLoaderProvider #########################\n\n    /**\n     * @inheritdoc\n     */\n    public tryToGet(source: DynamicItemSource): DynamicModule|null\n    {\n        //only works with static components\n        if(source.package != 'static-components')\n        {\n            return null;\n        }\n\n        this._logger?.debug('StaticComponentsRelationsTypesProvider: trying to get relations types {@item}', {name: source.name, package: source.package});\n\n        const types = this._componentsRegister.types;\n\n        if(!types)\n        {\n            return null;\n        }\n\n        return {\n            default: types\n        };\n    }\n}","import {ClassProvider, ExistingProvider, FactoryProvider, inject, Optional} from '@angular/core';\nimport {DefaultDynamicModuleItemsProvider, defaultExportExtractor, DynamicItemLoader, DynamicModuleDataExtractor, MetadataHistoryManager, METADATA_STATE_MANAGER} from '@anglr/dynamic';\nimport {LOGGER, Logger} from '@anglr/common';\n\nimport {RELATIONS_HISTORY_MANAGER, RELATIONS_MODULE_TYPES_DATA_EXTRACTORS, RELATIONS_MODULE_TYPES_LOADER, RELATIONS_MODULE_TYPES_PROVIDERS, RELATIONS_NODES_DATA_EXTRACTORS, RELATIONS_NODES_LOADER, RELATIONS_NODES_PROVIDERS} from './tokens';\nimport {componentRelationsNodeExtractor, relationsNodeExtractor} from './extractors';\nimport {StaticComponentsRelationsNodesProvider, StaticComponentsRelationsTypesProvider, DefaultDynamicModuleRelationsProvider, RelationsNodeManager} from '../services';\nimport {isRelationsModuleTypes, isRelationsNodeDef} from './utils';\n\n/**\n * Provider for default package relations nodes provider\n */\nexport const DEFAULT_RELATIONS_NODES_PROVIDER: ClassProvider =\n{\n    provide: RELATIONS_NODES_PROVIDERS,\n    useClass: DefaultDynamicModuleItemsProvider,\n    multi: true\n};\n\n/**\n * Provider for static components relations nodes provider\n */\nexport const STATIC_COMPONENTS_RELATIONS_NODES_PROVIDER: ClassProvider =\n{\n    provide: RELATIONS_NODES_PROVIDERS,\n    useClass: StaticComponentsRelationsNodesProvider,\n    multi: true\n};\n\n/**\n * Provider for default dynamic relations types provider\n */\nexport const DYNAMIC_RELATIONS_MODULE_TYPES_PROVIDER: ClassProvider =\n{\n    provide: RELATIONS_MODULE_TYPES_PROVIDERS,\n    useClass: DefaultDynamicModuleRelationsProvider,\n    multi: true\n};\n\n/**\n * Provider for static components relations types provider\n */\nexport const STATIC_COMPONENTS_RELATIONS_MODULE_TYPES_PROVIDER: ClassProvider =\n{\n    provide: RELATIONS_MODULE_TYPES_PROVIDERS,\n    useClass: StaticComponentsRelationsTypesProvider,\n    multi: true\n};\n\n/**\n * Provider for default relations nodes extractor\n */\nexport const DEFAULT_RELATIONS_NODES_EXTRACTOR: FactoryProvider =\n{\n    provide: RELATIONS_NODES_DATA_EXTRACTORS,\n    useFactory: (logger?: Logger) =>\n    {\n        return new DynamicModuleDataExtractor([\n                                                  relationsNodeExtractor,\n                                              ],\n                                              logger);\n    },\n    deps: [[new Optional(), LOGGER]],\n    multi: true\n};\n\n/**\n * Provider for static and layout components relations nodes extractor\n */\nexport const COMPONENTS_RELATIONS_NODES_EXTRACTOR: FactoryProvider =\n{\n    provide: RELATIONS_NODES_DATA_EXTRACTORS,\n    useFactory: (logger?: Logger) =>\n    {\n        return new DynamicModuleDataExtractor([\n                                                  componentRelationsNodeExtractor,\n                                              ],\n                                              logger);\n    },\n    deps: [[new Optional(), LOGGER]],\n    multi: true\n};\n\n/**\n * Provider for default relations module types extractor\n */\nexport const DEFAULT_RELATIONS_MODULE_TYPES_EXTRACTOR: FactoryProvider =\n{\n    provide: RELATIONS_MODULE_TYPES_DATA_EXTRACTORS,\n    useFactory: (logger?: Logger) =>\n    {\n        return new DynamicModuleDataExtractor([\n                                                  defaultExportExtractor,\n                                              ],\n                                              logger);\n    },\n    deps: [[new Optional(), LOGGER]],\n    multi: true\n};\n\n/**\n * Provider for relations module types\n */\nexport const RELATIONS_MODULE_TYPES_LOADER_PROVIDER: FactoryProvider =\n{\n    provide: RELATIONS_MODULE_TYPES_LOADER,\n    useFactory: () => new DynamicItemLoader(inject(RELATIONS_MODULE_TYPES_PROVIDERS),\n                                            inject(RELATIONS_MODULE_TYPES_DATA_EXTRACTORS),\n                                            isRelationsModuleTypes,\n                                            inject(LOGGER, {optional: true}) ?? undefined,\n                                            true)\n};\n\n/**\n * Provider for relations node loader\n */\nexport const RELATIONS_NODES_LOADER_PROVIDER: FactoryProvider =\n{\n    provide: RELATIONS_NODES_LOADER,\n    useFactory: () => new DynamicItemLoader(inject(RELATIONS_NODES_PROVIDERS),\n                                            inject(RELATIONS_NODES_DATA_EXTRACTORS),\n                                            isRelationsNodeDef,\n                                            inject(LOGGER, {optional: true}) ?? undefined)\n};\n\n/**\n * Provider for relations history manager state\n */\nexport const RELATIONS_HISTORY_MANAGER_STATE: ExistingProvider =\n{\n    provide: METADATA_STATE_MANAGER,\n    useExisting: RelationsNodeManager,\n};\n\n/**\n * Provider for relations history manager\n */\nexport const RELATIONS_HISTORY_MANAGER_PROVIDER: ClassProvider =\n{\n    provide: RELATIONS_HISTORY_MANAGER,\n    useClass: MetadataHistoryManager\n};\n","import {ClassProvider, Provider, Type} from '@angular/core';\nimport {DefaultDynamicPackage, DynamicItemLoaderValidatorFn, provideStaticPackageSource} from '@anglr/dynamic';\nimport {isBlank, isBoolean, isJsObject, isPresent, isString, isType} from '@jscrpt/common';\n\nimport {DEFAULT_RELATIONS_NODES_PROVIDER, DEFAULT_RELATIONS_MODULE_TYPES_EXTRACTOR, DEFAULT_RELATIONS_NODES_EXTRACTOR, DYNAMIC_RELATIONS_MODULE_TYPES_PROVIDER, RELATIONS_MODULE_TYPES_LOADER_PROVIDER, RELATIONS_NODES_LOADER_PROVIDER, COMPONENTS_RELATIONS_NODES_EXTRACTOR, STATIC_COMPONENTS_RELATIONS_NODES_PROVIDER, STATIC_COMPONENTS_RELATIONS_MODULE_TYPES_PROVIDER, RELATIONS_HISTORY_MANAGER_STATE, RELATIONS_HISTORY_MANAGER_PROVIDER} from './providers';\nimport type {RelationsModuleTypes, RelationsNodeDef} from './types';\nimport {RelationsNodeManager, StaticComponentsRegister} from '../services';\n\n/**\n * Clamps number between two values\n * @param num - Number to clamp \n * @param min - Minimum value\n * @param max - Maximum value\n */\nexport function clamp(num: number, min: number, max: number): number\n{\n    return Math.min(Math.max(num, min), max);\n}\n\n/**\n * Checks whether data is relations module types\n * @param data - Data to be checked\n */\nexport const isRelationsModuleTypes: DynamicItemLoaderValidatorFn<RelationsModuleTypes> = function(data): data is RelationsModuleTypes\n{\n    if(isBlank(data?.data) || !Array.isArray(data.data))\n    {\n        return false;\n    }\n\n    return true;\n};\n\n/**\n * Checks whether data is relations node def\n * @param data - Data to be checked\n */\nexport const isRelationsNodeDef: DynamicItemLoaderValidatorFn<RelationsNodeDef> = function(data): data is RelationsNodeDef\n{\n    //type is required and must be type\n    if(isBlank(data?.data) || !isType(data.data))\n    {\n        return false;\n    }\n\n    //singleton should be boolean if used\n    if(isPresent(data.singleton) && !isBoolean(data.singleton))\n    {\n        return false;\n    }\n\n    //display name should be string if used\n    if(isPresent(data.displayName) && !isString(data.displayName))\n    {\n        return false;\n    }\n\n    //meta info should be object if used\n    if(isPresent(data?.metaInfo) && !isJsObject(data.metaInfo))\n    {\n        return false;\n    }\n\n    return true;\n};\n\n/**\n * Default providers for relations editor subpackage\n * @param packages - Array of default packages to be used, if omitted all built-in packages are used\n */\nexport function provideRelationsEditor(packages: DefaultDynamicPackage[] = ['basic-components', 'material-components']): Provider[]\n{\n    return [\n        DEFAULT_RELATIONS_NODES_PROVIDER,\n        DYNAMIC_RELATIONS_MODULE_TYPES_PROVIDER,\n        DEFAULT_RELATIONS_NODES_EXTRACTOR,\n        COMPONENTS_RELATIONS_NODES_EXTRACTOR,\n        DEFAULT_RELATIONS_MODULE_TYPES_EXTRACTOR,\n        RELATIONS_MODULE_TYPES_LOADER_PROVIDER,\n        RELATIONS_NODES_LOADER_PROVIDER,\n        RelationsNodeManager,\n        RELATIONS_HISTORY_MANAGER_STATE,\n        RELATIONS_HISTORY_MANAGER_PROVIDER,\n        ...packages.map(pkg => provideStaticPackageSource(pkg)),\n    ];\n}\n\n/**\n * Providers for relations editor subpackage, with support of static components\n * @param staticRegister - Type that represents implementation of static components register\n * @param packages - Array of default packages to be used, if omitted all built-in packages are used\n */\nexport function provideRelationsEditorWithStatic(staticRegister: Type<StaticComponentsRegister>, packages?: DefaultDynamicPackage[]): Provider[]\n{\n    return [\n        ...provideRelationsEditor(packages),\n        STATIC_COMPONENTS_RELATIONS_NODES_PROVIDER,\n        STATIC_COMPONENTS_RELATIONS_MODULE_TYPES_PROVIDER,\n        <ClassProvider>\n        {\n            provide: StaticComponentsRegister,\n            useClass: staticRegister\n        },\n        provideStaticPackageSource('static-components'),\n    ];\n}\n\n/**\n * Transforms any string to colour code\n * @param str - String to be changed to colour code\n */\nexport function stringToColour(str: string): string\n{\n    let hash = 0;\n\n    for (let i = 0; i < str.length; i++) \n    {\n        hash = str.charCodeAt(i) + ((hash << 5) - hash);\n    }\n    \n    let colour = '#';\n\n    for (let i = 0; i < 3; i++)\n    {\n        const value = (hash >> (i * 8)) & 0xFF;\n        colour += ('00' + value.toString(16)).substr(-2);\n    }\n\n    return colour;\n}","import {Injectable} from '@angular/core';\nimport {RelationOutputMetadata} from '@anglr/dynamic/relations';\nimport {MetadataStateManager} from '@anglr/dynamic';\nimport {Dictionary} from '@jscrpt/common';\nimport {Observable, Subject} from 'rxjs';\n\nimport {RelationsInput, RelationsNode, RelationsNodeMetadata} from '../../interfaces';\nimport {WaitingInputRelation} from './relationsNodeManager.interface';\n\n//TODO: logging\n\n/**\n * Class used for handling relations nodes metadata\n */\n@Injectable()\nexport class RelationsNodeManager implements MetadataStateManager<RelationsNodeMetadata[]>\n{\n    //######################### protected properties #########################\n\n    /**\n     * Active relation point input\n     */\n    protected _activeInput: RelationsInput|null|undefined;\n\n    /**\n     * Active relations node\n     */\n    protected _activeNode: string|null|undefined;\n\n    /**\n     * Registered relations nodes\n     */\n    protected _nodes: Dictionary<RelationsNode> = {};\n\n    /**\n     * Waiting input relations to be processed when node is created\n     */\n    protected _waitingInputRelations: Dictionary<WaitingInputRelation[]> = {};\n    \n    /**\n     * Used for emitting node registration\n     */\n    protected _nodesChange: Subject<void> = new Subject<void>();\n\n    /**\n     * Used for emitting active node change\n     */\n    protected _activeNodeChange: Subject<void> = new Subject<void>();\n\n    /**\n     * Used for emitting node registration change\n     */\n    protected _nodeRegisterChange: Subject<RelationsNode> = new Subject<RelationsNode>();\n\n    /**\n     * Used for emitting node unregistration change\n     */\n    protected _nodeUnregisterChange: Subject<RelationsNode> = new Subject<RelationsNode>();\n    \n    //######################### public properties #########################\n\n    /**\n     * Registered relation nodes\n     */\n    public get nodes(): Dictionary<RelationsNode>\n    {\n        return this._nodes;\n    }\n\n    /**\n     * Occurs when new node is registered\n     */\n    public get nodesChange(): Observable<void>\n    {\n        return this._nodesChange.asObservable();\n    }\n\n    /**\n     * Active relations node\n     */\n    public get activeNode(): string|null|undefined\n    {\n        return this._activeNode;\n    }\n\n    /**\n     * Occurs when active relations node is changed\n     */\n    public get activeNodeChange(): Observable<void>\n    {\n        return this._activeNodeChange.asObservable();\n    }\n\n    /**\n     * Occurs when registered node is changed\n     */\n    public get nodeRegisterChange(): Observable<RelationsNode>\n    {\n        return this._nodeRegisterChange.asObservable();\n    }\n\n    /**\n     * Occurs when unregistered node is changed\n     */\n    public get nodeUnregisterChange(): Observable<RelationsNode>\n    {\n        return this._nodeUnregisterChange.asObservable();\n    }\n\n    //######################### public methods #########################\n\n    /**\n     * Sets active relation input\n     * @param input - Component that represents input\n     */\n    public setActiveInput(input: RelationsInput|null|undefined): void\n    {\n        this._activeInput = input;\n    }\n\n    /**\n     * Gets active relation input\n     */\n    public getActiveInput(): RelationsInput|null|undefined\n    {\n        return this._activeInput;\n    }\n\n    /**\n     * Registers node into manager\n     * @param node - Node to be registered\n     */\n    public registerNode(node: RelationsNode): void\n    {\n        this._nodes[node.id] = node;\n        this._nodesChange.next();\n        this._nodeRegisterChange.next(node);\n\n        //iterate over all outputs\n        if(node.metadata?.outputs && Array.isArray(node.metadata?.outputs))\n        {\n            for(const output of node.metadata?.outputs)\n            {\n                //no inputs\n                if(!output.inputs || !Array.isArray(output.inputs))\n                {\n                    continue;\n                }\n\n                const outputNode = node.outputs[output.outputName];\n\n                //no output node\n                if(!outputNode)\n                {\n                    continue;\n                }\n\n                for(const input of output.inputs)\n                {\n                    const relationsNode = this._nodes[input.id];\n                    const relation = outputNode.startRelation();\n\n                    //input node does not exists yet\n                    if(!relationsNode)\n                    {\n                        this._waitingInputRelations[input.id] ??= [];\n                        this._waitingInputRelations[input.id].push(\n                        {\n                            inputName: input.inputName,\n                            relation: relation,\n                        });\n\n                        continue;\n                    }\n\n                    const inputNode = relationsNode.inputs[input.inputName];\n\n                    if(!inputNode)\n                    {\n                        continue;\n                    }\n\n                    inputNode.endRelation(relation);\n                }\n            }\n        }\n        \n        //finalize waiting inputs\n        if(this._waitingInputRelations[node.id])\n        {\n            const waitingInputRelations = this._waitingInputRelations[node.id];\n            const inputNode = this._nodes[node.id];\n\n            if(!inputNode)\n            {\n                return;\n            }\n\n            for(const waiting of waitingInputRelations)\n            {\n                const input = inputNode.inputs[waiting.inputName];\n\n                if(!input)\n                {\n                    continue;\n                }\n\n                input.endRelation(waiting.relation);\n                delete this._waitingInputRelations[node.id];\n            }\n        }\n    }\n\n    /**\n     * Unregisters node from manager\n     * @param node - Node to be unregistered\n     */\n    public unregisterNode(node: RelationsNode): void\n    {\n        delete this._nodes[node.id];\n        this._nodesChange.next();\n        this._nodeUnregisterChange.next(node);\n    }\n\n    /**\n     * Gets current metadata\n     */\n    public getMetadata(): RelationsNodeMetadata[]\n    {\n        const result: RelationsNodeMetadata[] = [];\n        const nodeIds = Object.keys(this._nodes);\n        \n        for(const id of nodeIds)\n        {\n            const node = this._nodes[id];\n\n            if(!node.metadata)\n            {\n                continue;\n            }\n\n            const nodeMeta: RelationsNodeMetadata =\n            {\n                id,\n                name: node.metadata.name,\n                package: node.metadata.package,\n                displayName: node.metadata.displayName,\n                relationsOptions: node.metadata.relationsOptions,\n                nodeMetadata: node.metadata.nodeMetadata,\n                scope: node.metadata.scope,\n                outputs: []\n            };\n\n\n            if(!node.allOutputs)\n            {\n                continue;\n            }\n\n            for(const output of node.allOutputs)\n            {\n                if(!output.relations)\n                {\n                    continue;\n                }\n\n                if(!output.name)\n                {\n                    continue;\n                }\n\n                const outputMeta: RelationOutputMetadata =\n                {\n                    outputName: output.name,\n                    inputs: []\n                };\n\n                for(const relation of output.relations)\n                {\n                    if(!relation.input?.name)\n                    {\n                        continue;\n                    }\n\n                    outputMeta.inputs.push(\n                    {\n                        id: relation.input.parentId,\n                        inputName: relation.input.name\n                    });\n                }\n\n                nodeMeta.outputs?.push(outputMeta);\n            }\n\n            result.push(nodeMeta);\n        }\n\n        return result;\n    }\n\n    /**\n     * Sets active relations node\n     * @param id node identifier\n     */\n    public setActiveNode(id?: string|null): void\n    {\n        this._activeNode = id;\n        this._activeNodeChange.next();\n    }\n}","import {Injectable, Type} from '@angular/core';\nimport {Dictionary} from '@jscrpt/common';\n\n/**\n * Register for statically typed components that are part of relations\n */\n@Injectable()\nexport abstract class StaticComponentsRegister\n{\n    //######################### protected fields #########################\n\n    /**\n     * Object storing defined types\n     */\n    protected _definedTypes: Dictionary<Type<any>> = this.getDefinedTypes();\n\n    //######################### public properties #########################\n\n    /**\n     * Gets available types that are used as static components\n     */\n    public get types(): string[]\n    {\n        return Object.keys(this._definedTypes);\n    }\n\n    //######################### public methods #########################\n\n    /**\n     * Gets type by its name\n     * @param name - Name of type that should be obtained\n     */\n    public getType(name: string): Type<any>|null\n    {\n        return this._definedTypes[name] ?? null;\n    }\n\n    //######################### protected methods #########################\n\n    /**\n     * Gets defined static components types containing metadata\n     */\n    protected abstract getDefinedTypes(): Dictionary<Type<any>>;\n}","import {Type} from '@angular/core';\nimport {DynamicItemDefData, DynamicModule, DynamicModuleDataExtractorFn} from '@anglr/dynamic';\nimport {isPresent, isType} from '@jscrpt/common';\n\nimport {RelationsComponent} from '../../interfaces';\nimport {isRelationsComponentType} from '../../decorators';\n\n/**\n * Module with relations exports\n */\ninterface ɵDynamicModuleWithRelations extends DynamicModule\n{\n    /**\n     * Default export value\n     */\n    default?: Type<RelationsComponent>;\n\n    /**\n     * Relations named export value\n     */\n    relations?: Type<RelationsComponent>;\n}\n\n/**\n * Extracts dynamic relations from default locations\n * \n * - relations export\n * - default export\n */\nexport const relationsExportExtractor: DynamicModuleDataExtractorFn<DynamicItemDefData<Type<RelationsComponent>>> = (module, logger) =>\n{\n    const localModule = module as ɵDynamicModuleWithRelations;\n\n    logger?.debug('relationsExportExtractor: trying to extract dynamic relations');\n\n    if(isPresent(localModule.relations) && isType(localModule.relations) && isRelationsComponentType(localModule.relations))\n    {\n        return {\n            data: localModule.relations\n        };\n    }\n\n    if(isPresent(localModule.default) && isType(localModule.default) && isRelationsComponentType(localModule.default))\n    {\n        return {\n            data: localModule.default\n        };\n    }\n\n    return null;\n};","import {Inject, Injectable} from '@angular/core';\nimport {isBlank, isPresent} from '@jscrpt/common';\nimport {Observable, Subject} from 'rxjs';\n\nimport {MetadataStateManager} from '../../interfaces';\nimport {METADATA_STATE_MANAGER} from '../../misc/tokens';\n\n/**\n * Maximum number of items in history\n */\nconst MAX_ITEMS = 200;\n\n//TODO: maybe store state as string and compare with it to correctly display saved, discuss with vinci\n\n/**\n * Service used for managing state of metadata\n */\n@Injectable()\nexport class MetadataHistoryManager<TMetadata = any>\n{\n    //######################### protected properties #########################\n\n    /**\n     * Current index which is active currently\n     */\n    protected activeIndex: number|null = null;\n\n    /**\n     * Index of state which is saved\n     */\n    protected saveIndex: number|null = null;\n\n    /**\n     * All stored states\n     */\n    protected states: string[] = [];\n\n    /**\n     * Indication whether is manager enabled\n     */\n    protected enabled: boolean = true;\n\n    /**\n     * Used for emitting pop event\n     */\n    protected popSubject: Subject<TMetadata> = new Subject<TMetadata>();\n\n    /**\n     * Used for emitting history change event\n     */\n    protected historyChangeSubject: Subject<void> = new Subject<void>();\n\n    //######################### public properties #########################\n\n    /**\n     * Information whether user can undo\n     */\n    public get canUndo(): boolean\n    {\n        if(isBlank(this.activeIndex))\n        {\n            return false;\n        }\n\n        return this.activeIndex > 0;\n    }\n\n    /**\n     * Information whether user can redo\n     */\n    public get canRedo(): boolean\n    {\n        if(isBlank(this.activeIndex))\n        {\n            return false;\n        }\n\n        return this.activeIndex + 1 < this.states.length;\n    }\n\n    /**\n     * Indication whether current state is saved state\n     */\n    public get saved(): boolean\n    {\n        return this.activeIndex === this.saveIndex;\n    }\n\n    /**\n     * Occurs when user pops new state, using undo, or redo\n     */\n    public get pop(): Observable<TMetadata>\n    {\n        return this.popSubject.asObservable();\n    }\n\n    /**\n     * Occurs when new state appears in history\n     */\n    public get historyChange(): Observable<void>\n    {\n        return this.historyChangeSubject.asObservable();\n    }\n\n    /**\n     * Current state of metadata\n     */\n    public get state(): TMetadata|null\n    {\n        if(isBlank(this.activeIndex))\n        {\n            return null;\n        }\n\n        return JSON.parse(this.states[this.activeIndex]);\n    }\n\n    //######################### constructor #########################\n    constructor(@Inject(METADATA_STATE_MANAGER) protected metadataState: MetadataStateManager<TMetadata>,)\n    {\n    }\n\n    //######################### public methods #########################\n    \n    /**\n     * Undo last change in metadata\n     */\n    public undo(): void\n    {\n        if(!this.canUndo || isBlank(this.activeIndex))\n        {\n            return;\n        }\n\n        this.activeIndex--;\n        this.popSubject.next(JSON.parse(this.states[this.activeIndex]));\n    }\n\n    /**\n     * Redo last change in metadata\n     */\n    public redo(): void\n    {\n        if(!this.canRedo || isBlank(this.activeIndex))\n        {\n            return;\n        }\n\n        this.activeIndex++;\n        this.popSubject.next(JSON.parse(this.states[this.activeIndex]));\n    }\n\n    /**\n     * Indicates that new change in state has been done and should be retrieved\n     */\n    public getNewState(): void\n    {\n        if(!this.enabled)\n        {\n            return;\n        }\n\n        //max number of states reached\n        if(this.states.length >= MAX_ITEMS)\n        {\n            this.states.shift();\n        }\n\n        //getting new state, where current index is not at the end, rewriting history for redo\n        if(isPresent(this.activeIndex) && this.activeIndex + 1 < this.states.length)\n        {\n            this.states.splice(this.activeIndex + 1, this.states.length - (this.activeIndex + 1));\n        }\n\n        const state = this.metadataState.getMetadata();\n\n        //only for existing state\n        if(state)\n        {\n            this.states.push(JSON.stringify(state));\n            this.activeIndex = this.states.length - 1;\n            this.historyChangeSubject.next();\n        }\n    }\n\n    /**\n     * Sets current state as saved state\n     */\n    public save(): void\n    {\n        this.saveIndex = this.activeIndex;\n    }\n\n    public setInitialState(metadata: TMetadata): void\n    {\n        this.states.push(JSON.stringify(metadata));\n        this.activeIndex = this.states.length - 1;\n        this.save();\n    }\n\n    /**\n     * Cleans history of metadata states\n     */\n    public clean(): void\n    {\n        this.activeIndex = null;\n        this.saveIndex = null;\n        this.states = [];\n    }\n\n    /**\n     * Enable metadata history manager, changes in metadata are stored\n     */\n    public enable(): void\n    {\n        this.enabled = true;\n    }\n\n    /**\n     * Disables metadata history manager, changes in metadata history are not stored\n     */\n    public disable(): void\n    {\n        this.enabled = false;\n    }\n}"],"names":["NodeRelationPath","constructor","_parentGroup","_relationManager","history","start","end","_destroyingSubject","Subject","output","input","this","_path","append","attr","on","highlight","cancelHighlight","_lineGenerator","line","curve","curveBundle","destroying","asObservable","destroy","remove","next","invalidateVisuals","propertyName","INVALIDATE_DROP","activeInput","getActiveInput","setActiveInput","addRelation","getCoordinates","getNewState","points","x","width","half","y","third","MissingNodeBehavior","RelationsNodeRendererDirectiveOptions","missingNodeBehavior","ShowNotFound","isPresent","RelationsNodeRendererSADirective","viewContainerRef","relationsNodeManager","loader","options","logger","destroySubscription","componentRef","componentMetadata","zoomLevel","create","EventEmitter","component","instance","ngOnChanges","changes","nameof","zoomChanges","chngs","addSimpleChange","previousValue","debug","id","ngOnDestroy","clear","layoutComponentType","loadItem","warn","name","package","error","Ignore","ThrowError","Error","createComponent","data","injector","node","subscribe","metadata","initialize","changeDetectorRef","markForCheck","registerNode","unsubscribe","unregisterNode","i0","RELATIONS_NODES_LOADER","LOGGER","selectors","inputs","outputs","exportAs","standalone","features","ctx_r1","RelationsCanvasSAComponent","element","relationManager","_changeDetector","_initSubscriptions","Subscription","backgroundSize","dragStartPosition","canvasPosition","isDragging","nodeDefinitions","backgroundSizeStyle","_backgroundPositionStyle","boundingBox","nativeElement","getBoundingClientRect","ngOnInit","add","activeNodeChange","focusNode","activeNode","find","nodeMetadata","coordinates","height","detectChanges","createRelation","select","relationsGroup","getPositionInCanvas","point","left","top","onMouseDown","event","buttons","MouseButton","clientX","clientY","onMouseMove","onMouseUp","_","onWheel","deltaY","newZoomLevel","clamp","posX","posY","_setZoomLevel","preventDefault","stopImmediatePropagation","destroyNode","index","indexOf","splice","RELATIONS_HISTORY_MANAGER","viewQuery","ElementRef","ctx","CommonModule","i2","styles","changeDetection","relationsNodeExtractor","module","relations","relationsExportExtractor","nodeMeta","relationsEditorMetadata","nodeDefinition","metaInfo","componentRelationsNodeExtractor","localModule","default","singleton","displayName","scope","StaticComponentsRelationsNodesProvider","_componentsRegister","_logger","tryToGet","source","type","getType","factory","DefaultDynamicModuleRelationsProvider","moduleName","e","StaticComponentsRelationsTypesProvider","types","DEFAULT_RELATIONS_NODES_PROVIDER","provide","RELATIONS_NODES_PROVIDERS","useClass","DefaultDynamicModuleItemsProvider","multi","STATIC_COMPONENTS_RELATIONS_NODES_PROVIDER","DYNAMIC_RELATIONS_MODULE_TYPES_PROVIDER","RELATIONS_MODULE_TYPES_PROVIDERS","STATIC_COMPONENTS_RELATIONS_MODULE_TYPES_PROVIDER","DEFAULT_RELATIONS_NODES_EXTRACTOR","RELATIONS_NODES_DATA_EXTRACTORS","useFactory","DynamicModuleDataExtractor","deps","Optional","COMPONENTS_RELATIONS_NODES_EXTRACTOR","DEFAULT_RELATIONS_MODULE_TYPES_EXTRACTOR","RELATIONS_MODULE_TYPES_DATA_EXTRACTORS","defaultExportExtractor","RELATIONS_MODULE_TYPES_LOADER_PROVIDER","RELATIONS_MODULE_TYPES_LOADER","DynamicItemLoader","inject","isRelationsModuleTypes","optional","undefined","RELATIONS_NODES_LOADER_PROVIDER","isRelationsNodeDef","RELATIONS_HISTORY_MANAGER_STATE","METADATA_STATE_MANAGER","useExisting","RelationsNodeManager","RELATIONS_HISTORY_MANAGER_PROVIDER","MetadataHistoryManager","num","min","max","Math","isBlank","Array","isArray","isType","isBoolean","isString","isJsObject","provideRelationsEditor","packages","map","pkg","provideStaticPackageSource","provideRelationsEditorWithStatic","staticRegister","StaticComponentsRegister","stringToColour","str","hash","i","length","charCodeAt","colour","toString","substr","_nodes","_waitingInputRelations","_nodesChange","_activeNodeChange","_nodeRegisterChange","_nodeUnregisterChange","nodes","nodesChange","_activeNode","nodeRegisterChange","nodeUnregisterChange","_activeInput","outputNode","outputName","relationsNode","relation","startRelation","_b","_a","push","inputName","inputNode","endRelation","waitingInputRelations","waiting","getMetadata","result","nodeIds","Object","keys","relationsOptions","allOutputs","outputMeta","parentId","setActiveNode","_definedTypes","getDefinedTypes","isRelationsComponentType","metadataState","activeIndex","saveIndex","states","enabled","popSubject","historyChangeSubject","canUndo","canRedo","saved","pop","historyChange","state","JSON","parse","undo","redo","shift","stringify","save","setInitialState","clean","enable","disable"],"sourceRoot":""}
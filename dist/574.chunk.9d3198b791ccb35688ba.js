"use strict";(self.webpackChunkng_universal_demo=self.webpackChunkng_universal_demo||[]).push([[574],{60574:(t,e,a)=>{a.r(e),a.d(e,{RelationsLayoutFormModule:()=>St});var r=a(14392),o=a(27052),n=a(48659),i=a(76668),s=a(97212),l=a(89001),u=a(22804),c=a(38707),d=a(35648),p=a(8477),m=a(66888),f=a(94761),g=a(71785),v=a(97149),h=a(56454),_=a(17505),y=a(44055),w=a(56179),b=a(99043),C=a(57489),x=a(30688),M=a(57466),F=a(27049),O=a(89952),R=a(77653),N=a(79440),k=a(77842),T=a(73379),Y=a(80827),L=a(41853),Q=a(72891),j=a(66794),D=a(73301),I=a(84967),U=a(80239),G=a(23061),P=a(80285),q=a(86825);let A=class{constructor(t,e){this._store=t,this.history=e,this._metadata=null}get emptyMetadata(){return{id:`stackPanel-${(0,M.Ox)(10)}`,displayName:"root",package:"basic-components",name:"stackPanel",options:{children:[]}}}_getMetadata(t){return{layout:t}}};A.ɵfac=function(t){return new(t||A)(N.Y(O.U),N.Y(g.dB))},A.ɵcmp=k.Xp({type:A,selectors:[["form-layout-editor-view"]],features:[T._([h.z,{provide:p.qO,useFactory:t=>new u.I((e=>t.getData(e)?.layout)),deps:[O.U]},(0,v._)(),(0,x.iS)(),(0,w.vQ)(),(0,b.gJ)(),(0,C.hd)(),{provide:_.L,useClass:R.y}])],decls:9,vars:5,consts:[[1,"flex-row"],["type","button","goBack","",1,"btn","btn-primary","margin-right-extra-small"],["routePath","/relationsLayoutForm/layout",3,"store","getMetadataCallback","history","metadataChange"],[3,"copyClick"],[1,"margin-horizontal-small"],[1,"flex-1",3,"metadata"]],template:function(t,e){1&t&&(Y.Tg(0,"div",0)(1,"button",1)(2,"span"),L._(3,"go back"),Y.qZ()(),Y.Tg(4,"load-save-new",2),Q.N("metadataChange",(function(t){let a;return e._metadata=null!==(a=null==t?null:t.layout)&&void 0!==a?a:e.emptyMetadata})),Y.qZ(),Y.Tg(5,"debug-data",3)(6,"div",4),L._(7,"metadata"),Y.qZ()()(),Y._U(8,"layout-editor",5)),2&t&&(j.x(4),D.Q("store",e._store)("getMetadataCallback",e._getMetadata)("history",e.history),j.x(1),D.Q("copyClick",e._metadata),j.x(3),D.Q("metadata",e._metadata))},dependencies:[I.v,G.Z,P.v,U.o,q.Q],encapsulation:2,changeDetection:0}),(0,r.gn)([F.r,(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",[Object]),(0,r.w6)("design:returntype",Object)],A.prototype,"_getMetadata",null),A=(0,r.gn)([(0,f.N)({path:"layout"}),(0,f.N)({path:"layout/:id"}),(0,r.w6)("design:paramtypes",[O.U,y.Y])],A);var Z=a(95176),S=a(68961),z=a(23710),V=a(15467),E=a(70625),B=a(43939),J=a(79898),$=a(17777),H=a(66398),K=a(38937),X=a(11776),W=a(38327),tt=a(26938);function et(t,e,a,r,o,n,i){try{var s=t[n](i),l=s.value}catch(t){return void a(t)}s.done?e(l):Promise.resolve(l).then(r,o)}function at(t){function e(t){if(Object(t)!==t)return Promise.reject(new TypeError(t+" is not an object."));var e=t.done;return Promise.resolve(t.value).then((function(t){return{value:t,done:e}}))}return at=function(t){this.s=t,this.n=t.next},at.prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(t){var a=this.s.return;return void 0===a?Promise.resolve({value:t,done:!0}):e(a.apply(this.s,arguments))},throw:function(t){var a=this.s.return;return void 0===a?Promise.reject(t):e(a.apply(this.s,arguments))}},new at(t)}class rt{constructor(t){this._iteratorsSvc=t}build(t){var e,a=this;return(e=function*(){const e=new $.cw({});let r=e;var o,n=!1,i=!1;try{for(var s,l=function(t){var e,a,r,o=2;for("undefined"!=typeof Symbol&&(a=Symbol.asyncIterator,r=Symbol.iterator);o--;){if(a&&null!=(e=t[a]))return e.call(t);if(r&&null!=(e=t[r]))return new at(e.call(t));a="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}(a._iteratorsSvc.getIteratorFor(t));n=!(s=yield l.next()).done;n=!1){const t=s.value,e=a._getControlName(t.metadata);if(e){const o=a._getControlForMetadata(t.metadata);a._getActiveGroup(t.parent,r).addControl(e,o),o instanceof $.cw&&(r=o)}}}catch(t){i=!0,o=t}finally{try{n&&null!=l.return&&(yield l.return())}finally{if(i)throw o}}return e},function(){var t=this,a=arguments;return new Promise((function(r,o){var n=e.apply(t,a);function i(t){et(n,r,o,i,s,"next",t)}function s(t){et(n,r,o,i,s,"throw",t)}i(void 0)}))})()}_getActiveGroup(t,e){if(!e.parent||!t)return e;const a=this._getControlName(t.metadata);return a?e.parent.get(a)?e:this._getActiveGroup(t,e.parent):t.parent?this._getActiveGroup(t.parent,e):this._getActiveGroup(t.parent,e.root)}_getControlName(t){return t?t.options?.controlName:null}_getControlForMetadata(t){switch(t?.options?.controlType){case K.Z.FormArray:return new H.Oe([]);case K.Z.FormGroup:return new $.cw({});default:return new E.NI}}}rt.ɵfac=function(t){return new(t||rt)(X.LF(tt.$))},rt.ɵprov=W.Yz({token:rt,factory:rt.ɵfac});var ot=a(85902),nt=a(75990),it=a(79842),st=a(84773),lt=a(43870),ut=a(6845),ct=a(4477),dt=a(15686),pt=a(94727),mt=a(6427),ft=a(32361),gt=a(12311),vt=a(21651),ht=a(58323),_t=a(77470),yt=a(27635),wt=a(86170),bt=a(4489),Ct=a(68965),xt=a(31686),Mt=a(60405);function Ft(t,e,a,r,o,n,i){try{var s=t[n](i),l=s.value}catch(t){return void a(t)}s.done?e(l):Promise.resolve(l).then(r,o)}function Ot(t,e){if(1&t&&Y._U(0,"ng-option",7),2&t){const t=e.$implicit;D.Q("value",t)("text",t)}}function Rt(t,e){if(1&t){const t=st.E();Y.Tg(0,"form",8),Q.N("ngSubmit",(function(){lt.CH(t);const e=ut.o();return lt.Kt(e._submit())})),Y.Tg(1,"div",9)(2,"div",10),ct.Gk(3,11),Y.qZ()(),Y.Tg(4,"button",12),L._(5,"Submit"),Y.qZ()()}if(2&t){const t=ut.o();D.Q("formGroup",t._formGroup),j.x(3),D.Q("layoutComponentRenderer",t._metadata)("layoutComponentRendererInjector",t._formInjector)}}const Nt=function(t){return["/relationsLayoutForm/layout",t]},kt=function(t){return["/relationsLayoutForm/relations",t]};let Tt=class{constructor(t,e,a,r,o,n,i){this._relationsManager=t,this._store=e,this._router=a,this._route=r,this._injector=o,this._formComponentControlBuilder=n,this._changeDetector=i,this.selectedMetadata=null,this._available=new E.NI(""),this._metadata=null,this._availableNames=[]}ngOnInit(){var t=this;this._availableNames=this._store.getStored(),this._route.params.subscribe(function(){var e,a=(e=function*({id:e}){if(e){t._available.setValue(e);const a=t.selectedMetadata=t._store.getData(e);t._metadata=a?.layout,t._relationsManager.setRelations(a.relations??[]),t._formGroup=yield t._formComponentControlBuilder.build(t._metadata),t._formInjector=Z.z.create({parent:t._injector,providers:[{provide:J.O,useValue:t._formGroup}]}),t._changeDetector.detectChanges()}else t.selectedMetadata=null,t._relationsManager.setRelations([]);t._available.valueChanges.subscribe((e=>{t._router.navigate(["/relationsLayoutForm","form-preview",e],{skipLocationChange:!1,replaceUrl:!0})}))},function(){var t=this,a=arguments;return new Promise((function(r,o){var n=e.apply(t,a);function i(t){Ft(n,r,o,i,s,"next",t)}function s(t){Ft(n,r,o,i,s,"throw",t)}i(void 0)}))});return function(t){return a.apply(this,arguments)}}())}ngOnDestroy(){}_submit(){console.log(this._formGroup.value)}};var Yt,Lt;Tt.ɵfac=function(t){return new(t||Tt)(N.Y(nt.N),N.Y(O.U),N.Y(z.F0),N.Y(V.gz),N.Y(Z.z),N.Y(rt),N.Y(S.s))},Tt.ɵcmp=k.Xp({type:Tt,selectors:[["form-preview-view"]],features:[T._([rt,tt.$,ot.T,(0,it.AL)(),(0,x.Hh)()])],decls:11,vars:11,consts:[[1,"flex-row"],[1,"margin-horizontal-small",3,"routerLink"],[1,"flex-1",3,"formControl"],[3,"value","text",4,"ngFor","ngForOf"],[3,"copyClick"],[1,"margin-horizontal-small"],[3,"formGroup","ngSubmit",4,"ngIf"],[3,"value","text"],[3,"formGroup","ngSubmit"],[1,"flex-row","margin-top-big","flex-1"],[1,"flex-1","overflow-vertical-scroll","thin-scrollbar"],[3,"layoutComponentRenderer","layoutComponentRendererInjector"],["type","submit"]],template:function(t,e){1&t&&(Y.Tg(0,"div",0)(1,"a",1),L._(2,"layout"),Y.qZ(),Y.Tg(3,"a",1),L._(4,"relations"),Y.qZ(),Y.Tg(5,"ng-select",2),dt.Y(6,Ot,1,2,"ng-option",3),Y.qZ(),Y.Tg(7,"debug-data",4)(8,"div",5),L._(9),Y.qZ()()(),dt.Y(10,Rt,6,3,"form",6)),2&t&&(j.x(1),D.Q("routerLink",pt.VK(7,Nt,e._available.value)),j.x(2),D.Q("routerLink",pt.VK(9,kt,e._available.value)),j.x(2),D.Q("formControl",e._available),j.x(1),D.Q("ngForOf",e._availableNames),j.x(1),D.Q("copyClick",e.selectedMetadata),j.x(2),mt.Oq(e._available.value),j.x(1),D.Q("ngIf",e._formGroup))},dependencies:[gt.s,vt.O,ht._,_t.JJ,_t.JL,yt.oH,wt.s,bt.x,Ct.w,xt.v,Mt.i,ft.y,P.v,U.o],encapsulation:2,changeDetection:0}),Tt=(0,r.gn)([("",Yt="form-preview",function(t){const e=t;if((0,B.fp)(e.routeValues)&&(0,B.fp)(Yt))return console.warn("Missing 'ComponentRoute' or wrong order of decorators 'ComponentRoute' and 'ComponentRedirectRoute'!"),t;if((0,B.fp)(Yt)&&(0,B.EN)(e.routeValues)&&e.routeValues.length>1)return console.warn("Multiple routes defined. Unable to set proper redirect!"),t;const a=t;return(0,B.fp)(a.redirectRouteValues)&&Object.defineProperty(t,"redirectRouteValues",{enumerable:!0,configurable:!1,writable:!1,value:[]}),(0,B.fp)(Lt)&&(Lt=!0),(0,B.fp)(Yt)&&(Yt=e.routeValues[0].path),a.redirectRouteValues.push({path:"",redirectTo:Yt,pathMatch:Lt?"full":"prefix"}),t}),(0,f.N)({path:"form-preview"}),(0,f.N)({path:"form-preview/:id"}),(0,r.w6)("design:paramtypes",[nt.N,O.U,z.F0,V.gz,Z.z,rt,S.s])],Tt);var Qt=a(91861),jt=a(80734),Dt=a(20809),It=a(85638),Ut=a(31166),Gt=a(36159);let Pt=class{constructor(t,e,a){this._store=t,this.history=e,this._layoutManager=a,this._metadata=[]}get emptyMetadata(){return[]}_getMetadata(t){return{relations:t}}_loadDemo(){this._metadata=It.F.demoRelationsComplexRelations}_loadRestDemo(){this._metadata=It.F.complexDemoRestRelations}_loadFullDemo(){this._metadata=It.F.complexDemoFullRelations}setMetadata(t){this._metadata=t?.relations??this.emptyMetadata,this._layoutManager.setLayout(t?.layout)}};Pt.ɵfac=function(t){return new(t||Pt)(N.Y(O.U),N.Y(Qt.nR),N.Y(jt.n))},Pt.ɵcmp=k.Xp({type:Pt,selectors:[["form-relations-editor-view"]],features:[T._([h.z,{provide:Dt.te,useFactory:t=>new u.I((e=>t.getData(e)?.relations)),deps:[O.U]},(0,it.$R)(),(0,C.vu)(),(0,b.Rn)(),(0,w.El)(),(0,x.pS)(),{provide:_.L,useClass:Ut.d}])],decls:6,vars:4,consts:[[1,"flex-row"],["type","button","goBack","",1,"btn","btn-primary","margin-right-extra-small"],["routePath","/relationsLayoutForm/relations",3,"store","getMetadataCallback","history","metadataChange"],[1,"flex-1",3,"metadata"]],template:function(t,e){1&t&&(Y.Tg(0,"div",0)(1,"button",1)(2,"span"),L._(3,"go back"),Y.qZ()(),Y.Tg(4,"load-save-new",2),Q.N("metadataChange",(function(t){return e.setMetadata(t)})),Y.qZ()(),Y._U(5,"relations-editor",3)),2&t&&(j.x(4),D.Q("store",e._store)("getMetadataCallback",e._getMetadata)("history",e.history),j.x(1),D.Q("metadata",e._metadata))},dependencies:[I.v,Gt.Y,q.Q],encapsulation:2,changeDetection:0}),(0,r.gn)([F.r,(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",[Array]),(0,r.w6)("design:returntype",Object)],Pt.prototype,"_getMetadata",null),Pt=(0,r.gn)([(0,f.N)({path:"relations"}),(0,f.N)({path:"relations/:id"}),(0,r.w6)("design:paramtypes",[O.U,y.Y,jt.n])],Pt);const qt=[Tt,A,Pt];var At=a(53245),Zt=a(18567);let St=class{};St.ɵfac=function(t){return new(t||St)},St.ɵmod=k.oA({type:St}),St.ɵinj=W.cJ({providers:[{provide:p.qO,useFactory:t=>new u.I((e=>t.getData(e))),deps:[O.U]},(0,At.Y)("LAYOUT_RELATIONS_FORM_DATA")],imports:[o.e,n.U,d.A,i.Bz,s.p,m.W,c.s,Zt.Qw]}),St=(0,r.gn)([(0,l.P)(qt)],St)},79898:(t,e,a)=>{a.d(e,{O:()=>r});const r=new(a(40296).O)("FORM_COMPONENT_CONTROL")}}]);
//# sourceMappingURL=574.chunk.9d3198b791ccb35688ba.js.map
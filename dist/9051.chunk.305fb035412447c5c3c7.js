"use strict";(self.webpackChunkng_universal_demo=self.webpackChunkng_universal_demo||[]).push([[9051],{53245:(t,e,n)=>{n.d(e,{Y:()=>r});var a=n(46480),o=n(89952);function r(t){return{provide:o.U,useFactory:e=>new o.U(e,t),deps:[a.T0]}}},68926:(t,e,n)=>{n.r(e),n.d(e,{RelationsEditorModule:()=>C});var a=n(14392),o=n(89001),r=n(22654),i=n(99043),s=n(57489),d=n(94761),c=n(48397),l=n(27049),p=n(85638),m=n(89952),u=n(79440),g=n(13691),f=n(80827),h=n(72891),v=n(41853),y=n(66794),_=n(73301),w=n(6427),D=n(86825),x=n(36159);let b=class{constructor(t,e){this._manager=t,this._store=e,this._metadata=[],this.stringMetadata=""}get emptyMetadata(){return[]}_getMetadata(){return this._manager.getMetadata()}_loadDemo(){this._metadata=p.F.relationsDemo}showMetadata(){const t=this._getMetadata();this.stringMetadata=JSON.stringify(t,null,4)}};b.ɵfac=function(t){return new(t||b)(u.Y(c.J),u.Y(m.U))},b.ɵcmp=g.Xp({type:b,selectors:[["relations-editor-view"]],decls:16,vars:4,consts:[[1,"flex-row"],["routePath","/relationsEditor",3,"store","getMetadataCallback","metadataChange"],["type","button",1,"btn","btn-primary",3,"click"],[1,"flex-1","flex-row"],[1,"flex-1",3,"metadata"],[1,"flex-column",2,"width","300px"],[1,"thin-scrollbar","flex-1",2,"white-space","pre","overflow","scroll"]],template:function(t,e){1&t&&(f.Tg(0,"div",0)(1,"load-save-new",1),h.N("metadataChange",(function(t){let n;return e._metadata=null!==(n=t)&&void 0!==n?n:e.emptyMetadata})),f.qZ(),f.Tg(2,"button",2),h.N("click",(function(){return e._loadDemo()})),f.Tg(3,"span"),v._(4,"demo"),f.qZ()()(),f.Tg(5,"div",3),f._U(6,"relations-editor",4),f.Tg(7,"div",5)(8,"div"),v._(9,"Relations metadata"),f.qZ(),f.Tg(10,"div")(11,"button",2),h.N("click",(function(){return e.showMetadata()})),f.Tg(12,"span"),v._(13,"show metadata"),f.qZ()()(),f.Tg(14,"div",6),v._(15),f.qZ()()()),2&t&&(y.x(1),_.Q("store",e._store)("getMetadataCallback",e._getMetadata),y.x(5),_.Q("metadata",e._metadata),y.x(9),w.Oq(e.stringMetadata))},dependencies:[D.Q,x.Y],encapsulation:2,changeDetection:0}),(0,a.gn)([l.r,(0,a.w6)("design:type",Function),(0,a.w6)("design:paramtypes",[]),(0,a.w6)("design:returntype",Array)],b.prototype,"_getMetadata",null),b=(0,a.gn)([(0,d.N)({path:""}),(0,d.N)({path:":id"}),(0,a.w6)("design:paramtypes",[c.J,m.U])],b);const k=[b];var I=n(18567),M=n(53245),O=n(38327);let C=class{};C.ɵfac=function(t){return new(t||C)},C.ɵmod=g.oA({type:C}),C.ɵinj=O.cJ({providers:[(0,M.Y)("RELATIONS_DATA"),(0,i.eh)(),(0,s.wr)()],imports:[I.Qw,r.Y.withProviders()]}),C=(0,a.gn)([(0,o.P)(k)],C)},6258:(t,e,n)=>{n.d(e,{E:()=>Q});var a=n(2032),o=n(27052),r=n(989),i=n(46480),s=n(57466),d=n(45069),c=n(38223),l=n(91861),p=n(13691);class m{transform(t,e,n){const a=n?e:`${t.itemSource.name}-${e}`;return{metadata:{id:a,displayName:a,package:t.itemSource.package,name:t.itemSource.name,relationsOptions:(0,s.l7)(!0,{},t.metadata.metaInfo?.defaultOptions),outputs:[],nodeMetadata:{coordinates:{x:0,y:0},options:null}}}}}m.ɵfac=function(t){return new(t||m)},m.ɵpipe=p.Yj({name:"toRelationsDragData",type:m,pure:!0,standalone:!0});var u=n(80827),g=n(41853),f=n(6845),h=n(66794),v=n(6427),y=n(84773),_=n(72891),w=n(43870),D=n(65589),x=n(15686),b=n(73301),k=n(4477),I=n(79440),M=n(68961),O=n(82568),C=n(48397),T=n(12311),L=n(21651),P=n(32434),N=n(99055),Y=n(23208);function F(t,e,n,a,o,r,i){try{var s=t[r](i),d=s.value}catch(t){return void n(t)}s.done?e(d):Promise.resolve(d).then(a,o)}function S(t){return function(){var e=this,n=arguments;return new Promise((function(a,o){var r=t.apply(e,n);function i(t){F(r,a,o,i,s,"next",t)}function s(t){F(r,a,o,i,s,"throw",t)}i(void 0)}))}}function q(t,e){if(1&t&&(u.Tg(0,"div",8),g._(1),u.qZ()),2&t){const t=f.o().$implicit;h.x(1),v.Oq(null==t.metadata.metaInfo?null:t.metadata.metaInfo.description)}}function A(t,e){if(1&t){const t=y.E();u.Tg(0,"div",4)(1,"div",5),_.N("cdkDragDropped",(function(){w.CH(t);const e=f.o(2);return w.Kt(e.generateNewId())})),D.AL(2,"toRelationsDragData"),u.Tg(3,"div",6),g._(4),u.qZ(),x.Y(5,q,2,1,"div",7),u.qZ()()}if(2&t){const t=e.$implicit,n=f.o(2);let a;b.Q("cdkDropListConnectedTo",n.canvasDropList),h.x(1),b.Q("cdkDragData",D.Dn(2,4,t,t.metadata.singleton?t.itemSource.name:n.newCompnentId,t.metadata.singleton)),h.x(3),v.Oq(t.metadata.singleton?t.itemSource.name:null!==(a=null==t.metadata.metaInfo?null:t.metadata.metaInfo.name)&&void 0!==a?a:t.itemSource.name),h.x(1),b.Q("ngIf",null==t.metadata.metaInfo?null:t.metadata.metaInfo.description)}}function Z(t,e){if(1&t&&(k.yn(0),u.Tg(1,"div",2),g._(2),u.qZ(),x.Y(3,A,6,8,"div",3),k.BQ()),2&t){const t=e.$implicit;h.x(2),v.hi("",t.key," "),h.x(1),b.Q("ngForOf",t.value)}}class Q{constructor(t,e,n,a,o,r){this._moduleTypesLoader=t,this._nodesLoader=e,this._changeDetector=n,this._metadataManager=a,this._refreshObservables=o,this._logger=r,this.initSubscriptions=new c.w,this.allItems=[],this.syncPromise=Promise.resolve(),this.groupedItems={},this.newCompnentId=(0,s.Ox)(16),this.isDragOverPalette=!1}ngOnInit(){var t=this;return S((function*(){if(t._refreshObservables&&Array.isArray(t._refreshObservables))for(const e of t._refreshObservables)t.initSubscriptions.add(e.subscribe((()=>t.loadNodes())));yield t.loadNodes()}))()}ngOnDestroy(){this.initSubscriptions.unsubscribe()}loadNodes(){var t=this;return S((function*(){var e;let n;yield t.syncPromise,t.syncPromise=new Promise((t=>n=t)),t.allItems=[],t.groupedItems={};for(const e of["basic-components","material-components","static-components","layout-components","handlebars-components","tinymce-components"]){const n=(yield t._moduleTypesLoader.loadItem({package:e,name:"types"}))?.data??[];for(const a of n){const n={package:e,name:a},o=yield t._nodesLoader.loadItem(n);o?t.allItems.push({itemSource:n,metadata:o}):t._logger?.warn("NodesPaletteSAComponent: Failed to obtain layout editor metadata {@source}",n)}}t.groupedItems[""]=[];for(const n of t.allItems){const a=n.metadata.metaInfo?.group??"";(e=t.groupedItems)[a]??(e[a]=[]),t.groupedItems[a].push(n)}t._changeDetector.detectChanges(),n?.()}))()}generateNewId(){this.newCompnentId=(0,s.Ox)(16)}}Q.ɵfac=function(t){return new(t||Q)(I.Y(l.Bj),I.Y(l.fI),I.Y(M.s),I.Y(C.J),I.Y(l.dK,8),I.Y(i.bZ,8))},Q.ɵcmp=p.Xp({type:Q,selectors:[["nodes-palette"]],inputs:{canvasDropList:"canvasDropList"},standalone:!0,features:[O.j],decls:3,vars:3,consts:[[1,"flex-column","overflow-vertical-scroll","thin-scrollbar"],[4,"ngFor","ngForOf"],[1,"text-spread","text-small-caps","margin-left-extra-small","margin-horizontal-small","bold"],["cdkDropList","","cdkDropListSortingDisabled","","class","palette-droplist",3,"cdkDropListConnectedTo",4,"ngFor","ngForOf"],["cdkDropList","","cdkDropListSortingDisabled","",1,"palette-droplist",3,"cdkDropListConnectedTo"],["cdkDrag","",1,"editor-component","mat-elevation-z2",3,"cdkDragData","cdkDragDropped"],[1,"editor-component-name"],["class","editor-component-description",4,"ngIf"],[1,"editor-component-description"]],template:function(t,e){1&t&&(u.Tg(0,"div",0),x.Y(1,Z,4,2,"ng-container",1),D.AL(2,"keyvalue"),u.qZ()),2&t&&(h.x(1),b.Q("ngForOf",D.lc(2,1,e.groupedItems)))},dependencies:[o.e,T.s,L.O,P.N,r._,N.W,Y.Z,m],styles:["[_nghost-%COMP%]\n{\n    display: flex;\n}\n\n.editor-component[_ngcontent-%COMP%]\n{\n    margin: 2px 10px;\n    padding: 4px 8px;\n\n    border-radius: 6px;\n    border: 1px solid #F0F0F0;\n    background-color: #FAFAFA;\n}\n\n.editor-component-name[_ngcontent-%COMP%]\n{\n    font-weight: 500;\n}\n\n.editor-component-description[_ngcontent-%COMP%]\n{\n    margin-left: 4px;\n    margin-top: 2px;\n    font-size: .8em;\n}\n\n.palette-droplist[_ngcontent-%COMP%]   layout-editor-drag-placeholder[_ngcontent-%COMP%]\n{\n    display: none;\n}"],changeDetection:0}),(0,a.gn)([(0,d.C)(10),(0,a.w6)("design:type",Function),(0,a.w6)("design:paramtypes",[]),(0,a.w6)("design:returntype",Promise)],Q.prototype,"loadNodes",null)},36159:(t,e,n)=>{n.d(e,{Y:()=>g});var a=n(989),o=n(6258),r=n(75957),i=n(13691),s=n(82568),d=n(80827),c=n(72891),l=n(11282),p=n(66794),m=n(73301),u=n(99055);class g{constructor(){this.metadata=[]}addNode(t){const e=t.container.element.nativeElement.getBoundingClientRect();t.item.data.metadata.nodeMetadata?.coordinates&&(t.item.data.metadata.nodeMetadata.coordinates.x=t.dropPoint.x-e.x,t.item.data.metadata.nodeMetadata.coordinates.y=t.dropPoint.y-e.y),this.metadata=[...this.metadata,t.item.data.metadata]}}g.ɵfac=function(t){return new(t||g)},g.ɵcmp=i.Xp({type:g,selectors:[["relations-editor"]],inputs:{metadata:"metadata"},standalone:!0,features:[s.j],decls:4,vars:2,consts:[[1,"flex-row","flex-1"],[2,"width","250px",3,"canvasDropList"],["cdkDropList","",1,"flex-1",3,"nodeDefinitions","cdkDropListDropped"],["dropList","cdkDropList"]],template:function(t,e){if(1&t&&(d.Tg(0,"div",0),d._U(1,"nodes-palette",1),d.Tg(2,"relations-canvas",2,3),c.N("cdkDropListDropped",(function(t){return e.addNode(t)})),d.qZ()()),2&t){const t=l.M(3);p.x(1),m.Q("canvasDropList",t),p.x(1),m.Q("nodeDefinitions",e.metadata)}},dependencies:[o.E,r.F,a._,u.W],styles:["[_nghost-%COMP%]{display: flex;}"],changeDetection:0})},22654:(t,e,n)=>{n.d(e,{Y:()=>s});var a=n(36159),o=n(47432),r=n(13691),i=n(38327);class s{static withProviders(){return{ngModule:s,providers:[(0,o.TN)()]}}static withStaticComponents(t){return{ngModule:s,providers:[(0,o.hE)(t)]}}}s.ɵfac=function(t){return new(t||s)},s.ɵmod=r.oA({type:s}),s.ɵinj=i.cJ({imports:[a.Y]})},89402:(t,e,n)=>{function a(t){return!!t.__ɵɵRelationsComponent}function o(){return function(t){return t.__ɵɵRelationsComponent=!0,t}}n.d(e,{H:()=>o,O:()=>a})},27049:(t,e,n)=>{n.d(e,{r:()=>o});var a=n(43939);function o(t,e,n){const o=n.value??n.get?.();if(!(0,a.mf)(o))throw new Error(`Unable to apply @BindThis decorator to '${e.toString()}', it is not a method.`);return{configurable:!0,get(){const t=o.bind(this);return Object.defineProperty(this,e,{value:t,configurable:!0,writable:!0}),t}}}}}]);
//# sourceMappingURL=9051.chunk.305fb035412447c5c3c7.js.map
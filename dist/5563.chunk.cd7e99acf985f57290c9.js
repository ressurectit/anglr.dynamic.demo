"use strict";(self.webpackChunkng_universal_demo=self.webpackChunkng_universal_demo||[]).push([[5563],{95563:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Se});var i=n(27052),o=n(46480),r=n(13691),a=n(38327);class s{}s.ɵfac=function(e){return new(e||s)},s.ɵmod=r.oA({type:s}),s.ɵinj=a.cJ({});var d=n(53633),l=n(60405),c=n(43939),h=n(17868),p=n(23199),u=n(79440),g=n(4905),m=n(55436);class y{constructor(e){this._element=e,this.active=!1,this.initSubscriptions=new p.w0,this.horizontal=!1,this.canDrop=!1}ngOnInit(){this.observer=new MutationObserver((e=>{for(const t of e)t.target instanceof HTMLElement&&this.updatedDimensions(t.target)})),this.initSubscriptions.add(this.layoutComponentRendererDirective?.componentChange.subscribe((e=>{if(!e)return void this.observer?.disconnect();const t=e.hostView.rootNodes[0];this.updatedDimensions(t),this.observer?.observe(t,{childList:!0})})))}ngOnDestroy(){this.observer?.disconnect(),this.initSubscriptions.unsubscribe()}updatedDimensions(e){if(!(e.children.length&&!this.active||!e.children.length&&this.active)&&this.canDrop)if(e.children.length){if(1===e.children.length&&e.children.item(0)?.classList.contains("drag-placeholder"))return;this.active=!1,this.horizontal?e.style.minWidth="":e.style.minHeight=""}else this.active=!0,this.horizontal?e.style.minWidth="30px":e.style.minHeight="30px"}}y.ɵfac=function(e){return new(e||y)(u.Y(g.SB))},y.ɵdir=r.lG({type:y,selectors:[["","designerMinWidth",""]],contentQueries:function(e,t,n){if(1&e&&m.Su(n,l.i,7),2&e){let e;m.iG(e=m.CR())&&(t.layoutComponentRendererDirective=e.first)}},inputs:{horizontal:"horizontal",canDrop:"canDrop"},standalone:!0});var v=n(85902);function f(e,t,n,i,o,r,a){try{var s=e[r](a),d=s.value}catch(e){return void n(e)}s.done?t(d):Promise.resolve(d).then(i,o)}class D{constructor(e,t){this._element=e,this._metadataExtractor=t}get metadata(){return this._metadata}set metadata(e){this._metadata=e,this._copyDesignerStyles()}_copyDesignerStyles(){var e,t=this;return(e=function*(){if(!t._metadata)return;const e=(yield t._metadataExtractor.extractMetadata(t._metadata))?.applyDesignerStyles;e&&e(t._metadata.options,t._element.nativeElement.style)},function(){var t=this,n=arguments;return new Promise((function(i,o){var r=e.apply(t,n);function a(e){f(r,i,o,a,s,"next",e)}function s(e){f(r,i,o,a,s,"throw",e)}a(void 0)}))})()}}D.ɵfac=function(e){return new(e||D)(u.Y(g.SB),u.Y(v.T))},D.ɵdir=r.lG({type:D,selectors:[["","copyDesignerStyles",""]],inputs:{metadata:["copyDesignerStyles","metadata"]},exportAs:["copyDesignerStyles"],standalone:!0});var b=n(98906);class _{constructor(e,t){this.draggingSvc=e,this.element=t,this.initSubscriptions=new p.w0,this.isDropZone=!1}ngOnInit(){this.initSubscriptions.add(this.draggingSvc.draggingChange.subscribe((()=>this.processDragValue())))}ngOnDestroy(){this.initSubscriptions.unsubscribe()}processDragValue(){setTimeout((()=>{this.draggingSvc.dragging&&this.isDropZone?this.element.nativeElement.classList.add("drag-active"):this.element.nativeElement.classList.remove("drag-active")}))}}_.ɵfac=function(e){return new(e||_)(u.Y(b.z),u.Y(g.SB))},_.ɵdir=r.lG({type:_,selectors:[["",8,"designer-dropzone"]],inputs:{isDropZone:"isDropZone"},standalone:!0});var C=n(48936),M=n(93802),w=n(15783);class E{constructor(e,t,n){this.template=e,this.viewContainer=t,this.document=n}ngOnInit(){this.view=this.viewContainer.createEmbeddedView(this.template),this.element=this.view.rootNodes[0],this.document.body.appendChild(this.element)}ngOnDestroy(){this.element?.remove(),this.element=null,this.view?.destroy(),this.view=null}}E.ɵfac=function(e){return new(e||E)(u.Y(M.Rg),u.Y(w.s_),u.Y(C.K))},E.ɵdir=r.lG({type:E,selectors:[["","bodyRender",""]],standalone:!0});var x=n(82568),O=n(80827),P=n(41853),S=n(66794),T=n(6427);class z{}z.ɵfac=function(e){return new(e||z)},z.ɵcmp=r.Xp({type:z,selectors:[["layout-editor-drag-preview"]],inputs:{editorMetadata:"editorMetadata",layoutMetadata:"layoutMetadata"},standalone:!0,features:[x.j],decls:4,vars:2,consts:[[1,"semi-bold"],[1,"margin-left-extra-small","small-text"]],template:function(e,t){if(1&e&&(O.Tg(0,"span",0),P._(1),O.qZ(),O.Tg(2,"span",1),P._(3),O.qZ()),2&e){let e;S.x(1),T.Oq(null!==(e=null==t.editorMetadata||null==t.editorMetadata.metaInfo?null:t.editorMetadata.metaInfo.name)&&void 0!==e?e:null==t.layoutMetadata?null:t.layoutMetadata.name),S.x(2),T.hi("#",(null==t.layoutMetadata?null:t.layoutMetadata.displayName)||(null==t.layoutMetadata?null:t.layoutMetadata.id),"")}},styles:["[_nghost-%COMP%]\n{\n    display: block;\n    background-color: #eee;\n    border-radius: 6px;\n    padding: 3px 8px;\n}"],changeDetection:0});var Y=n(68961),R=n(85320);class I{constructor(e,t){this._element=e,this._changeDetector=t}ngOnInit(){this._observer=new MutationObserver((()=>this._changeDetector.detectChanges())),this._htmlElement=this.layoutComponentRendererDirective?.componentRef?.hostView?.rootNodes?.[0],this._htmlElement&&this._observer?.observe(this._htmlElement,{attributeFilter:["style"]})}ngOnDestroy(){this._observer?.disconnect()}}I.ɵfac=function(e){return new(e||I)(u.Y(g.SB),u.Y(Y.s))},I.ɵcmp=r.Xp({type:I,selectors:[["","layoutDesignerOverlayFor",""]],inputs:{layoutComponentRendererDirective:["layoutDesignerOverlayFor","layoutComponentRendererDirective"]},standalone:!0,features:[x.j],attrs:["layoutDesignerOverlayFor",""],decls:12,vars:24,consts:[[1,"margin-top-div"],[1,"margin-bottom-div"],[1,"margin-left-div"],[1,"margin-right-div"],[1,"padding-top-div"],[1,"padding-bottom-div"],[1,"padding-left-div"],[1,"padding-right-div"],[1,"border-top-div"],[1,"border-bottom-div"],[1,"border-left-div"],[1,"border-right-div"]],template:function(e,t){1&e&&O._U(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"div",9)(10,"div",10)(11,"div",11),2&e&&(R.Ud("height",null==t._htmlElement||null==t._htmlElement.style?null:t._htmlElement.style.marginTop),S.x(1),R.Ud("height",null==t._htmlElement||null==t._htmlElement.style?null:t._htmlElement.style.marginBottom),S.x(1),R.Ud("width",null==t._htmlElement||null==t._htmlElement.style?null:t._htmlElement.style.marginLeft),S.x(1),R.Ud("width",null==t._htmlElement||null==t._htmlElement.style?null:t._htmlElement.style.marginRight),S.x(1),R.Ud("height",null==t._htmlElement||null==t._htmlElement.style?null:t._htmlElement.style.paddingTop),S.x(1),R.Ud("height",null==t._htmlElement||null==t._htmlElement.style?null:t._htmlElement.style.paddingBottom),S.x(1),R.Ud("width",null==t._htmlElement||null==t._htmlElement.style?null:t._htmlElement.style.paddingLeft),S.x(1),R.Ud("width",null==t._htmlElement||null==t._htmlElement.style?null:t._htmlElement.style.paddingRight),S.x(1),R.Ud("height",null==t._htmlElement||null==t._htmlElement.style?null:t._htmlElement.style.borderTop),S.x(1),R.Ud("height",null==t._htmlElement||null==t._htmlElement.style?null:t._htmlElement.style.borderBottom),S.x(1),R.Ud("width",null==t._htmlElement||null==t._htmlElement.style?null:t._htmlElement.style.borderLeft),S.x(1),R.Ud("width",null==t._htmlElement||null==t._htmlElement.style?null:t._htmlElement.style.borderRight))},styles:['[_nghost-%COMP%]\n{\n    display: grid;\n\n    grid-template-columns: auto auto auto 1fr auto auto auto;\n    grid-template-rows: auto auto auto 1fr auto auto auto;\n}\n\n[class^="margin"][_ngcontent-%COMP%]\n{\n    background-color: #d0ff0060;\n}\n\n[class^="padding"][_ngcontent-%COMP%]\n{\n    background-color: #613eff60;\n}\n\n[class^="border"][_ngcontent-%COMP%]\n{\n    background-color: #0011ff62;\n}\n\n.margin-top-div[_ngcontent-%COMP%]\n{\n    grid-row: 1/2;\n    grid-column: 1/8;\n}\n\n.margin-bottom-div[_ngcontent-%COMP%]\n{\n    grid-row: 7/8;\n    grid-column: 1/8;\n}\n\n.margin-left-div[_ngcontent-%COMP%]\n{\n    grid-row: 2/7;\n    grid-column: 1/2;\n}\n\n.margin-right-div[_ngcontent-%COMP%]\n{\n    grid-row: 2/7;\n    grid-column: 7/8;\n}\n\n.padding-top-div[_ngcontent-%COMP%]\n{\n    grid-row: 3/4;\n    grid-column: 3/6;\n}\n\n.padding-bottom-div[_ngcontent-%COMP%]\n{\n    grid-row: 5/6;\n    grid-column: 3/6;\n}\n\n.padding-left-div[_ngcontent-%COMP%]\n{\n    grid-row: 4/5;\n    grid-column: 3/4;\n}\n\n.padding-right-div[_ngcontent-%COMP%]\n{\n    grid-row: 4/5;\n    grid-column: 5/6;\n}\n\n.border-top-div[_ngcontent-%COMP%]\n{\n    grid-row: 2/3;\n    grid-column: 2/7;\n}\n\n.border-bottom-div[_ngcontent-%COMP%]\n{\n    grid-row: 6/7;\n    grid-column: 2/7;\n}\n\n.border-left-div[_ngcontent-%COMP%]\n{\n    grid-row: 3/6;\n    grid-column: 2/3;\n}\n\n.border-right-div[_ngcontent-%COMP%]\n{\n    grid-row: 3/6;\n    grid-column: 6/7;\n}'],changeDetection:0});var A=n(71785),N=n(10219),k=n(6845),L=n(73301),B=n(11282),G=n(84773),U=n(72891),F=n(43870),Z=n(4477),j=n(15686),Q=n(95176),V=n(47098),q=n(82973),H=n(94727),$=n(83434),W=n(26938),X=n(21651),K=n(74445),J=n(49891),ee=n(54214),te=n(90675),ne=n(36973);function ie(e,t,n,i,o,r,a){try{var s=e[r](a),d=s.value}catch(e){return void n(e)}s.done?t(d):Promise.resolve(d).then(i,o)}class oe{constructor(e,t){this._target=e,this._position=t,this.flip=new K.v}get source(){return this._source}set source(e){e instanceof g.SB?this._source=e.nativeElement:this._source=e}get placement(){return this._placement}set placement(e){(0,c.HD)(e)?this._placement=ee.X[e]:this._placement=e}ngOnChanges(e){((0,J.$)("source")in e||(0,J.$)("placement")in e)&&(0,c.EN)(this.source)&&this._applyPosition()}_applyPosition(){var e,t=this;return(e=function*(){const e={};t._placement&&(e.placement=t._placement);const n=yield t._position.placeElement(t._target.nativeElement,t._source,e).toPromise();(0,te.e)(n),n.flip&&t.flip.next()},function(){var t=this,n=arguments;return new Promise((function(i,o){var r=e.apply(t,n);function a(e){ie(r,i,o,a,s,"next",e)}function s(e){ie(r,i,o,a,s,"throw",e)}a(void 0)}))})()}}oe.ɵfac=function(e){return new(e||oe)(u.Y(g.SB),u.Y(o.Vr))},oe.ɵdir=r.lG({type:oe,selectors:[["","positionTo",""]],inputs:{source:["positionTo","source"],placement:"placement"},outputs:{flip:"flip"},features:[ne.T]});var re=n(44214),ae=n(2032),se=n(65508),de=n(27049),le=n(16114);const ce=new(n(40296).O)("DRAG_PREVIEW_REGISTRATOR");var he=n(88364),pe=n(73379),ue=n(48759),ge=n(52053);class me{constructor(e,t,n,i,o,r,a,s){this.dnd=e,this.designerElement=t,this.draggingSvc=n,this.manager=i,this.bus=o,this.zone=r,this.injector=a,this.document=s,this.initSubscriptions=new p.w0,this.placeholderDrop=this.dnd.dropTarget(["COMPONENT","METADATA"],{canDrop:()=>!0,drop:e=>{const t=e.getItem();let n=this.bus.dropPlaceholderPreviewIndex;return t&&(0,c.EN)(t.dragData.index)&&(0,c.EN)(n)&&n>t.dragData.index&&n--,{index:n,id:this.metadata?.id}}},this.initSubscriptions),this.containerDrop=this.dnd.dropTarget(["COMPONENT","METADATA"],{canDrop:e=>this.canDropAncestors()[0]&&e.isOver({shallow:!0}),drop:e=>{const[t,n]=this.getFixedDropCoordinates(e,!1);return{index:t,id:n}},hover:e=>{if(e.isOver({shallow:!0})){const[t,n]=this.getDropCoordinates(e,!1);if((0,c.fp)(t)||(0,c.fp)(n))return;this.bus.setDropPlaceholderPreview({index:t,parentId:n,placeholder:{height:0,width:0}})}}},this.initSubscriptions),this.drag=this.dnd.dragSource("COMPONENT",{beginDrag:()=>(this.draggingSvc.setDragging(!0),this.designerElement.nativeElement.classList.add("is-dragged"),{dragData:this.dragData}),canDrag:()=>!this.dragDisabled,endDrag:e=>{if(e.didDrop()){const t=e.getItem(),n=e.getDropResult();if(!t)return;t.dragData.index=n.index,this.bus.setDropData({data:t.dragData,id:n.id})}else this.designerElement.nativeElement.classList.remove("is-dragged");this.bus.setDropPlaceholderPreview(null),this.draggingSvc.setDragging(!1)}},this.initSubscriptions),this.dropzone=this.dnd.dropTarget(["COMPONENT","METADATA"],{canDrop:e=>(this.canDrop||this.canDropAncestors()[0])&&e.isOver({shallow:!0}),drop:e=>{const[t,n]=this.getFixedDropCoordinates(e,this.canDrop);return{index:t,id:n}},hover:e=>{if(e.isOver({shallow:!0})&&e.canDrop()){const[t,n]=this.getDropCoordinates(e,this.canDrop);if((0,c.fp)(t)||(0,c.fp)(n))return;this.bus.setDropPlaceholderPreview({index:t,parentId:n,placeholder:{height:0,width:0}})}}},this.initSubscriptions),this.dragDisabled=!1,this.dropMetadata=new K.v,this.connectDropToContainer()}get metadata(){if(!this.dragData.metadata)throw new Error("DndCoreDesignerDirective: invalid drag data without metadata!");return this.dragData.metadata}get canDrop(){return this.manager.getComponent(this.metadata.id)?.canDrop??!1}get horizontal(){return this.manager.getComponent(this.metadata.id)?.horizontal??!1}get containerElement(){if(!this.componentElement)return;const e=this.manager.getComponent(this.metadata.id);return e?.editorMetadata?.getChildrenContainer?e.editorMetadata.getChildrenContainer(this.componentElement)??this.componentElement:this.componentElement}ngOnInit(){if(!this.dropzoneElement)throw new Error("DndCoreDesignerDirective: missing dropzone element!");if(!this.dragData)throw new Error("DndCoreDesignerDirective: missing drag data!");this.initSubscriptions.add(this.layoutComponentRendererDirective?.componentElementChange.subscribe((e=>{this.componentElement=e||null}))),this.initSubscriptions.add(this.bus.dropDataChange.pipe((0,le.h)((e=>e.id===this.metadata.id))).subscribe((e=>this.dropMetadata.emit(e.data)))),this.initSubscriptions.add(this.bus.oldDropPlaceholderPreviewChange.pipe((0,le.h)((e=>e.parentId===this.metadata.id))).subscribe((()=>{this.placeholderPreviewElement?.remove(),this.placeholderPreviewElement=null}))),this.initSubscriptions.add(this.bus.newDropPlaceholderPreviewChange.pipe((0,le.h)((e=>e.parentId===this.metadata.id))).subscribe(this.showPlaceholderPreview))}ngOnDestroy(){this.initSubscriptions.unsubscribe(),this.placeholderConnection?.unsubscribe(),this.placeholderConnection=null,this.containerConnection?.unsubscribe(),this.containerConnection=null}registerPreviewElement(e){return this.drag.connectDragPreview(e,{offsetX:0,offsetY:0})}getDropCoordinates(e,t){if(t)return this.getDropCoordinatesForChildren(e);const[n,i,o]=this.canDropAncestors();if(!n||(0,c.fp)(i))return[null,null];const r=this.manager.getComponent(i),a=this.manager.getComponent(o)?.index??0,s=e.getItem();return s&&(0,c.EN)(s.dragData.index)&&s.dragData.metadata?.id===this.metadata.id?[s.dragData.index,s.dragData.parentId??""]:r?[a+this.getIndexIncrement(e,r.horizontal),i]:[null,null]}getDropCoordinatesForChildren(e){const t=e=>{const t=e.children[0].getBoundingClientRect();return(this.horizontal?t.x:t.y)+(this.horizontal?t.width:t.height)/2};if(!this.containerElement)return[null,null];let n=0;const i=e.getClientOffset();if(!i)return[null,null];const o=this.horizontal?i.x:i.y;for(let e=0;e<this.containerElement.children.length;e++){const i=this.containerElement.children[e];if(!i.classList.contains("drag-placeholder")){if(o<=t(i))return[n,this.metadata.id];n++}}return[n,this.metadata.id]}getFixedDropCoordinates(e,t){const[n,i]=this.getDropCoordinates(e,t);let o=n;const r=e.getItem();return r&&(0,c.EN)(o)&&(0,c.EN)(r.dragData.index)&&i===r.dragData.parentId&&o>r.dragData.index&&o--,[o,i]}getIndexIncrement(e,t){const n=this.dropzoneElement.getBoundingClientRect(),i=e.getClientOffset();return i?(t?i.x-n.x:i.y-n.y)<=(t?n.width/2:n.height/2)?0:1:0}showPlaceholderPreview(e){this.containerElement&&(this.placeholderPreviewElement??(this.placeholderPreviewElement=this.document.createElement("div")),this.placeholderPreviewElement.classList.add("drag-placeholder"),this.placeholderPreviewElement.remove(),this.connectDropToPlaceholder(),this.containerElement.insertBefore(this.placeholderPreviewElement,this.containerElement.children[e.index]))}connectDropToPlaceholder(){this.zone.runOutsideAngular((()=>{this.placeholderConnection?.unsubscribe(),this.placeholderPreviewElement&&(this.placeholderConnection=this.placeholderDrop.connectDropTarget(this.placeholderPreviewElement))}))}connectDropToContainer(){this.zone.runOutsideAngular((()=>{this.containerConnection?.unsubscribe(),this.containerConnection=this.containerDrop.connectDropTarget(this.designerElement.nativeElement)}))}canDropAncestors(e){(0,c.fp)(e)&&(e=this.metadata.id);const t=this.manager.getComponentDef(e);return t?.parent?t.parent.component.canDrop?[!0,t.parent.component.id,e]:this.canDropAncestors(t.parent.component.id):[!1,null,e]}}me.ɵfac=function(e){return new(e||me)(u.Y(ue.f),u.Y(g.SB),u.Y(b.z),u.Y($.t),u.Y(ge.E),u.Y(he.R),u.Y(Q.z),u.Y(C.K))},me.ɵdir=r.lG({type:me,selectors:[["","dndCoreDesigner",""]],contentQueries:function(e,t,n){if(1&e&&m.Su(n,l.i,7),2&e){let e;m.iG(e=m.CR())&&(t.layoutComponentRendererDirective=e.first)}},inputs:{dropzoneElement:"dropzoneElement",dragData:["dndCoreDesigner","dragData"],dragDisabled:"dragDisabled"},outputs:{dropMetadata:"dropMetadata"},exportAs:["dndCoreDesigner"],features:[pe._([{provide:ce,useExisting:(0,se.Gp)((()=>me))}])]}),(0,ae.gn)([de.r,(0,ae.w6)("design:type",Function),(0,ae.w6)("design:paramtypes",[Object]),(0,ae.w6)("design:returntype",void 0)],me.prototype,"showPlaceholderPreview",null);class ye{constructor(e,t,n,i){if(this.template=e,this.viewContainer=t,this.ngZone=n,this.dragPreviewRegistrator=i,!this.dragPreviewRegistrator)throw new Error("Unable to use DndCorePreviewDirective, becuase there is no drag preview registrator!")}ngOnInit(){this.templateRef=this.viewContainer.createEmbeddedView(this.template),this.element=this.templateRef.rootNodes[0],this.element&&document.body.append(this.element),this.ngZone.runOutsideAngular((()=>{this.element&&(this.placeholderConnection=this.dragPreviewRegistrator?.registerPreviewElement(this.element))}))}ngOnDestroy(){this.element?.remove(),this.element=null,this.templateRef?.destroy(),this.templateRef=null,this.placeholderConnection?.unsubscribe(),this.placeholderConnection=null}}function ve(e,t,n,i,o,r,a){try{var s=e[r](a),d=s.value}catch(e){return void n(e)}s.done?t(d):Promise.resolve(d).then(i,o)}function fe(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return fe=function(e){this.s=e,this.n=e.next},fe.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?Promise.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?Promise.reject(e):t(n.apply(this.s,arguments))}},new fe(e)}ye.ɵfac=function(e){return new(e||ye)(u.Y(M.Rg),u.Y(w.s_),u.Y(he.R),u.Y(ce,8))},ye.ɵdir=r.lG({type:ye,selectors:[["","dndCorePreview",""]]});const De=["layoutDesigner"],be=["dndCoreDesigner"];function _e(e,t){if(1&e&&O._U(0,"layout-editor-drag-preview",8),2&e){const e=k.o();L.Q("editorMetadata",e.editorMetadata)("layoutMetadata",e.renderedType)}}function Ce(e,t){}function Me(e,t){if(1&e&&(O.Tg(0,"div",12),P._(1),O.qZ()),2&e){const e=k.o(2),t=B.M(1);let n;L.Q("positionTo",t),S.x(1),T.Oq(null!==(n=null==e.editorMetadata||null==e.editorMetadata.metaInfo?null:e.editorMetadata.metaInfo.name)&&void 0!==n?n:null==e.renderedType?null:e.renderedType.name)}}function we(e,t){if(1&e){const e=G.E();O.Tg(0,"div",14),U.N("click",(function(){F.CH(e);const t=k.o(3);return F.Kt(t.remove())})),O._U(1,"span",15),O.qZ()}if(2&e){k.o(3);const e=B.M(1);L.Q("positionTo",e)}}function Ee(e,t){1&e&&(Z.yn(0),j.Y(1,we,2,1,"div",13),Z.BQ())}function xe(e,t){if(1&e&&(Z.yn(0),O._U(1,"div",9)(2,"div",10),j.Y(3,Me,2,2,"div",11),j.Y(4,Ee,2,0,"ng-container",7),Z.BQ()),2&e){const e=k.o(),t=B.M(7);S.x(2),L.Q("layoutDesignerOverlayFor",t),S.x(2),L.Q("ngIf",!!e.parent&&(null==e.parent.editorMetadata?null:e.parent.editorMetadata.removeDescendant))}}const Oe=function(e,t,n){return{metadata:e,parentId:t,index:n}};class Pe extends d.h{constructor(e,t,n,i,o,r,a,s,d){super(e,t,n,s),this.metadataExtractor=i,this.layoutEditorMetadataManager=o,this.iteratorSvc=r,this.history=a,this.parent=d,this.initSubscriptions=new p.w0,this.canDropFn=()=>this.canDrop,this.canDrop=!1,this.horizontal=!1,this.index=0,this.editorMetadata=null}get selected(){return this.layoutEditorMetadataManager.selectedComponent===this.options?.typeMetadata.id}get highlighted(){return this.layoutEditorMetadataManager.highlightedComponent===this.options?.typeMetadata.id}get element(){return this.designerElement}get extensionsOptions(){return this.options?.typeMetadata.options}get dragDisabled(){return!this.parent||!!this.editorMetadata?.metaInfo?.dragDisabled}get id(){return this.options?.typeMetadata?.id??""}ngOnDestroy(){this._logger?.debug("LayoutDesignerSAComponent: Destroying component {@data}",{id:this.options?.typeMetadata.id}),this.initSubscriptions.unsubscribe(),super.ngOnDestroy(),this.options&&this.layoutEditorMetadataManager.unregisterLayoutDesignerComponent(this.options.typeMetadata.id)}addDescendant(e){if(!this.options)return;const t=e.parentId;this._logger?.debug("LayoutDesignerSAComponent: Adding descendant {@data}",{id:e.metadata?.id,parent:this.options.typeMetadata.id}),e.metadata?(t&&(this.history.disable(),this.layoutEditorMetadataManager.getComponent(t)?.removeDescendant(e.metadata?.id),this.history.enable()),this.editorMetadata?.addDescendant?.(e?.metadata,this.options.typeMetadata.options,e.index??0),this.canDrop=this.editorMetadata?.canDropMetadata?.(this.options.typeMetadata.options)??!1,this.renderedType={...this.options.typeMetadata},this._changeDetector.markForCheck(),this.history.getNewState()):this._logger?.warn("LayoutDesignerSAComponent: Missing metadata while adding descendant")}removeDescendant(e){this.options&&(this._logger?.debug("LayoutDesignerSAComponent: Removing descendant {@data}",{id:this.options.typeMetadata.id,child:e}),this.editorMetadata?.removeDescendant?.(e,this.options.typeMetadata.options),this.canDrop=this.editorMetadata?.canDropMetadata?.(this.options.typeMetadata.options)??!1,this.renderedType={...this.options.typeMetadata},this._changeDetector.markForCheck(),this.history.getNewState())}showOverlay(e){this._logger?.verbose("LayoutDesignerComponent: Showing overlay for {@type}",{name:this.options?.typeMetadata.name,id:this.options?.typeMetadata.id}),e.preventDefault(),e.stopPropagation(),this.layoutEditorMetadataManager.highlightComponent(this.options?.typeMetadata.id)}hideOverlay(e){(0,c.EN)(this.parent)||(this._logger?.verbose("LayoutDesignerComponent: Hiding overlay for {@type}",{name:this.options?.typeMetadata.name,id:this.options?.typeMetadata.id}),e.preventDefault(),e.stopPropagation(),this.layoutEditorMetadataManager.cancelHighlightedComponent())}selectComponent(e){e.preventDefault(),e.stopPropagation(),this.options&&this.layoutEditorMetadataManager.selectComponent(this.options.typeMetadata.id)}unselectComponent(e){e.preventDefault(),e.stopPropagation(),this.layoutEditorMetadataManager.unselectComponent()}remove(){this.parent&&this.options&&this.parent.removeDescendant(this.options.typeMetadata.id)}_onInit(){var e,t=()=>super._onInit,n=this;return(e=function*(){if(yield t().call(n),n.options){if(n.parent?.options){var e,i=!1,o=!1;try{for(var r,a=function(e){var t,n,i,o=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,i=Symbol.iterator);o--;){if(n&&null!=(t=e[n]))return t.call(e);if(i&&null!=(t=e[i]))return new fe(t.call(e));n="@@asyncIterator",i="@@iterator"}throw new TypeError("Object is not async iterable")}(n.iteratorSvc.getChildrenIteratorFor(n.parent.options?.typeMetadata));i=!(r=yield a.next()).done;i=!1){const e=r.value;if(n.options.typeMetadata.id===e.metadata.id){n.index=e.index;break}}}catch(t){o=!0,e=t}finally{try{i&&null!=a.return&&(yield a.return())}finally{if(o)throw e}}}n.initSubscriptions.add(n.layoutEditorMetadataManager.selectedChange.subscribe((()=>n._changeDetector.detectChanges()))),n.initSubscriptions.add(n.layoutEditorMetadataManager.highlightedChange.subscribe((()=>n._changeDetector.detectChanges()))),n.editorMetadata=yield n.metadataExtractor.extractMetadata(n.options.typeMetadata),n.canDrop=n.editorMetadata?.canDropMetadata?.(n.options.typeMetadata.options)??!1,n.layoutEditorMetadataManager.registerLayoutDesignerComponent(n,n.options.typeMetadata.id,n.parent?.options?.typeMetadata.id)}},function(){var t=this,n=arguments;return new Promise((function(i,o){var r=e.apply(t,n);function a(e){ve(r,i,o,a,s,"next",e)}function s(e){ve(r,i,o,a,s,"throw",e)}a(void 0)}))})()}_onOptionsSet(){this.options&&(this.renderedType={...this.options.typeMetadata},this.horizontal=this.editorMetadata?.isHorizontalDrop?.(this.options.typeMetadata.options)??!1)}}Pe.ɵfac=function(e){return new(e||Pe)(u.Y(Y.s),u.Y(g.SB),u.Y(Q.z),u.Y(v.T),u.Y($.t),u.Y(W.$),u.Y(A.dB),u.Y(o.bZ,8),u.Y(Pe,12))},Pe.ɵcmp=r.Xp({type:Pe,selectors:[["layout-designer-component"]],viewQuery:function(e,t){if(1&e&&(m.Gf(De,7),m.Gf(be,7)),2&e){let e;m.iG(e=m.CR())&&(t.designerElement=e.first),m.iG(e=m.CR())&&(t.dndCoreDesigner=e.first)}},standalone:!0,features:[V.q,x.j],decls:9,vars:16,consts:[[1,"designer-overlay",3,"dndCoreDesigner","dropzoneElement","dragDisabled","dragSource","copyDesignerStyles","dropMetadata","mouseleave","mouseover","click","dblclick"],["layoutDesigner","","dndCore","dndCoreDesigner"],["designerMinWidth","",1,"designer-dropzone",3,"canDrop","horizontal","dropTarget","isDropZone"],["layoutDropzone",""],["class","mat-elevation-z4",3,"editorMetadata","layoutMetadata",4,"dndCorePreview"],[3,"layoutComponentRenderer","layoutComponentRendererDisableTransformer"],["renderer","layoutComponentRenderer"],[4,"ngIf"],[1,"mat-elevation-z4",3,"editorMetadata","layoutMetadata"],[1,"designer-overlay-border"],[1,"designer-overlay-layout",3,"layoutDesignerOverlayFor"],["class","designer-overlay-title","placement","TopStart",3,"positionTo",4,"bodyRender"],["placement","TopStart",1,"designer-overlay-title",3,"positionTo"],["class","designer-overlay-remove","placement","TopEnd",3,"positionTo","click",4,"bodyRender"],["placement","TopEnd",1,"designer-overlay-remove",3,"positionTo","click"],[1,"fas","fa-times"]],template:function(e,t){if(1&e&&(O.Tg(0,"div",0,1),U.N("dropMetadata",(function(e){return t.addDescendant(e)}))("mouseleave",(function(e){return t.hideOverlay(e)}))("mouseover",(function(e){return t.showOverlay(e)}))("click",(function(e){return t.selectComponent(e)}))("dblclick",(function(e){return t.unselectComponent(e)})),O.Tg(3,"div",2,3),j.Y(5,_e,1,2,"layout-editor-drag-preview",4),j.Y(6,Ce,0,0,"ng-template",5,6,q.W),j.Y(8,xe,5,2,"ng-container",7),O.qZ()()),2&e){const e=B.M(2),n=B.M(4);let i;L.Q("dndCoreDesigner",H.kE(12,Oe,t.renderedType,null==t.parent||null==t.parent.renderedType?null:t.parent.renderedType.id,t.index))("dropzoneElement",n)("dragDisabled",t.dragDisabled)("dragSource",e.drag)("copyDesignerStyles",t.renderedType),S.x(3),L.Q("canDrop",t.canDrop)("horizontal",null!==(i=null==t.parent?null:t.parent.horizontal)&&void 0!==i&&i)("dropTarget",e.dropzone)("isDropZone",t.canDrop),S.x(3),L.Q("layoutComponentRenderer",t.renderedType)("layoutComponentRendererDisableTransformer",!0),S.x(2),L.Q("ngIf",t.highlighted||t.selected)}},dependencies:[i.e,X.O,s,oe,z,I,y,D,l.i,_,E,h.c8,re.$d,re.Li,N.N,me,ye],styles:["[_nghost-%COMP%]\n{\n    display: contents;\n}\n\n.designer-overlay[_ngcontent-%COMP%]\n{\n    position: relative;\n    overflow: hidden;\n}\n\n.designer-dropzone[_ngcontent-%COMP%]\n{\n    overflow: hidden;\n    width: 100%;\n    height: 100%;\n}\n\n.designer-dropzone.drag-active[_ngcontent-%COMP%]\n{\n    margin: 8px;\n    border: solid 1px rgb(0, 0, 0, .3);\n}\n\n.designer-overlay-layout[_ngcontent-%COMP%], .designer-overlay-border[_ngcontent-%COMP%]\n{\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    pointer-events: none;\n}\n\n.designer-overlay-border[_ngcontent-%COMP%]\n{\n    border: 1px solid #009dd8;\n}\n\n.designer-overlay-title[_ngcontent-%COMP%]\n{\n    position: absolute;\n    background-color: #009dd8;\n    color: white;\n    font-weight: 500;\n    z-index: 500;\n    padding: 2px 6px;\n    pointer-events: none;\n}\n\n.designer-overlay-remove[_ngcontent-%COMP%]\n{\n    position: absolute;\n    border-radius: 50%;\n    background-color: #009dd8;\n    padding: 2px 7px;\n    opacity: .75;\n    color: #fff;\n    cursor: pointer;\n}"],changeDetection:0});const Se=Pe},53633:(e,t,n)=>{n.d(t,{h:()=>u});var i=n(46480),o=n(49891),r=n(79440),a=n(68961),s=n(4905),d=n(95176),l=n(13691),c=n(36973);function h(e,t,n,i,o,r,a){try{var s=e[r](a),d=s.value}catch(e){return void n(e)}s.done?t(d):Promise.resolve(d).then(i,o)}function p(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var r=e.apply(t,n);function a(e){h(r,i,o,a,s,"next",e)}function s(e){h(r,i,o,a,s,"throw",e)}a(void 0)}))}}class u{constructor(e,t,n,i){this._changeDetector=e,this._element=t,this._injector=n,this._logger=i,this._extensions=[],this._initialized=!1,this.destroyed=!1}get element(){return this._element}get extensionsOptions(){return this.options}ngOnDestroy(){if(!this.destroyed){this.destroyed=!0;for(const e of this._extensions)e.destroy();this._onDestroy()}}ngOnInit(){var e=this;return p((function*(){if(e._initialized)return;e._initialized=!0;const t=e.extensionsOptions;if(yield e._onInit(),yield e._onOptionsSet(),t)for(const t of e._extensions)yield t.initialize(e._injector,e.element,e)}))()}ngOnChanges(e){var t=this;return p((function*(){if((0,o.$)("options")in e){yield t._onOptionsSet();const e=t.extensionsOptions;if(e)for(const n of t._extensions)yield n.optionsChange(e);if(!t._initialized)return;yield t._onOptionsChange()}}))()}registerExtensions(e){this._extensions=e}invalidateVisuals(){this._changeDetector.detectChanges()}_onInit(){}_onOptionsChange(){}_onOptionsSet(){}_onDestroy(){}}u.ɵfac=function(e){return new(e||u)(r.Y(a.s),r.Y(s.SB),r.Y(d.z),r.Y(i.bZ,8))},u.ɵdir=l.lG({type:u,features:[c.T]})},90675:(e,t,n)=>{function i(e){Object.assign(e.target.style,{top:"0",left:"0",transform:`translate(${e.x}px, ${e.y}px)`})}n.d(t,{e:()=>i})}}]);
//# sourceMappingURL=5563.chunk.cd7e99acf985f57290c9.js.map
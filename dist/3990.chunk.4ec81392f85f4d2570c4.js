"use strict";(self.webpackChunkng_universal_demo=self.webpackChunkng_universal_demo||[]).push([[3990],{23990:(t,n,e)=>{e.r(n),e.d(n,{StateRelationsEditorMetadata:()=>L});var a=e(27052),o=e(71309),i=e(80890),s=e(93551),r=e(52580),u=e(60901),d=e(85478),c=e(72385),p=e(57466),l=e(58654),m=e(64297),f=e(84773),v=e(76405),h=e(41853),g=e(72891),y=e(43870),F=e(6845),O=e(66794),w=e(73301),M=e(6427),S=e(79440),b=e(68961),C=e(4905),k=e(77842),x=e(47098),_=e(82568),T=e(15686),D=e(47826),I=e(12311);function P(t,n,e,a,o,i,s){try{var r=t[i](s),u=r.value}catch(t){return void e(t)}r.done?n(u):Promise.resolve(u).then(a,o)}function z(t){return function(){var n=this,e=arguments;return new Promise((function(a,o){var i=t.apply(n,e);function s(t){P(i,a,o,s,r,"next",t)}function r(t){P(i,a,o,s,r,"throw",t)}s(void 0)}))}}function N(t,n){if(1&t){const t=f.E();v.Tg(0,"div",4),v._U(1,"relation-node-input",13),v.Tg(2,"div",7)(3,"div"),h._(4),v.qZ(),v.Tg(5,"button",14),g.N("click",(function(n){const e=y.CH(t).$implicit,a=F.o();return n.preventDefault(),n.stopPropagation(),y.Kt(a.rename(e))})),v._U(6,"span",15),v.qZ(),v.Tg(7,"button",14),g.N("click",(function(n){const e=y.CH(t).$implicit,a=F.o();return n.preventDefault(),n.stopPropagation(),y.Kt(a.showCodeEditor(e))})),v._U(8,"span",16),v.qZ(),v.Tg(9,"button",17),g.N("click",(function(n){const e=y.CH(t).$implicit,a=F.o();return n.preventDefault(),n.stopPropagation(),y.Kt(a.removeInputFunc(e))})),v._U(10,"span",18),v.qZ()()()}if(2&t){const t=n.$implicit,e=F.o();O.x(1),w.Q("parentCoordiantes",e.nodePosition)("zoomLevel",e.zoomLevel)("name",t)("parent",e),O.x(3),M.Oq(t)}}l.Mj.typescript.typescriptDefaults.addExtraLib("/**\n * Function that is used for handling input value\n * @param data - Data that are passed to this function for processing\n */\nexport type InputFunction<TData = unknown, TState = unknown> = (this: StatefullClass<TState>, data: TData) => void;\n\n/**\n * Definition of statefull class\n */\nexport interface StatefullClass<TState = unknown>\n{\n    /**\n     * Current state that is stored for this class\n     */\n    state: TState|undefined|null;\n}","file:///node_modules/@types/state/index.d.ts");class q extends s.M{get inputFunctions(){var t;return this.metadata?((t=this.metadata).relationsOptions??(t.relationsOptions={inputFunctions:{}}),Object.keys(this.metadata.relationsOptions.inputFunctions??{})):[]}constructor(t,n,e){super(t,n),this.dialog=e}addInputFunc(){var t=this;return z((function*(){var n,e;const a={id:(0,p.Ox)(12),code:null},o={name:`inputFunc${t.inputFunctions.length+1}`,defaultValue:null,noDefaultValue:!0,skipInit:!1};if(yield t.configureEndpoint(o)){if(!t.metadata?.relationsOptions||!t.metadata.nodeMetadata)return;(n=t.metadata.relationsOptions).inputFunctions??(n.inputFunctions={}),t.metadata.relationsOptions.inputFunctions[o.name]=a,(e=t.metadata.nodeMetadata).options??(e.options={contents:{}}),t.metadata.nodeMetadata.options.contents&&(t.metadata.nodeMetadata.options.contents[o.name]=""),t.history.getNewState()}}))()}removeInputFunc(t){this.metadata?.relationsOptions?.inputFunctions&&t in this.metadata.relationsOptions.inputFunctions&&(delete this.metadata.relationsOptions.inputFunctions[t],this.metadata.nodeMetadata?.options?.contents&&delete this.metadata.nodeMetadata.options.contents[t],this.history.getNewState())}rename(t){var n=this;return z((function*(){yield n.configureEndpoint({name:t,defaultValue:null,noDefaultValue:!0,skipInit:!1}),n.changeDetector.detectChanges()}))()}configureEndpoint(t){var n=this;return z((function*(){const e=JSON.parse(JSON.stringify(t)),a=yield(0,m.n)(n.dialog.open(c.b,{title:"configure input function",width:"60vw",data:e}).afterClosed());return a&&(n.metadata?.relationsOptions?.inputFunctions?.[t.name]&&(""===n.metadata.nodeMetadata?.options?.contents?.[t.name]||n.metadata.nodeMetadata?.options?.contents?.[t.name])?(n.metadata.relationsOptions.inputFunctions[e.name]=n.metadata.relationsOptions.inputFunctions[t.name],delete n.metadata.relationsOptions.inputFunctions[t.name],n.metadata.nodeMetadata.options.contents[e.name]=n.metadata.nodeMetadata.options.contents[t.name],delete n.metadata.nodeMetadata.options.contents[t.name],n.history.getNewState()):t.name=e.name),a??!1}))()}showCodeEditor(t){var n=this;return z((function*(){var e,a,s;const r=yield(0,m.n)(n.dialog.open(o.I,{title:"Code editor",width:"75vw",height:"75vh",data:{content:n.metadata?.nodeMetadata?.options?.contents?.[t]??"",languageModel:(0,i.A)("import {InputFunction} from 'state';\n\n/**\n * Input function that handles incoming data and can change state\n */\nconst inputFunc: InputFunction<any, any> = function(_data)\n{\n};\n\nexport default inputFunc;\n\n")}}).afterClosed());n.metadata?.relationsOptions&&r&&n.metadata.nodeMetadata&&((e=n.metadata.relationsOptions).inputFunctions??(e.inputFunctions={}),(a=n.metadata.nodeMetadata).options??(a.options={contents:{}}),(s=n.metadata.nodeMetadata.options).contents??(s.contents={}),n.metadata.relationsOptions.inputFunctions[t].code=r.code,n.metadata.nodeMetadata.options.contents[t]=r.content,n.history.getNewState())}))()}}q.ɵfac=function(t){return new(t||q)(S.Y(b.s),S.Y(C.SB),S.Y(D.J))},q.ɵcmp=k.Xp({type:q,selectors:[["state-node"]],standalone:!0,features:[x.q,_.j],decls:17,vars:9,consts:[["name","state",3,"parent","destroySubject"],[1,"node-content"],[1,"inputs-outputs"],[1,"inputs"],[1,"input"],["name","initState",3,"parentCoordiantes","zoomLevel","parent"],["class","input",4,"ngFor","ngForOf"],[1,"dynamic-flex-row"],["type","button",1,"dynamic-btn-icon","dynamic-margin-left-extra-small",3,"click"],[1,"fas","fa-plus"],[1,"outputs"],[1,"output"],["name","state",3,"parentCoordiantes","zoomLevel","parent"],[3,"parentCoordiantes","zoomLevel","name","parent"],["type","button",1,"dynamic-btn-icon","dynamic-margin-horizontal-extra-small",3,"click"],[1,"fas","fa-pen"],[1,"fas","fa-code"],["type","button",1,"dynamic-btn-icon",3,"click"],[1,"fas","fa-times"]],template:function(t,n){1&t&&(v._U(0,"relations-node-header",0),v.Tg(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),v._U(5,"relation-node-input",5),v.Tg(6,"div"),h._(7,"init state"),v.qZ()(),T.Y(8,N,11,5,"div",6),v.Tg(9,"div",7)(10,"button",8),g.N("click",(function(t){return t.preventDefault(),t.stopPropagation(),n.addInputFunc()})),v._U(11,"span",9),v.qZ()()(),v.Tg(12,"div",10)(13,"div",11)(14,"div"),h._(15,"state"),v.qZ(),v._U(16,"relation-node-output",12),v.qZ()()()()),2&t&&(w.Q("parent",n)("destroySubject",n.destroySubject),O.x(5),w.Q("parentCoordiantes",n.nodePosition)("zoomLevel",n.zoomLevel)("parent",n),O.x(3),w.Q("ngForOf",n.inputFunctions),O.x(8),w.Q("parentCoordiantes",n.nodePosition)("zoomLevel",n.zoomLevel)("parent",n))},dependencies:[r.e,u.P,d.n,a.e,I.sg],encapsulation:2,changeDetection:0});class L{constructor(){this.metaInfo={name:"State",description:"Node that allows storing and manipulation with statefull object",group:"Data"},this.nodeDefinition=q,Object.freeze(this)}}},80890:(t,n,e)=>{e.d(n,{A:()=>s});var a=e(58654),o=e(53136);function i(t,n,e,a,o,i,s){try{var r=t[i](s),u=r.value}catch(t){return void e(t)}r.done?n(u):Promise.resolve(u).then(a,o)}const s=t=>new o.y("typescript","ts",function(){var t,n=(t=function*(t){const n=t.getModel()?.uri;if(!n)return"";const e=yield a.Mj.typescript.getTypeScriptWorker(),o=yield e(n);return(yield o.getEmitOutput(n.toString())).outputFiles[0].text},function(){var n=this,e=arguments;return new Promise((function(a,o){var s=t.apply(n,e);function r(t){i(s,a,o,r,u,"next",t)}function u(t){i(s,a,o,r,u,"throw",t)}r(void 0)}))});return function(t){return n.apply(this,arguments)}}(),t)}}]);
//# sourceMappingURL=3990.chunk.4ec81392f85f4d2570c4.js.map
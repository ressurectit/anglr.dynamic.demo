"use strict";(self.webpackChunkng_universal_demo=self.webpackChunkng_universal_demo||[]).push([[574],{60574:(t,e,a)=>{a.r(e),a.d(e,{RelationsLayoutFormModule:()=>Vt});var r=a(14392),o=a(27052),n=a(48659),i=a(88382),s=a(97212),l=a(89001),u=a(22804),c=a(38707),d=a(35648),p=a(8477),m=a(66888),f=a(94761),g=a(89651),v=a(97149),h=a(40921),_=a(56454),y=a(17505),b=a(44055),w=a(56179),C=a(99043),x=a(57489),M=a(30688),F=a(45529),O=a(57466),R=a(27049),N=a(89952),k=a(77653),T=a(79440),Y=a(77842),L=a(73379),Q=a(76405),j=a(41853),D=a(72891),I=a(66794),U=a(73301),q=a(84967),G=a(80239),P=a(41348),A=a(80285),S=a(71298);let Z=class{get emptyMetadata(){return{id:`stackPanel-${(0,O.Ox)(10)}`,displayName:"root",package:"basic-components",name:"stackPanel",options:{children:[]}}}constructor(t,e){this._store=t,this.history=e,this._metadata=null}_getMetadata(t){return{layout:t}}};Z.ɵfac=function(t){return new(t||Z)(T.Y(N.U),T.Y(g.dB))},Z.ɵcmp=Y.Xp({type:Z,selectors:[["form-layout-editor-view"]],features:[L._([_.z,{provide:p.qO,useFactory:t=>new u.I((e=>t.getData(e)?.layout)),deps:[N.U]},(0,v._)(),(0,h.rj)(),(0,F.m_)(),(0,M.iS)(),(0,w.vQ)(),(0,C.gJ)(),(0,x.hd)(),{provide:y.L,useClass:k.y}])],decls:9,vars:5,consts:[[1,"flex-row"],["type","button","goBack","",1,"btn","btn-primary","margin-right-extra-small"],["routePath","/relationsLayoutForm/layout",3,"store","getMetadataCallback","history","metadataChange"],[3,"copyClick"],[1,"margin-horizontal-small"],[1,"flex-1",3,"metadata"]],template:function(t,e){1&t&&(Q.Tg(0,"div",0)(1,"button",1)(2,"span"),j._(3,"go back"),Q.qZ()(),Q.Tg(4,"load-save-new",2),D.N("metadataChange",(function(t){let a;return e._metadata=null!==(a=null==t?null:t.layout)&&void 0!==a?a:e.emptyMetadata})),Q.qZ(),Q.Tg(5,"debug-data",3)(6,"div",4),j._(7,"metadata"),Q.qZ()()(),Q._U(8,"layout-editor",5)),2&t&&(I.x(4),U.Q("store",e._store)("getMetadataCallback",e._getMetadata)("history",e.history),I.x(1),U.Q("copyClick",e._metadata),I.x(3),U.Q("metadata",e._metadata))},dependencies:[q.v,P.Z,A.v,G.o,S.Q],encapsulation:2,changeDetection:0}),(0,r.gn)([R.r,(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",[Object]),(0,r.w6)("design:returntype",Object)],Z.prototype,"_getMetadata",null),Z=(0,r.gn)([(0,f.N)({path:"layout"}),(0,f.N)({path:"layout/:id"}),(0,r.w6)("design:paramtypes",[N.U,b.Y])],Z);var z=a(95176),V=a(68961),E=a(10618),B=a(15467),J=a(70625),$=a(43939),H=a(79898),K=a(17777),X=a(66398),W=a(38937),tt=a(11776),et=a(38327),at=a(26938);function rt(t,e,a,r,o,n,i){try{var s=t[n](i),l=s.value}catch(t){return void a(t)}s.done?e(l):Promise.resolve(l).then(r,o)}function ot(t){function e(t){if(Object(t)!==t)return Promise.reject(new TypeError(t+" is not an object."));var e=t.done;return Promise.resolve(t.value).then((function(t){return{value:t,done:e}}))}return ot=function(t){this.s=t,this.n=t.next},ot.prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(t){var a=this.s.return;return void 0===a?Promise.resolve({value:t,done:!0}):e(a.apply(this.s,arguments))},throw:function(t){var a=this.s.return;return void 0===a?Promise.reject(t):e(a.apply(this.s,arguments))}},new ot(t)}class nt{constructor(t){this._iteratorsSvc=t}build(t){var e,a=this;return(e=function*(){const e=new K.cw({});let r=e;var o,n=!1,i=!1;try{for(var s,l=function(t){var e,a,r,o=2;for("undefined"!=typeof Symbol&&(a=Symbol.asyncIterator,r=Symbol.iterator);o--;){if(a&&null!=(e=t[a]))return e.call(t);if(r&&null!=(e=t[r]))return new ot(e.call(t));a="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}(a._iteratorsSvc.getIteratorFor(t));n=!(s=yield l.next()).done;n=!1){const t=s.value,e=a._getControlName(t.metadata);if(e){const o=a._getControlForMetadata(t.metadata);a._getActiveGroup(t.parent,r).addControl(e,o),o instanceof K.cw&&(r=o)}}}catch(t){i=!0,o=t}finally{try{n&&null!=l.return&&(yield l.return())}finally{if(i)throw o}}return e},function(){var t=this,a=arguments;return new Promise((function(r,o){var n=e.apply(t,a);function i(t){rt(n,r,o,i,s,"next",t)}function s(t){rt(n,r,o,i,s,"throw",t)}i(void 0)}))})()}_getActiveGroup(t,e){if(!e.parent||!t)return e;const a=this._getControlName(t.metadata);return a?e.parent.get(a)?e:this._getActiveGroup(t,e.parent):t.parent?this._getActiveGroup(t.parent,e):this._getActiveGroup(t.parent,e.root)}_getControlName(t){return t?t.options?.controlName:null}_getControlForMetadata(t){switch(t?.options?.controlType){case W.Z.FormArray:return new X.Oe([]);case W.Z.FormGroup:return new K.cw({});default:return new J.NI}}}nt.ɵfac=function(t){return new(t||nt)(tt.LF(at.$))},nt.ɵprov=et.Yz({token:nt,factory:nt.ɵfac});var it=a(85902),st=a(79842),lt=a(75990),ut=a(84773),ct=a(43870),dt=a(6845),pt=a(4477),mt=a(15686),ft=a(94727),gt=a(6427),vt=a(32361),ht=a(12311),_t=a(21651),yt=a(58323),bt=a(77470),wt=a(27635),Ct=a(86170),xt=a(4489),Mt=a(81287),Ft=a(31686),Ot=a(60405);function Rt(t,e,a,r,o,n,i){try{var s=t[n](i),l=s.value}catch(t){return void a(t)}s.done?e(l):Promise.resolve(l).then(r,o)}function Nt(t,e){if(1&t&&Q._U(0,"ng-option",7),2&t){const t=e.$implicit;U.Q("value",t)("text",t)}}function kt(t,e){if(1&t){const t=ut.E();Q.Tg(0,"form",8),D.N("ngSubmit",(function(){ct.CH(t);const e=dt.o();return ct.Kt(e._submit())})),Q.Tg(1,"div",9)(2,"div",10),pt.Gk(3,11),Q.qZ()(),Q.Tg(4,"button",12),j._(5,"Submit"),Q.qZ()()}if(2&t){const t=dt.o();U.Q("formGroup",t._formGroup),I.x(3),U.Q("layoutComponentRenderer",t._metadata)("layoutComponentRendererInjector",t._formInjector)}}const Tt=function(t){return["/relationsLayoutForm/layout",t]},Yt=function(t){return["/relationsLayoutForm/relations",t]};let Lt=class{constructor(t,e,a,r,o,n,i){this._relationsManager=t,this._store=e,this._router=a,this._route=r,this._injector=o,this._formComponentControlBuilder=n,this._changeDetector=i,this.selectedMetadata=null,this._available=new J.NI(""),this._metadata=null,this._availableNames=[]}ngOnInit(){var t=this;this._availableNames=this._store.getStored(),this._route.params.subscribe(function(){var e,a=(e=function*({id:e}){if(e){t._available.setValue(e);const a=t.selectedMetadata=t._store.getData(e);t._metadata=a?.layout,t._relationsManager.setRelations(a.relations??[]),t._formGroup=yield t._formComponentControlBuilder.build(t._metadata),t._formInjector=z.z.create({parent:t._injector,providers:[{provide:H.O,useValue:t._formGroup}]}),t._changeDetector.detectChanges()}else t.selectedMetadata=null,t._relationsManager.setRelations([]);t._available.valueChanges.subscribe((e=>{t._router.navigate(["/relationsLayoutForm","form-preview",e],{skipLocationChange:!1,replaceUrl:!0})}))},function(){var t=this,a=arguments;return new Promise((function(r,o){var n=e.apply(t,a);function i(t){Rt(n,r,o,i,s,"next",t)}function s(t){Rt(n,r,o,i,s,"throw",t)}i(void 0)}))});return function(t){return a.apply(this,arguments)}}())}ngOnDestroy(){}_submit(){console.log(this._formGroup.value)}};var Qt,jt;Lt.ɵfac=function(t){return new(t||Lt)(T.Y(lt.N),T.Y(N.U),T.Y(E.F0),T.Y(B.gz),T.Y(z.z),T.Y(nt),T.Y(V.s))},Lt.ɵcmp=Y.Xp({type:Lt,selectors:[["form-preview-view"]],features:[L._([nt,at.$,it.T,(0,st.AL)(),(0,h.SH)(),(0,F.bW)(),(0,M.Hh)()])],decls:11,vars:11,consts:[[1,"flex-row"],[1,"margin-horizontal-small",3,"routerLink"],[1,"flex-1",3,"formControl"],[3,"value","text",4,"ngFor","ngForOf"],[3,"copyClick"],[1,"margin-horizontal-small"],[3,"formGroup","ngSubmit",4,"ngIf"],[3,"value","text"],[3,"formGroup","ngSubmit"],[1,"flex-row","margin-top-big","flex-1"],[1,"flex-1","overflow-vertical-scroll","thin-scrollbar"],[3,"layoutComponentRenderer","layoutComponentRendererInjector"],["type","submit"]],template:function(t,e){1&t&&(Q.Tg(0,"div",0)(1,"a",1),j._(2,"layout"),Q.qZ(),Q.Tg(3,"a",1),j._(4,"relations"),Q.qZ(),Q.Tg(5,"ng-select",2),mt.Y(6,Nt,1,2,"ng-option",3),Q.qZ(),Q.Tg(7,"debug-data",4)(8,"div",5),j._(9),Q.qZ()()(),mt.Y(10,kt,6,3,"form",6)),2&t&&(I.x(1),U.Q("routerLink",ft.VK(7,Tt,e._available.value)),I.x(2),U.Q("routerLink",ft.VK(9,Yt,e._available.value)),I.x(2),U.Q("formControl",e._available),I.x(1),U.Q("ngForOf",e._availableNames),I.x(1),U.Q("copyClick",e.selectedMetadata),I.x(2),gt.Oq(e._available.value),I.x(1),U.Q("ngIf",e._formGroup))},dependencies:[ht.sg,_t.O,yt._,bt.JJ,bt.JL,wt.oH,Ct.s,xt.x,Mt.w,Ft.v,Ot.i,vt.r,A.v,G.o],encapsulation:2,changeDetection:0}),Lt=(0,r.gn)([("",Qt="form-preview",function(t){const e=t;if((0,$.fp)(e.routeValues)&&(0,$.fp)(Qt))return console.warn("Missing 'ComponentRoute' or wrong order of decorators 'ComponentRoute' and 'ComponentRedirectRoute'!"),t;if((0,$.fp)(Qt)&&(0,$.EN)(e.routeValues)&&e.routeValues.length>1)return console.warn("Multiple routes defined. Unable to set proper redirect!"),t;const a=t;return(0,$.fp)(a.redirectRouteValues)&&Object.defineProperty(t,"redirectRouteValues",{enumerable:!0,configurable:!1,writable:!1,value:[]}),(0,$.fp)(jt)&&(jt=!0),(0,$.fp)(Qt)&&(Qt=e.routeValues[0].path),a.redirectRouteValues.push({path:"",redirectTo:Qt,pathMatch:jt?"full":"prefix"}),t}),(0,f.N)({path:"form-preview"}),(0,f.N)({path:"form-preview/:id"}),(0,r.w6)("design:paramtypes",[lt.N,N.U,E.F0,B.gz,z.z,nt,V.s])],Lt);var Dt=a(91861),It=a(80734),Ut=a(20809),qt=a(85638),Gt=a(31166),Pt=a(71674);let At=class{get emptyMetadata(){return[]}constructor(t,e,a){this._store=t,this.history=e,this._layoutManager=a,this._metadata=[]}_getMetadata(t){return{relations:t}}_loadDemo(){this._metadata=qt.F.demoRelationsComplexRelations}_loadRestDemo(){this._metadata=qt.F.complexDemoRestRelations}_loadFullDemo(){this._metadata=qt.F.complexDemoFullRelations}setMetadata(t){this._metadata=t?.relations??this.emptyMetadata,this._layoutManager.setLayout(t?.layout)}};At.ɵfac=function(t){return new(t||At)(T.Y(N.U),T.Y(Dt.nR),T.Y(It.n))},At.ɵcmp=Y.Xp({type:At,selectors:[["form-relations-editor-view"]],features:[L._([_.z,{provide:Ut.te,useFactory:t=>new u.I((e=>t.getData(e)?.relations)),deps:[N.U]},(0,st.$R)(),(0,h.qm)(),(0,F.Od)(),(0,x.vu)(),(0,C.Rn)(),(0,w.El)(),(0,M.pS)(),{provide:y.L,useClass:Gt.d}])],decls:6,vars:5,consts:[[1,"flex-row"],["type","button","goBack","",1,"btn","btn-primary","margin-right-extra-small"],["routePath","/relationsLayoutForm/relations",3,"store","getMetadataCallback","layoutControls","history","metadataChange"],[1,"flex-1",3,"metadata"]],template:function(t,e){1&t&&(Q.Tg(0,"div",0)(1,"button",1)(2,"span"),j._(3,"go back"),Q.qZ()(),Q.Tg(4,"load-save-new",2),D.N("metadataChange",(function(t){return e.setMetadata(t)})),Q.qZ()(),Q._U(5,"relations-editor",3)),2&t&&(I.x(4),U.Q("store",e._store)("getMetadataCallback",e._getMetadata)("layoutControls",!1)("history",e.history),I.x(1),U.Q("metadata",e._metadata))},dependencies:[q.v,Pt.Y,S.Q],encapsulation:2,changeDetection:0}),(0,r.gn)([R.r,(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",[Array]),(0,r.w6)("design:returntype",Object)],At.prototype,"_getMetadata",null),At=(0,r.gn)([(0,f.N)({path:"relations"}),(0,f.N)({path:"relations/:id"}),(0,r.w6)("design:paramtypes",[N.U,b.Y,It.n])],At);const St=[Lt,Z,At];var Zt=a(53245),zt=a(18567);let Vt=class{};Vt.ɵfac=function(t){return new(t||Vt)},Vt.ɵmod=Y.oA({type:Vt}),Vt.ɵinj=et.cJ({providers:[{provide:p.qO,useFactory:t=>new u.I((e=>t.getData(e))),deps:[N.U]},(0,Zt.Y)("LAYOUT_RELATIONS_FORM_DATA")],imports:[o.e,n.U,d.A,i.Bz,s.p,m.W,c.s,zt.Qw]}),Vt=(0,r.gn)([(0,l.P)(St)],Vt)},79898:(t,e,a)=>{a.d(e,{O:()=>r});const r=new(a(40296).O)("FORM_COMPONENT_CONTROL")}}]);
//# sourceMappingURL=574.chunk.6c97fd194d67b2859c64.js.map
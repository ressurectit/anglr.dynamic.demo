"use strict";(self.webpackChunkng_universal_demo=self.webpackChunkng_universal_demo||[]).push([[4253],{84253:(t,e,a)=>{a.r(e),a.d(e,{RelationsLayoutFormModule:()=>St});var r=a(97881),o=a(58853),n=a(14829),i=a(54004),s=a(78561),l=a(21455),u=a(91940),c=a(59098),d=a(41842),p=a(19555),m=a(63086),f=a(83762),g=a(35516),h=a(42842),v=a(35891),_=a(5290),y=a(78344),b=a(37185),w=a(42411),C=a(61487),x=a(46483),M=a(12919),F=a(73943),O=a(27103),R=a(35981),N=a(80033),k=a(85410),T=a(80354),Y=a(88809),L=a(13315),Q=a(43335),j=a(57284),D=a(10065),I=a(38561),U=a(17261),q=a(18910),G=a(17873),P=a(44275);let z=class{get emptyMetadata(){return{id:`stackPanel-${(0,F.Ox)(10)}`,displayName:"root",package:"basic-components",name:"stackPanel",options:{children:[]}}}constructor(t,e){this._store=t,this.history=e,this._metadata=null}_getMetadata(t){return{layout:t}}};z.ɵfac=function(t){return new(t||z)(N.Y(O.U),N.Y(f.dB))},z.ɵcmp=k.Xp({type:z,selectors:[["form-layout-editor-view"]],features:[T._([v.z,{provide:d.qO,useFactory:t=>new l.I((e=>t.getData(e)?.layout)),deps:[O.U]},(0,g._T)(),(0,h.rj)(),(0,M.m_)(),(0,x.iS)(),(0,b.vQ)(),(0,w.gJ)(),(0,C.hd)(),{provide:_.L,useClass:R.y}])],decls:9,vars:5,consts:[[1,"flex-row"],["type","button","goBack","",1,"btn","btn-primary","margin-right-extra-small"],["routePath","/relationsLayoutForm/layout",3,"store","getMetadataCallback","history","metadataChange"],[3,"copyClick"],[1,"margin-horizontal-small"],[1,"flex-1",3,"metadata"]],template:function(t,e){1&t&&(Y.Tg(0,"div",0)(1,"button",1)(2,"span"),L._(3,"go back"),Y.qZ()(),Y.Tg(4,"load-save-new",2),Q.N("metadataChange",(function(t){let a;return e._metadata=null!==(a=null==t?null:t.layout)&&void 0!==a?a:e.emptyMetadata})),Y.qZ(),Y.Tg(5,"debug-data",3)(6,"div",4),L._(7,"metadata"),Y.qZ()()(),Y._U(8,"layout-editor",5)),2&t&&(j.x(4),D.Q("store",e._store)("getMetadataCallback",e._getMetadata)("history",e.history),j.x(1),D.Q("copyClick",e._metadata),j.x(3),D.Q("metadata",e._metadata))},dependencies:[I.z,q.Z,G.v,U.o,P.Q],encapsulation:2,changeDetection:0}),(0,r.gn)([F.ru,(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",[Object]),(0,r.w6)("design:returntype",Object)],z.prototype,"_getMetadata",null),z=(0,r.gn)([(0,m.N)({path:"layout"}),(0,m.N)({path:"layout/:id"}),(0,r.w6)("design:paramtypes",[O.U,y.Y])],z);var A=a(31530),S=a(49276),Z=a(1737),V=a(34326),E=a(58418),B=a(35478),J=a(64386),$=a(93099),H=a(95181),K=a(32779),X=a(85086),W=a(16301);function tt(t,e,a,r,o,n,i){try{var s=t[n](i),l=s.value}catch(t){return void a(t)}s.done?e(l):Promise.resolve(l).then(r,o)}function et(t){function e(t){if(Object(t)!==t)return Promise.reject(new TypeError(t+" is not an object."));var e=t.done;return Promise.resolve(t.value).then((function(t){return{value:t,done:e}}))}return et=function(t){this.s=t,this.n=t.next},et.prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(t){var a=this.s.return;return void 0===a?Promise.resolve({value:t,done:!0}):e(a.apply(this.s,arguments))},throw:function(t){var a=this.s.return;return void 0===a?Promise.reject(t):e(a.apply(this.s,arguments))}},new et(t)}class at{constructor(t){this._iteratorsSvc=t}build(t){var e,a=this;return(e=function*(){const e=new J.cw({});let r=e;var o,n=!1,i=!1;try{for(var s,l=function(t){var e,a,r,o=2;for("undefined"!=typeof Symbol&&(a=Symbol.asyncIterator,r=Symbol.iterator);o--;){if(a&&null!=(e=t[a]))return e.call(t);if(r&&null!=(e=t[r]))return new et(e.call(t));a="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}(a._iteratorsSvc.getIteratorFor(t));n=!(s=yield l.next()).done;n=!1){const t=s.value;{const e=a._getControlName(t.metadata);if(e){const o=a._getControlForMetadata(t.metadata);a._getActiveGroup(t.parent,r).addControl(e,o),o instanceof J.cw&&(r=o)}}}}catch(t){i=!0,o=t}finally{try{n&&null!=l.return&&(yield l.return())}finally{if(i)throw o}}return e},function(){var t=this,a=arguments;return new Promise((function(r,o){var n=e.apply(t,a);function i(t){tt(n,r,o,i,s,"next",t)}function s(t){tt(n,r,o,i,s,"throw",t)}i(void 0)}))})()}_getActiveGroup(t,e){if(!e.parent||!t)return e;const a=this._getControlName(t.metadata);return a?e.parent.get(a)?e:this._getActiveGroup(t,e.parent):t.parent?this._getActiveGroup(t.parent,e):this._getActiveGroup(t.parent,e.root)}_getControlName(t){return t?t.options?.controlName:null}_getControlForMetadata(t){switch(t?.options?.controlType){case H.Z.FormArray:return new $.Oe([]);case H.Z.FormGroup:return new J.cw({});default:return new E.NI}}}at.ɵfac=function(t){return new(t||at)(K.LF(W.$))},at.ɵprov=X.Yz({token:at,factory:at.ɵfac});var rt=a(87003),ot=a(65947),nt=a(54619),it=a(52622),st=a(88731),lt=a(32603),ut=a(67942),ct=a(46430),dt=a(66898),pt=a(13757),mt=a(40551),ft=a(4539),gt=a(22517),ht=a(70764),vt=a(48074),_t=a(24900),yt=a(64909),bt=a(72620),wt=a(27669),Ct=a(36391),xt=a(27398);function Mt(t,e,a,r,o,n,i){try{var s=t[n](i),l=s.value}catch(t){return void a(t)}s.done?e(l):Promise.resolve(l).then(r,o)}function Ft(t,e){if(1&t&&Y._U(0,"ng-option",7),2&t){const t=e.$implicit;D.Q("value",t)("text",t)}}function Ot(t,e){1&t&&it.Gk(0)}function Rt(t,e){if(1&t){const t=st.E();Y.Tg(0,"form",8),Q.N("ngSubmit",(function(){lt.CH(t);const e=ut.o();return lt.Kt(e._submit())})),Y.Tg(1,"div",9)(2,"div",10),ct.Y(3,Ot,1,0,"ng-container",11),Y.qZ()(),Y.Tg(4,"button",12),L._(5,"Submit"),Y.qZ()()}if(2&t){const t=ut.o();D.Q("formGroup",t._formGroup),j.x(3),D.Q("layoutComponentRenderer",t._metadata)("layoutComponentRendererInjector",t._formInjector)}}const Nt=t=>["/relationsLayoutForm/layout",t],kt=t=>["/relationsLayoutForm/relations",t];let Tt=class{constructor(t,e,a,r,o,n,i){this._relationsManager=t,this._store=e,this._router=a,this._route=r,this._injector=o,this._formComponentControlBuilder=n,this._changeDetector=i,this.selectedMetadata=null,this._available=new E.NI(""),this._metadata=null,this._availableNames=[]}ngOnInit(){var t=this;this._availableNames=this._store.getStored(),this._route.params.subscribe(function(){var e,a=(e=function*({id:e}){if(e){t._available.setValue(e);const a=t.selectedMetadata=t._store.getData(e);t._metadata=a?.layout,t._relationsManager.setRelations(a.relations??[]),t._formGroup=yield t._formComponentControlBuilder.build(t._metadata),t._formInjector=A.z.create({parent:t._injector,providers:[{provide:B.O,useValue:t._formGroup}]}),t._changeDetector.detectChanges()}else t.selectedMetadata=null,t._relationsManager.setRelations([]);t._available.valueChanges.subscribe((e=>{t._router.navigate(["/relationsLayoutForm","form-preview",e],{skipLocationChange:!1,replaceUrl:!0})}))},function(){var t=this,a=arguments;return new Promise((function(r,o){var n=e.apply(t,a);function i(t){Mt(n,r,o,i,s,"next",t)}function s(t){Mt(n,r,o,i,s,"throw",t)}i(void 0)}))});return function(t){return a.apply(this,arguments)}}())}ngOnDestroy(){}_submit(){console.log(this._formGroup.value)}};var Yt,Lt;Tt.ɵfac=function(t){return new(t||Tt)(N.Y(nt.N),N.Y(O.U),N.Y(Z.F0),N.Y(V.gz),N.Y(A.z),N.Y(at),N.Y(S.s))},Tt.ɵcmp=k.Xp({type:Tt,selectors:[["form-preview-view"]],features:[T._([at,W.$,rt.T,(0,ot.AL)(),(0,h.SH)(),(0,M.bW)(),(0,x.Hh)()])],decls:11,vars:11,consts:[[1,"flex-row"],[1,"margin-horizontal-small",3,"routerLink"],[1,"flex-1",3,"formControl"],[3,"value","text",4,"ngFor","ngForOf"],[3,"copyClick"],[1,"margin-horizontal-small"],[3,"formGroup","ngSubmit",4,"ngIf"],[3,"value","text"],[3,"formGroup","ngSubmit"],[1,"flex-row","margin-top-big","flex-1"],[1,"flex-1","overflow-vertical-scroll","thin-scrollbar"],[4,"layoutComponentRenderer","layoutComponentRendererInjector"],["type","submit"]],template:function(t,e){1&t&&(Y.Tg(0,"div",0)(1,"a",1),L._(2,"layout"),Y.qZ(),Y.Tg(3,"a",1),L._(4,"relations"),Y.qZ(),Y.Tg(5,"ng-select",2),ct.Y(6,Ft,1,2,"ng-option",3),Y.qZ(),Y.Tg(7,"debug-data",4)(8,"div",5),L._(9),Y.qZ()()(),ct.Y(10,Rt,6,3,"form",6)),2&t&&(j.x(1),D.Q("routerLink",dt.VK(7,Nt,e._available.value)),j.x(2),D.Q("routerLink",dt.VK(9,kt,e._available.value)),j.x(2),D.Q("formControl",e._available),j.x(1),D.Q("ngForOf",e._availableNames),j.x(1),D.Q("copyClick",e.selectedMetadata),j.x(2),pt.Oq(e._available.value),j.x(1),D.Q("ngIf",e._formGroup))},dependencies:[ft.sg,gt.O,ht._,vt.JJ,vt.JL,_t.o,yt.s,bt.x,wt.w,Ct.v,xt.i,mt.r,G.v,U.o],encapsulation:2,changeDetection:0}),Tt=(0,r.gn)([("",Yt="form-preview",function(t){const e=t;if((0,F.fp)(e.routeValues)&&(0,F.fp)(Yt))return console.warn("Missing 'ComponentRoute' or wrong order of decorators 'ComponentRoute' and 'ComponentRedirectRoute'!"),t;if((0,F.fp)(Yt)&&(0,F.EN)(e.routeValues)&&e.routeValues.length>1)return console.warn("Multiple routes defined. Unable to set proper redirect!"),t;const a=t;return(0,F.fp)(a.redirectRouteValues)&&Object.defineProperty(t,"redirectRouteValues",{enumerable:!0,configurable:!1,writable:!1,value:[]}),(0,F.fp)(Lt)&&(Lt=!0),(0,F.fp)(Yt)&&(Yt=e.routeValues[0].path),a.redirectRouteValues.push({path:"",redirectTo:Yt,pathMatch:Lt?"full":"prefix"}),t}),(0,m.N)({path:"form-preview"}),(0,m.N)({path:"form-preview/:id"}),(0,r.w6)("design:paramtypes",[nt.N,O.U,Z.F0,V.gz,A.z,at,S.s])],Tt);var Qt=a(66201),jt=a(76498),Dt=a(93463),It=a(75637),Ut=a(20560),qt=a(33108);let Gt=class{get emptyMetadata(){return[]}constructor(t,e,a){this._store=t,this.history=e,this._layoutManager=a,this._metadata=[]}_getMetadata(t){return{relations:t}}_loadDemo(){this._metadata=It.F.demoRelationsComplexRelations}_loadRestDemo(){this._metadata=It.F.complexDemoRestRelations}_loadFullDemo(){this._metadata=It.F.complexDemoFullRelations}setMetadata(t){this._metadata=t?.relations??this.emptyMetadata,this._layoutManager.setLayout(t?.layout)}};Gt.ɵfac=function(t){return new(t||Gt)(N.Y(O.U),N.Y(Qt.nR),N.Y(jt.n))},Gt.ɵcmp=k.Xp({type:Gt,selectors:[["form-relations-editor-view"]],features:[T._([v.z,{provide:Dt.te,useFactory:t=>new l.I((e=>t.getData(e)?.relations)),deps:[O.U]},(0,ot.$R)(),(0,h.qm)(),(0,M.Od)(),(0,C.vu)(),(0,w.Rn)(),(0,b.El)(),(0,x.pS)(),{provide:_.L,useClass:Ut.d}])],decls:6,vars:5,consts:[[1,"flex-row"],["type","button","goBack","",1,"btn","btn-primary","margin-right-extra-small"],["routePath","/relationsLayoutForm/relations",3,"store","getMetadataCallback","layoutControls","history","metadataChange"],[1,"flex-1",3,"metadata"]],template:function(t,e){1&t&&(Y.Tg(0,"div",0)(1,"button",1)(2,"span"),L._(3,"go back"),Y.qZ()(),Y.Tg(4,"load-save-new",2),Q.N("metadataChange",(function(t){return e.setMetadata(t)})),Y.qZ()(),Y._U(5,"relations-editor",3)),2&t&&(j.x(4),D.Q("store",e._store)("getMetadataCallback",e._getMetadata)("layoutControls",!1)("history",e.history),j.x(1),D.Q("metadata",e._metadata))},dependencies:[I.z,qt.Y,P.Q],encapsulation:2,changeDetection:0}),(0,r.gn)([F.ru,(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",[Array]),(0,r.w6)("design:returntype",Object)],Gt.prototype,"_getMetadata",null),Gt=(0,r.gn)([(0,m.N)({path:"relations"}),(0,m.N)({path:"relations/:id"}),(0,r.w6)("design:paramtypes",[O.U,y.Y,jt.n])],Gt);const Pt=[Tt,z,Gt];var zt=a(96220),At=a(79141);let St=class{};St.ɵfac=function(t){return new(t||St)},St.ɵmod=k.oA({type:St}),St.ɵinj=X.cJ({providers:[{provide:d.qO,useFactory:t=>new l.I((e=>t.getData(e))),deps:[O.U]},(0,zt.Y)("LAYOUT_RELATIONS_FORM_DATA")],imports:[o.e,n.U,c.A,i.Bz,p.W,u.s,At.Qw]}),St=(0,r.gn)([(0,s.P)(Pt)],St)},35478:(t,e,a)=>{a.d(e,{O:()=>r});const r=new(a(30891).O)("FORM_COMPONENT_CONTROL")}}]);
//# sourceMappingURL=4253.chunk.73bca04aa275f7a17ace.js.map